var jsModuleCode='';
var S_id =0;
var discharged_Status = '';
var F20Type;
(function($) {
    $(document).ready(function() 
    {
        Module_Code();
       
        BindService();
        BindBedCategory();
        BindWardCategory();
        BindPayer();
        //$("#ddlWardNo").on('change', function () {
        //    var WARD_CODE = $("#ddlWardNo option:selected").val();
        //    BindRoomNo(WARD_CODE);

        //});
        //onchange for bedno

        F20Type = $(".hdnf20Type").val();
        //-----------patient demographic Start here --------------
        $("#btnUpdateDemographic").click(function () {
            var _cardNo = $("#txtAdmisssion").val()
            debugger; var _urlval = document.location.origin + "/OPD/PatientInfoCorrection.aspx?TRN_CODE=" + _cardNo + '&F20_TRN_TYPE=' + F20Type;
            window.open(_urlval, "_blank");
        });
        //-----------patient demographic End here --------------

        $("#ddlWardCategory").on("change", function () {
            BindBedNo();
            
        });
        $("#ddlPatientcategoryNewPatient").on("change", function () {
            //alert($(this).val().trim());
            //
            $("#fldPatientData").css('display', '');
            if ($(this).val().trim() == "2") {
                $("#divDependent").css('display', '');
                $("#divcolDependent").css('display', '');
            }
            else if ($(this).val().trim() == "4") {
                $("#divDependent").css('display', '');//
                $("#divcolDependent").css('display', 'none');
            }
            else {
                $("#divDependent").css('display', 'none');
                $("#divcolDependent").css('display', '');
            }
        });

        $("#ddlRoomNo").on('change', function () {

            $("#ddlBedCategory").val(0);
            //$("#txtBedNo").empty();
        });//txtBedNo
        //$("#ddlRoomNo").on('change', function () {
        //    // alert("hellow");
        //    debugger;
        //    var room_code = $("#ddlRoomNo option:selected").val();
        //    $("#ddlRoomNo option:selected").val(room_code);
        //    BindBEDNo(room_code);

        //});
        //$("#ddlRoomNo").on('change', function () {
        //    // alert("hellow");
        //    debugger;
        //    var room_code = $("#ddlRoomNo option:selected").val();
        //    var WARD_CODE = $("#ddlWardNo option:selected").val();
        //    $("#ddlRoomNo option:selected").val(room_code);
        //    $("#txtBedNo").html('');
        //    BindBEDNo(room_code, WARD_CODE);

        //});

        $("#ddlPatientcategory").on('change', function () {
            if ($("#ddlPatientcategory option:selected").val() == "5") {
                $("#asuhmanid").css('display', '');
                $("#idforbplcard").css('display', 'none');
            }
            else if ($("#ddlPatientcategory option:selected").val() == "3") {
                $("#asuhmanid").css('display', 'none');
                $("#idforbplcard").css('display', '');
            }
            else {
                $("#asuhmanid").css('display', 'none');
                $("#idforbplcard").css('display', 'none');
            }
        });//on change end here
        //onchange forpopup
        $("#ddlPatientcategoryNewPatient").on('change', function () {
            //alert("a");
            if ($("#ddlPatientcategoryNewPatient option:selected").val() == "5") {
                //alert("aush");
                $("#IdforaushmanP").css('display', '');
                $("#idforbplcardno").css('display', 'none');
            }
            else if ($("#ddlPatientcategoryNewPatient option:selected").val() == "3") {
                //alert("bpl");
                $("#IdforaushmanP").css('display', 'none');
                $("#idforbplcardno").css('display', '');
            }
            else {
                $("#IdforaushmanP").css('display', 'none');
                $("#idforbplcardno").css('display', 'none');
            }
        });//on change end here
        var trid = 1;
        $("#btnSaveAdmission").css('display', ''); //btnExpand

        $("#btnExpand").click(function() {
            var _className = $("#faExapand").attr('class');
            if (_className == 'fa fa-minus') {
                $("#faExapand").removeClass('fa fa-minus');
                $("#faExapand").addClass('fa fa-plus');
                $(".btnspn").text('Expand patient Details');
                $("#fldPatientDetails").fadeOut(500);
                $("#divPatientRemark").css('display', '');
            }
            else {
                $("#faExapand").removeClass('fa fa-plus');
                $("#faExapand").addClass('fa fa-minus');
                $(".btnspn").text('Collapse patient Details');
                $("#fldPatientDetails").fadeIn(500);
                $("#divPatientRemark").css('display', 'none');
            }
        });
        var _checkLiterate = 0;
        var counterEducation = 0;
        var _winwidth = $("#divContainer").innerWidth() - 50;
        $("#divScrollN").css('width', _winwidth);
        // $("#divDRService").append('<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;IPD Default Services !</td></tr>');

        $("#tblAllergy").html('');
        $('#tblAllergy').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th>Allergy Details</th><th>Allergy Type</th><th style="white-space:nowrap">Since</th><th>Unit</th><th>Notes / Comments</th><th>Action</th></tr></thead>');
        $('#tblAllergy').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnAllergyCode' + 1 + '" class="hdnAllergyCode" value=""/><input type="text" id="txtAllergy' + 1 + '" class="form-control txtAllergy" value=""></td><td><input type="text" id="txtAllergyType' + 1 + '" class="form-control txtAllergyType" value=""></td><td><input type="text" id="txtAllergySince' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtAllergySince"/></td><td><select id="ddlAllergySince' + 1 + '" class="form-control ddlAllergySince" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtNotesComment' + 1 + '" class="txtNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddAllergy' + 1 + '" onclick="AddAllergy(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteAllergy' + 1 + '" onclick="DeleteAllergy(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');

        $("#tblPersonalHistory").html('');
        $('#tblPersonalHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Habit</th><th style="">Since</th><th style="">Unit</th><th style="">Qty</th><th style="">Unit</th><th style="">Notes / Comments</th><th style="">Action</th></tr></thead><tbody></tbody>');
        $('#tblPersonalHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnPersonalHistoryCode' + 1 + '" class="hdnPersonalHistoryCode" value=""/><input type="text" id="txtPersonalHistory' + 1 + '" class="form-control txtPersonalHistory" value=""></td><td><input type="text" id="txtPersonalHistorySince' + 1 + '" class="form-control txtPersonalHistorySince" style="width:50px;" value=""></td><td><select id="ddlPersonalHistoryUnit' + 1 + '" class="form-control ddlPersonalHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><input type="text" style="width:50px;" id="txtPersonalHistoryQty' + 1 + '" class="form-control txtPersonalHistoryQty" value=""></td><td><select id="ddlPersonalHistoryQtyUnit' + 1 + '" class="form-control ddlPersonalHistoryQtyUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri;" id="txtPersonalHistoryNotesComment' + 1 + '" class="txtPersonalHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPersonalHistory' + 1 + '" onclick="AddPersonalHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePersonalHistory' + 1 + '" onclick="DeletePersonalHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');

        $('#tblDisease').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnDiseaseCode1" class="hdnDiseaseCode" value=""/><input type="text" id="txtDisease1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtDisease"/></td><td><input type="text" id="txtProvisionalDisease' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtProvisionalDisease"/></td><td><select id="ddlProvisionalDiseaseUnit' + 1 + '" class="form-control ddlProvisionalDiseaseUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtDiseaseRemarks1" class="form-control txtDiseaseRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddDisease1" onclick="AddDisease(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteDisease1" onclick="DeleteDisease(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');

        $('#tblAdvisedInvestigation').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyinvcode1" class="hdnalreadyinvcode" value=""/><input type="hidden" id="hdnalreadyinvName1" class="hdnalreadyinvName" value=""/><input type="text" id="txtAdvisedInvestigation1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtAdvisedInvestigation"/></td><td style="white-space:nowrap"><button type="button" id="btnAddAdvisedInvestigation1" onclick="AddAdvisedInvestigation(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteAdvisedInvestigation1" onclick="DeleteAdvisedInvestigation(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');

        $("#tblPastHistory").html('');
        $('#tblPastHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Past History</th><th style="">Type</th><th style="">Since</th><th style="">Unit</th><th style="">Notes / Comments</th><th style="">Action</th></tr></thead><tbody></tbody>');
        $('#tblPastHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnPastHistoryCode' + 1 + '" class="hdnPastHistoryCode" value=""/><input type="text" id="txtPastHistory' + 1 + '" class="form-control txtPastHistory" value=""></td><td><input type="text" id="txtPastHistoryType' + 1 + '" class="form-control txtPastHistoryType" value=""></td><td><input type="text" id="txtPastHistorySince' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtPastHistorySince"/></td><td><select id="ddlPastHistoryUnit' + 1 + '" class="form-control ddlPastHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtPastHistoryNotesComment' + 1 + '" class="txtPastHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPastHistory' + 1 + '" onclick="AddPastHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePastHistory' + 1 + '" onclick="DeletePastHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');

        $('#tblComplaintN').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnComplaintCode1" class="hdnComplaintCode" value=""/><input type="text" id="txtComplaint1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtComplaint"/></td><td><input type="text" id="txtReportedComplaintSince1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtReportedComplaintSince"/></td><td><select id="ddlReportedComplaintUnit' + 1 + '" class="form-control ddlReportedComplaintUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtcomplaintRemarks1" class="form-control txtcomplaintRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint1" onclick="AddComplaint(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint1" onclick="DeleteComplaint(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
        $('#tblFamilyHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnFamilyHistoryCode' + 1 + '" class="hdnFamilyHistoryCode" value=""/><input type="text" id="txtFamilyHistory' + 1 + '" class="form-control txtFamilyHistory" value=""></td><td><input type="text" id="txtFamilyHistoryType' + 1 + '" class="form-control txtFamilyHistoryType" style="width:50px;" value=""></td><td><input type="text" id="txtFamilyHistorySince' + 1 + '" class="form-control txtFamilyHistorySince" style="width:50px;" value=""></td><td><select id="ddlFamilyHistoryUnit' + 1 + '" class="form-control ddlFamilyHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><select style="width:200px;font-family:calibri" id="ddlFamilyHistoryRelation' + 1 + '" class="form-control ddlFamilyHistoryRelation"><option value=""></option><option value="Borther">Borther</option><option value="Sister">Sister</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Cousin">Cousin</option><option value="Nephew">Nephew</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Niece">Niece</option><option value="Great Grandmother">Great Grandmother</option><option value="Great Grandfather">Great Grandfather</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Maternal Uncle">Maternal Uncle</option><option value="Maternal Aunt">Maternal Aunt</option><option value="Daughter-in-law">Daughter-in-law</option><option value="Son-in-law">Son-in-law</option><option value=="Brother-in-law">Brother-in-law</option><option value="Sister-in-law">Sister-in-law</option><select></td><td><textarea style="font-family:calibri;" id="txtFamilyHistoryNotesComment' + 1 + '" class="txtFamilyHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddFamilyHistory' + 1 + '" onclick="AddFamilyHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteFamilyHistory' + 1 + '" onclick="DeleteFamilyHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
        
        $('#tblProcedure').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyProcedurecode1" class="hdnalreadyProcedurecode" value=""/><input type="hidden" id="hdnalreadyProcedureName1" class="hdnalreadyProcedureName" value=""/><input type="text" id="txtProcedure1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtProcedure"/></td><td style="white-space:nowrap"><button type="button" id="btnAddProcedure1" onclick="AddProcedure(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteProcedure1" onclick="DeleteProcedure(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
        BindAutoCompleteForFamilyHistory(1);
        BindAutoCompleteForComplaint(1);
        BindAutoCompleteForAllergy(1);
        BindAutoCompleteForPersonalHistory(1);
        BindAutoCompleteForPastHistory(1);
        BindAutoCompleteForDisease(1);
        BindAutoCompleteForAdvisedInvestigation(1);
        BindAutoCompleteForProcedure(1);

        //runs this function after every 3 seconds
        setInterval(function() {
            chkGender();
        }, 2000);

        $("#btnUpdateAdmission").css("display", "none");
        $("#txtDate").val($.datepicker.formatDate("dd/mm/yy", new Date()));
        $("#txtCashDepositerDate").val($.datepicker.formatDate("dd/mm/yy", new Date()));
        $("#txtMlcDateTime").val($.datepicker.formatDate("dd/mm/yy", new Date()));
        $("#txtlastMenstrualDate").datepicker({ dateFormat: 'dd/mm/yy' });

        $("#txtlastMenstrualDate").change(function() {
        debugger;
            if ($("#txtlastMenstrualDate").val() != "") {
                var dayThen = parseInt($("#txtlastMenstrualDate").val().substring(0, 2), 10);
                var monthThen = parseInt($("#txtlastMenstrualDate").val().substring(3, 5), 10);
                var yearThen = parseInt($("#txtlastMenstrualDate").val().substring(6, 10), 10);

                var _finaldate = monthThen + "/" + dayThen + "/" + yearThen;
                var newdate = new Date(monthThen + "/" + dayThen + "/" + yearThen);
                //alert(newdate);
                newdate.setDate(newdate.getDate() + 274);
               $("#txtEstDate").val($.datepicker.formatDate("dd/mm/yy", newdate));
                 
                //$("#txtEstDate").val(newdate.getDate() + "/" + (newdate.getMonth() + 1) + "/" + newdate.getFullYear());
            }
        });

        //        $("#txtDoctor").autocomplete("../Control/AutoComplete.ashx", {
        //            width: 200,
        //            formatItem: function(data, i, n, value) {
        //                //alert(value.split(",")[0]);
        //                var _vals = value.split(",")[0];
        //                if (_vals != "No Records Found !") {
        //                    return "<img class='img-thumbnail' style = 'width:40px;height:40px' src='../Image/" + value.split(",")[1] + "'/> " + value.split(",")[0];
        //                }
        //                else {
        //                    return "<b>" + value.split(",")[0] + "</b>";
        //                }
        //            },
        //            formatResult: function(data, value) {
        //                return value.split(",")[0];
        //            }
        //        });

        //$("#txtReferredBy").autocomplete("../Control/AutoComplete.ashx", {
        //    width: 200,
        //    formatItem: function(data, i, n, value) {
        //        //alert(value.split(",")[0]);
        //        var _vals = value.split(",")[0];
        //        if (_vals != "No Records Found !") {
        //            return "<img class='img-thumbnail' style = 'width:40px;height:40px' src='../Image/" + value.split(",")[1] + "'/> " + value.split(",")[0];
        //        }
        //        else {
        //            return "<b>" + value.split(",")[0] + "</b>";
        //        }
        //    },
        //    formatResult: function(data, value) {
        //        return value.split(",")[0];
        //    }
        //});

        //var _txtcontrol = "#txtReferredBy" + _controllId;
        ////var _txtAllergyType = "#txtAllergyType" + _controllId;
        ////var _Hdncontrol = "#hdnAllergyCode" + _controllId;

        //$(_txtcontrol).autocomplete({
        //    minLength: 3,
        //    source: function (request, response) {
        //        $.ajax({
        //            type: "POST",
        //            contentType: "application/json; charset=utf-8",
        //            url: "../Control/AutoComplete.ashx",
        //            data: "{'ALERGY_NAME':'" + $(_txtcontrol).val() + "'}",
        //            dataType: "json",
        //            success: function (data) {
        //                if (data.d.length > 0) {
        //                    response($.map(data.d, function (item) {
        //                        //alert(item.split('/')[1]);
        //                        return {
        //                            label: item.split('/')[0],
        //                            val: item.split('/')[1]//,
        //                            //allergy: item.split('/')[2]

        //                        }
        //                        // alert(ui.item.split('/')[2])
        //                        // $(_txtAllergyType).val(item.split('/')[2])
        //                    }));
        //                }
        //                else {
        //                    response([{ label: 'No Records Found', val: -1 }]);
        //                }
        //            },
        //            error: function (result) {
        //                alert("Error");
        //            }
        //        });
        //    },

        //    focus: function (event, ui) {
        //        // alert(ui.item.allergy);
        //        // prevent value inserted on focus
        //        $(_txtcontrol).val(ui.item.label);
        //        //$(_Hdncontrol).val(ui.item.val);
        //        //$(_txtAllergyType).val(ui.item.allergy);
        //        //$(_txtcontrol).attr('title', ui.item.label);
        //        return false;
        //    },
        //    select: function (event, ui) {

        //        if (ui.item.val == -1) {
        //            return false;
        //        }
        //        //$(txtAllergyType).val(ui.item.allergy);
        //        //alert(ui.item.split('/')[2]);
        //        //$(_Hdncontrol).val(ui.item.val);


        //    }
        //});



        BindDepartment();
        BindDoctor(0);
        BindOccupation();
        BindReligion();
        BindRelation();
        BindLocality();
        BindSurgeon(0)
        BindAnesthetist(0)
        //BindWardNo();
        $("#ddlDepartment").change(function () {
            if ($(this).val() != "0") {
                BindWARD();
            }
        });
        
        $("#ddlWardNo").change(function () {
            if ($(this).val() != "0") {
                BindRoom();
            }
        });

//        $("#ddlBedCategory").change(function () {
//            if ($(this).val() != "0") {
//                BindBedNo();
//            }
//        });


        BindCountry();
        BindPatientCategory();
        // BindDefaultServiceGrid();



        //CHECK-BOX  
        $("#chkUnchekLiterate").click(function() {

            //            alert($("#chkUnchekLiterate").attr('class'));
            if ($("#chkUnchekLiterate").attr('class') == "fa fa-square-o" || $("#chkUnchekLiterate").attr('class') == "fa-square-o fa") {
                $("#chkUnchekLiterate").removeClass('fa fa-square-o');
                $("#chkUnchekLiterate").removeClass('fa-square-o fa');
                $("#chkUnchekLiterate").addClass('fa fa-check-square-o');
                $("#EducationField").css("display", "");
                _checkLiterate = 1;
            }
            else {
                $("#chkUnchekLiterate").removeClass('fa fa-check-square-o');
                $("#chkUnchekLiterate").addClass('fa fa-square-o');
                $("#EducationField").css("display", "none");
                _checkLiterate = 0;
            }
        });

        //    $("#txtHT").keypress(function(event) {
        //                 // Allow only backspace, delete and left arrow
        //        if ( event.keyCode == 46 || event.keyCode == 8 || event.keyCode == 37) {
        //                    // let it happen, don't do anything
        //            }
        //        else {
        //                    // Ensure that it is a number and stop the keypress
        //            if (event.keyCode < 48 || event.keyCode > 57) {
        //                    event.preventDefault(); 
        //                }   
        //            }
        //    });

        $("#txtNewMobilePop").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtNewAadharPop").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtNewAgePop").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtHT").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtWT").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtPinNo").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtApgarScore").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtAdmisssion").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtUhid").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtOpdCardNo").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtCasualtyNo").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtOldNo").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });
        $("#txtPolicyAmount").keydown(function(e) {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
            // Allow: Ctrl+A, Command+A
            (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
            // Allow: home, end, left, right, down, up
            (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });


         $("#txtDate,#txtAdmFromDatePop,#txtAdmToDatePop,#txtCashDepositerDate").datepicker({ dateFormat: 'dd/mm/yy' });
        $("#txtEstDate").datepicker({ dateFormat: 'dd/mm/yy' });
        $("#txtMlcDateTime").datepicker({ dateFormat: 'dd/mm/yy' });
        $("#txtDateOfBirth").datepicker({ dateFormat: 'dd/mm/yy' });
        $("#txtValidity").datepicker({ dateFormat: 'dd/mm/yy' });

        $("#txtDateOfBirth").change(function() {
            if ($("#txtDateOfBirth").val() != "") {
                CalculateAge();
            }
        });



        $("#chkPregnancy").on('change', function() {
            if ($("#chkPregnancy").prop('checked')) {
                $("#txtEstDate").removeAttr("disabled");
                $("#txtlastMenstrualDate").removeAttr("disabled");
            }
        });

        $("#ddlPatientcategory").on('change', function() {
            if ($("#ddlPatientcategory option:selected").text() == 'Insured') {
                $("#InsuredFieldSet").css("display", "");

            }
            else {
                $("#InsuredFieldSet").css("display", "none");
            }
        });


        $("#ddlDepartment").on('change', function() {
            BindRoomNo($("#ddlDepartment").val());
            debugger;
           // BindDoctor($("#ddlDepartment").val());

        });

        $("#ddlCountry").on('change', function() {
            BindState($("#ddlCountry").val());
        });

        $("#ddlState").on('change', function() {
            BindCity($("#ddlState").val());
        });

        $("#ddlCity").on('change', function() {
            BindPincode($("#ddlCity").val());
        });


        $("#btnResetPop").click(function() {
            $("#txtUHIDPop").val('');
            $("#txtNamePop").val('');
            $("#txtMobilePop").val('');
        });

        $("#btnReset1").click(function() {
            $('#txtUHIDSearch').val('');
            $('#txtOPDNOSearch').val('');
            $('#txtIPDNoSearch').val('');
            $('#txtNameSearch').val('');
            $('#txtMobileSearch').val('');
            $('#txtAadhaarSearch').val('');
            $('#txtCasualtySearch').val('');
        });


        $("#btnResetPop1").click(function() {
            $("#txtUHIDPop1").val('');
            $("#txtOPDNoPop1").val('');
            $("#txtIPDPop1").val('');
            $("#txtNamePop1").val('');
            $("#txtMobilePop1").val('');
            $("#txtAdhaarnoPop1").val('');
            $("#txtCasualtyPop1").val('');
        });


        $("#btnResetNewPatient").click(function() {
            $("#txtNewNamePop").val('');
            $("#ddlNewGenderPop").val('0');
            $("#txtNewAgePop").val('');
            $("#txtNewAadharPop").val('');
            $("#txtNewMobilePop").val('');
            $("#ddlNewLocalityPop").val('0');
        });


        $("#btnSearchupUhid").click(function () {
           
            $("#txtUHIDPop1").val($("#txtUHIDSearch").val());
            $("#txtOPDNoPop1").val($("#txtOPDNOSearch").val());
            $("#txtIPDPop1").val($("#txtIPDNoSearch").val());
            $("#txtNamePop1").val($("#txtNameSearch").val());
            $("#txtMobilePop1").val($("#txtMobileSearch").val());
            $("#txtAdhaarnoPop1").val($("#txtAadhaarSearch").val());
            $("#txtCasualtyPop1").val($("#txtCasualtySearch").val());

            $("#myModalForSearch").modal({
                show: true,
                width: '1040px' //probably not needed
            });
            $("#btnSearchPatientPop1").trigger('click');
        });  //btnSearchUHID end

        $("#btnSearchPatientPop1").click(function() {
            var _UHID = $("#txtUHIDPop1").val();
            var _OPD_CARD_NO = $("#txtOPDNoPop1").val();
            var _IPD_no = $("#txtIPDPop1").val();
            var _name = $("#txtNamePop1").val();
            var _mobileno = $("#txtMobilePop1").val();
            var _Aadhaar_no = $("#txtAdhaarnoPop1").val();
            var _Casualty_no = $("#txtCasualtyPop1").val();

            $.ajax({
                type: 'POST',
                url: 'IpdShortStay.aspx/SearchAllRecord',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                cache: false,
                async: false,
                data: "{'SEARCH_UHID':'" + _UHID +
                "','SEARCH_NAME':'" + _name +
                "','SEARCH_MOBILE':'" + _mobileno +
                "','SEARCH_OPD':'" + _OPD_CARD_NO +
                "','SEARCH_IPD':'" + _IPD_no +
                "','SEARCH_AADHAAR':'" + _Aadhaar_no +
                "','SEARCH_CASUALTY':'" + _Casualty_no + "'}",
                beforeSend: function() {
                },
                success: function(response) {
                    var xmlDoc = $.parseXML(response.d);
                    var xml = $(xmlDoc);
                    var items = xml.find("Table");
                    var row = '';
                    var count = 0;
                    var table = $('<table id="tblSearchAllRecord" style="font-family:Calibri;" class="table table-bordered table-hover" ></table>');
                    $.each(items, function(index) {
                        if (parseInt(count) == 0) {
                            var rowheader = '<thead style="font-size:14px;"><tr>';
                            //var rowheader = '<tr>';
                            rowheader += '<th>UHID</th>';
                            rowheader += '<th>Name</th>';
                            rowheader += '<th>Mobile</th>';
                            rowheader += '<th>OPD Card No.</th>';
                            rowheader += '<th>IPD Admission No.</th>';
                            rowheader += '<th>Aadhaar</th>';
                            rowheader += '<th>Casualty No.</th>';
                            rowheader += '<th>Action</th>';
                            rowheader += '</tr></thead>';
                            //rowheader += '</tr>';

                            table.append(rowheader);
                        }
                        var rowcol = '';
                        rowcol += '<tbody><tr>';
                        //rowcol += '<tr>';

                        rowcol += '<td>' + $(this).find("UHID").text() + '</td>';
                        rowcol += '<td>' + $(this).find("NAME").text() + '</td>';
                        rowcol += '<td>' + $(this).find("MOBILE").text() + '</td>';
                        rowcol += '<td>' + $(this).find("OPD_CARD_NO").text() + '</td>';
                        rowcol += '<td>' + $(this).find("ADMISSION_NO").text() + '</td>';
                        rowcol += '<td>' + $(this).find("ADHAR_NO").text() + '</td>';
                        rowcol += '<td>' + $(this).find("CR_NO").text() + '</td>';

                        rowcol += '<td><button type="button" id="btnSearchAllRecord" onclick="SelectAllPatientRecord(' + $(this).find("UHID").text() + ')" class="btn btn-info" style="font-family: Calibri; font-size: 12px;"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></button></td>';
                        rowcol += '</tr></tbody>';
                        //rowcol += '</tr>';
                        table.append(rowcol);
                        count += 1;
                    });     //table loop end here 

                    if (parseInt(count) == 0) {
                        var rowcol = '';
                        rowcol += '<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;No matching record found !</td></tr>';
                        table.append(rowcol);
                        $('#divSearchAllRecord').html(table);
                    }
                    else {
                        $('#divSearchAllRecord').html(table);
                        var _table = $('#divSearchAllRecord table');
                        bind_filterevent(_table);
                        paginateIt(_table, 4);
                        visibility_paging(_table);
                    }
                    
                },
                failure: function(response) {
                    alert('Searching All Record Failed');
                },
                error: function(response) {
                    alert('Searching All Record Error');
                }
            }); //ajax end here
        });

          //------------------ADMISSION MODAL-----------------
         $("#btnSearchAdmissionNo").click(function() {
            $("#txtAdmNoPop").val($("#txtAdmisssion").val());

            $("#myModalForAdmissionNo").modal({
                show: true,
                width: '1040px' //probably not needed
            });
            $("#btnSearchAdmissionNoPop").trigger('click');
        });  //btnSearchUHID end
        
        //----------------SEARCH FROM ADMISSION--------------
        $("#btnSearchAdmissionNoPop").click(function() 
        {
            debugger;
            var _uhid= $("#txtAdmUhidPop").val();
            var _pidNo= $("#txtAdmPidNoPop").val();
            var _admNO = $("#txtAdmNoPop").val();
            var _Name = $("#txtAdmNamePop").val();
            var _MobileNo = $("#txtAdmMobilePop").val();
            var _FromDate = $("#txtAdmFromDatePop").val();
            var _Todate = $("#txtAdmToDatePop").val();
            
            var currentdate =$.datepicker.formatDate('dd/mm/yy', new Date());             
             
            if(_uhid=="" && _pidNo=="" && _admNO =="" && _Name=="" &&  _MobileNo=="" && _FromDate=="" && _Todate=="")
            {
                 _FromDate= currentdate;
                 _Todate=currentdate ;
            }


            $.ajax({
                type: 'POST',
                url: 'IpdShortStay.aspx/SearchAdmission',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                cache: false,
                async: false,
                data: "{'UHID':'" + _uhid +
                "','PID_NO':'" + _pidNo +
                "','SHORT_STAY_NO':'" + _admNO +
                "','NAME':'" + _Name +
                "','MOBILE':'" + _MobileNo +
                "','FROM_DATE':'" + _FromDate +
                "','TO_DATE':'" + _Todate +  
                "'}",
                beforeSend: function() {
                },
               success: function(response) {
                        var xmlDoc = $.parseXML(response.d);
                        var xml = $(xmlDoc);
                        var items = xml.find("Table");
                    var row = '';
                    var count = 0;
                    var table = $('<table id="tblAdmission" style="font-family:Calibri;" class="table table-bordered table-hover" ></table>');
                    $.each(items, function(index) 
                    {
                        if (parseInt(count) == 0) 
                        {
                            var rowheader = '<thead style="font-size:14px;"><tr>';
                            rowheader += '<th>UHID</th>';
                            rowheader += '<th>Short Stay No.</th>';
                            rowheader += '<th>NAME</th>';
                            rowheader += '<th>Age</th>';
                            rowheader += '<th>Gender</th>';
                            rowheader += '<th>Action</th>';
                            rowheader += '</tr></thead>';
                            table.append(rowheader);
                        }
                        var rowcol = '';
                        rowcol += '<tbody><tr>';
                        rowcol += '<td>' + $(this).find("UHID").text() + '</td>';
                       
                        rowcol += '<td>' + $(this).find("SHORT_STAY_NO").text() + '</td>';
                        rowcol += '<td>' + $(this).find("NAME").text() + '</td>';
                        rowcol += '<td>' + $(this).find("AGE_YY").text() +' yrs ' + $(this).find("AGE_MM").text() +' mon ' + $(this).find("AGE_DD").text() +' day ' +'</td>';
                        rowcol += '<td>' + $(this).find("GENDER").text() + '</td>';
                        rowcol += '<td><button type="button" id="btnSearchAdmissionPop" onclick="EditRecord(' + $(this).find("SHORT_STAY_NO").text() + ')" class="btn btn-info" style="font-family: Calibri; font-size: 12px;"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></button></td>';
                        rowcol += '</tr></tbody>';
                        table.append(rowcol);
                        count += 1;
                    });     //table loop end here 

                    if (parseInt(count) == 0) {
                        var rowcol = '';
                        rowcol += '<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;No matching record found !</td></tr>';
                        table.append(rowcol);
                        $('#divSearchAdmission').html(table);
                    }
                    else {
                        $('#divSearchAdmission').html(table);
                        var _table = $('#divSearchAdmission table');
                        bind_filterevent(_table);
                        paginateIt(_table, 5);
                        visibility_paging(_table);
                    }
                },
                failure: function(response) {
                    alert('Searching All Record Failed');
                },
                error: function(response) {
                    alert('Searching All Record Error');
                }
            }); //ajax end here
        });

        $("#btnResetAdmissionNoPop").click(function()
        {
            $("#txtAdmUhidPop").val('');
            $("#txtAdmPidNoPop").val('');
            $("#txtAdmNoPop").val('');
            $("#txtAdmNamePop").val('');
            $("#txtAdmMobilePop").val('');
            $("#txtAdmFromDatePop").val('');
            $("#txtAdmToDatePop").val('');
        });
        


        $("#btnAddNewPatientt1").click(function() {

            $("#myModalAddNewPatient").modal({
                show: true,
                width: '1040px' //probably not needed
            });
            $("#btnAddNewPatientt1").trigger('click');
        });  //btnSearchUHID END

        $("#btnSaveNewPatient").click(function () {
            debugger;
            if ($("#txtNewNamePop").val() == "") {
                //$("#txtname").css('border-color','#ccc').css("border-width","thin").css("border-size","1px").css("border-style","solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please enter Name !");
                alert('Please enter Name !');
                $("#txtNewNamePop").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#txtNewNamePop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#ddlNewGenderPop").val() == "0") {
                $("#txtNewNamePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                //$("#spnerrormsg").text("Please select Department Name !");
                alert('Please select Gender !');
                $("#ddlNewGenderPop").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlNewGenderPop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#txtNewAgePop").val() == "" && $("#txtNewAgeMM").val() == "" && $("#txtNewAgeDD").val() == "") {
                $("#ddlNewGenderPop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Age !");
                alert('Please select Age !');
                $("#txtNewAgePop").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#txtNewAgePop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }

            else if ($("#ddlPatientcategoryNewPatient").val() == "0") {
                $("#ddlPatientcategoryNewPatient").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                //$("#spnerrormsg").text("Please select Ward !");
                alert('Please Select Patient Category');
                $("#ddlPatientcategoryNewPatient").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlPatientcategoryNewPatient").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }


            $("#txtNewNamePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlNewGenderPop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtNewAgePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");


            var _locality = 0;

            if ($("#ddlNewLocalityPop option:selected").text() == '-- Select Locality --') {
                _locality = 0;
            }
            else {
                _locality = ($("#ddlNewLocalityPop option:selected").text());
            }

            $.ajax({
                type: 'POST',
                url: '../OPD/OPDRegistrationN.aspx/SaveNewPatientRecord',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                cache: false,
                async: false,
                data: "{'FNAME':'" + $("#txtNewNamePop").val() +
               "','GENDER':'" + $("#ddlNewGenderPop").val() +
               "','AGE_YY':'" + $("#txtNewAgePop").val() +
               "','ADHAR_NO':'" + $("#txtNewAadharPop").val() +
               "','MOBILE':'" + $("#txtNewMobilePop").val() +
               "','LOCALITY_CODE':'" + $("#ddlNewLocalityPop").val() +
               "','LOCALITY_NAME':'" + _locality +
               "','PATIENT_CATEGORY':'" + $("#ddlPatientcategoryNewPatient").val() +
               "','AGE_MM':'" + $("#txtNewAgeMM").val() +
               "','AGE_DD':'" + $("#txtNewAgeDD").val() +
               "','DEPARTMENT_CODE':'" + $("#ddlDepartmentPop").val() +
               "','DEPARTMENT_NAME':'" + $("#ddlDepartmentPop option:selected").text() +
               "','DEPENDENT_NAME':'" + $("#txtDependentNamePop").val() +
               "','DEPENDENT_RELATION':'" + $("#ddlRelationDependentPop").val() +
               "','RANK':'" + $("#txtPRankPop").val() +
               "','PID_NO':'" + $("#txtPIDNoPop").val() +
               "','PUNIT':'" + $("#txtPUnitPop").val() +

               "'}",
                beforeSend: function () {
                },
                success: function (response) {
                    $("#btnCloseNewPatient").trigger('click');
                    $("#txtNewNamePop").val('');
                    $("#ddlNewGenderPop").val('0');
                    $("#txtNewAgePop").val('');
                    $("#txtNewAgeMM").val('');
                    $("#txtNewAgeDD").val('');
                    $("#txtNewAadharPop").val('');
                    $("#txtNewMobilePop").val('');
                    $("#ddlNewLocalityPop").val('0');
                    $("#ddlPatientcategoryNewPatient").val('0');



                    $("#txtPRankPop").val('');
                    $("#txtPIDNoPop").val('');
                    $("#txtPUnitPop").val('');
                    $("#ddlRelationDependentPop").val('0');
                    $("#txtDependentNamePop").val('');
                    $("#ddlDepartmentPop").val('0');

                    $("#btnUpdateAdmission").css("display", "");
                    $("#btnSaveAdmission").css("display", "none");
                    //window.open("../index.html?Name=SINCH" + response.d + "&Password=12345&CREATEUSER=1", "_blank");
                    SelectNewPatientRecord(response.d);


                },
                failure: function (response) {
                    alert('New Patient Record Saving Failed');
                },
                error: function (response) {
                    alert('New Patient Record Saving Error');
                }
            }); //AJAX END HERE
        });   //BTNSAVENEWPATIENT END  

        $("#btnSaveNewPatient11").click(function () {
            debugger;
            if ($("#txtNewNamePop").val() == "") {
                //$("#txtname").css('border-color','#ccc').css("border-width","thin").css("border-size","1px").css("border-style","solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please enter Name !");
                $("#txtNewNamePop").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#txtNewNamePop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#ddlNewGenderPop").val() == "0") {
                $("#txtNewNamePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Department Name !");
                $("#ddlNewGenderPop").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlNewGenderPop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#txtNewAgePop").val() == "") {
                $("#ddlNewGenderPop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Ward !");
                $("#txtNewAgePop").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#txtNewAgePop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#ddlPatientcategoryNewPatient").val() == "0") {
                $("#txtNewNamePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Patient Category !");
                $("#ddlPatientcategoryNewPatient").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlPatientcategoryNewPatient").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }

            $("#txtNewNamePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlNewGenderPop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtNewAgePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlPatientcategoryNewPatient").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");



            var _locality = 0;
            if ($("#ddlNewLocalityPop option:selected").text() == '-- Select Locality --') {
                _locality = 0;
            }
            else {
                _locality = ($("#ddlNewLocalityPop option:selected").text());
            }
            var BPL_CARD_NO = "";
            var AUSHMAN_CARD_NO = "";
            BPL_CARD_NO = $("#txtbplcard_no").val();
            
            AUSHMAN_CARD_NO = $("#txtaushman_cardNo").val();

            $.ajax({
                type: 'POST',
                url: 'IpdShortStay.aspx/SaveNewPatientRecord',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                cache: false,
                async: false,
                data: "{'FNAME':'" + $("#txtNewNamePop").val() +
               "','GENDER':'" + $("#ddlNewGenderPop").val() +
               "','AGE_YY':'" + $("#txtNewAgePop").val() +
               "','ADHAR_NO':'" + $("#txtNewAadharPop").val() +
               "','MOBILE':'" + $("#txtNewMobilePop").val() +
               "','LOCALITY_CODE':'" + $("#ddlNewLocalityPop").val() +
               "','LOCALITY_NAME':'" + _locality +
               "','PATIENT_CATEGORY':'" + $("#ddlPatientcategoryNewPatient").val() +
                "','AUSHMAN_CARD_NO':'" + AUSHMAN_CARD_NO +
               "','BPL_CARD_NO':'" + BPL_CARD_NO +
               "'}",
                beforeSend: function() {
                },
                success: function(response) {
                    // $("#btnReset").trigger('click');
                    $("#btnUpdateAdmission").css("display", "");
                    $("#btnSaveAdmission").css("display", "none");
                    SelectNewPatientRecord(response.d);
                    //BindDefaultServiceGrid();
                },
                failure: function(response) {
                    alert('New Patient Record Saving Failed');
                },
                error: function(response) {
                    alert('New Patient Record Saving Error');
                }
            }); //AJAX END HERE
        });   //BTNSAVENEWPATIENT END 


        $("#btnSearchUHIDDtl").click(function() {

            var _uhid = $("#txtUhid").val();
            var _name = $("#txtname").val();
            var _mobile = $("#txtMobile").val();
            if (_uhid == "" && _name == "" && _mobile == "") {
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please enter UHID or Name or Mobile !");
                $("#txtUhid").focus();
                $("#div ErrorMsg").delay(3200).fadeOut(300);
                $("#txtUhid").css('border-color', 'red');
                $("#txtname").css('border-color', 'red');
                $("#txtMobile").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else {
                $("#txtUhid").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#txtname").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#txtMobile").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#txtUHIDPop").val($("#txtUhid").val());
                $("#txtNamePop").val($("#txtname").val());
                $("#txtMobilePop").val($("#txtMobile").val());
                $("#myModalSearchPatient").modal({
                    show: true,
                    width: '1040px' //probably not needed
                });
                $("#btnSearchPatient").trigger('click');
            }
        });  //btnSearchUHID END


        $("#btnSearchPatient").click(function() {
            var _uhid = $("#txtUHIDPop").val();
            var _Name = $("#txtNamePop").val();
            var _Mobile = $("#txtMobilePop").val();
            if (_uhid == "" && _Name == "" && _Mobile == "") {
                $("#div2").css("display", "block");
                $("#Span1").text("Please enter UHID or Name or Mobile !");
                $("#txtUHIDPop").focus();
                $("#div2").delay(3200).fadeOut(300);
                $("#txtUHIDPop").css('border-color', 'red');
                $("#txtNamePop").css('border-color', 'red');
                $("#txtMobilePop").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else {
                $("#txtUHIDPop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#txtNamePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#txtMobilePop").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");

                $.ajax({
                    type: 'POST',
                    url: 'IpdShortStay.aspx/SearchUHIDRecord',
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    cache: false,
                    async: false,
                    data: "{'UHID':'" + _uhid + "','NAME':'" + _Name + "','MOBILE':'" + _Mobile + "'}",
                    beforeSend: function() {
                    },
                    success: function(response) {
                        var xmlDoc = $.parseXML(response.d);
                        var xml = $(xmlDoc);
                        var items = xml.find("Table");
                        var row = '';
                        var count = 0;
                        var table = $('<table id="tblPatient" style="font-family:Calibri;" class="table table-bordered table-hover" ></table>');
                        $.each(items, function(index) {
                            if (parseInt(count) == 0) {
                                var rowheader = '<thead style="font-size:14px;"><tr>';
                                //var rowheader = '<tr>';
                                rowheader += '<th>UHID</th>';
                                rowheader += '<th>Name</th>';
                                rowheader += '<th>Mobile</th>';
                                rowheader += '<th>Gender</th>';
                                rowheader += '<th>Date of Birth</th>';
                                rowheader += '<th>Action</th>';
                                rowheader += '</tr></thead>';
                                //rowheader += '</tr>';
                                table.append(rowheader);
                            }
                            var rowcol = '';
                            rowcol += '<tbody><tr>';
                            //rowcol += '<tr>';

                            // rowcol += '<td>' + $(this).find("ID").text() + '</td>';
                            rowcol += '<td>' + $(this).find("UHID").text() + '</td>';
                            rowcol += '<td>' + $(this).find("FNAME").text() + '</td>';
                            rowcol += '<td>' + $(this).find("MOBILE").text() + '</td>';
                            rowcol += '<td>' + $(this).find("GENDER").text() + '</td>';
                            rowcol += '<td>' + $(this).find("DOB").text() + '</td>';
                            rowcol += '<td><button type="button" id="btnSelectPatient" onclick="SelectPatientRecord(' + $(this).find("UHID").text() + ')" class="btn btn-info" style="font-family: Calibri; font-size: 12px;"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></button></td>';
                            rowcol += '</tr></tbody>';
                            //rowcol += '</tr>';
                            table.append(rowcol);

                            count += 1;
                        });     //table loop end here 
                        if (parseInt(count) == 0) {
                            var rowcol = '';
                            rowcol += '<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;No matching record found !</td></tr>';
                            table.append(rowcol);
                            $('#divSearchPatient').html(table);
                        }
                        else {
                            $('#divSearchPatient').html(table);
                            var _table = $('#divSearchPatient table');
                            bind_filterevent(_table);
                            paginateIt(_table, 4);
                            visibility_paging(_table);
                        }
                    },
                    failure: function(response) {
                        alert('Searching UHID Record Failed');
                    },
                    error: function(response) {
                        alert('Searching UHID Record Error');
                    }
                }); //ajax end here
            }
        });    //btnSearchPatient ENDS 




        $("#btnSaveAdmission").click(function () {
            debugger;
            var _pregnancy = 0;
            var _chkParental = 0;
            var _chkFulltTerm = 0;
            var _room_name = '';
            var _department_name = '';
            var _religion_name = '';
            var _occupation_name = '';
            var _city_name = '';

            var _splInstructions = $("#txtSplInstructions").val();
            var _operations = $("#txtOperation").val();
            var _diagnosis = $("#txtDiagnosis").val();

            var _country_name = '';
            var _locality = '';
            var _state_name = '';
            var _kin_relation_Name = '';
            var _Patient_category = '';
            var _address = '';
            var _validity = '';
            var fileUpload = $("#FileUpload1").get(0);
            var files = fileUpload.files;
            var _txtRefferedByCode = '';
            var _txtReferredByName = '';
            var _doctor_Code = '';
            var _doctor_Name = '';
            var _PAYMODE = '';
            var _PAID_AMOUNT = 0;
            var _BALANCE_AMOUNT = 0;
            var _OTHER_CHARGES_PER = 0;
            var _OTHER_CHARGES_AMOUNT = 0;
            var _INV_DISCOUNT_PERCENT = 0;
            var _INV_DISCOUNT_AMOUNT = 0;
            var _AMOUNT = 0;
            var _DISCOUNT = 0;
            var _TAXABLE_AMOUNT = 0;
            var _TAX_AMOUNT = 0;
            var _CASH_DISCOUNT = 0;
            var _NET_AMOUNT = 0;
            var _AUSHMAN_CARD_NO = "";
            var BPL_CARD_NO = "";
            
            var DEPOSITE_DATE='';
            var DEPOSITE_TIME='';
            var DEPOSITOR_NAME='';
            var BANK_NAME='';
            var TRANSACTION_NO='';
            
            
            //-------PAYMODE-------------
            if ($("#ddlPaymode").val() == 'Cash') 
            {
                DEPOSITE_DATE=$("#txtCashDepositerDate").val();
                DEPOSITE_TIME=$("#txtCashDepositerTime").val();
                DEPOSITOR_NAME=$("#txtCashDepositerName").val();
            }
            else if ($("#ddlPaymode").val() == 'Card') 
            {
                BANK_NAME=$("#txtCardName").val();
                TRANSACTION_NO=$("#txtCardNo").val();               
            }

            else if ($("#ddlPaymode").val() == 'Cheque/Draft') 
            {
                BANK_NAME=$("#txtChequeBankName").val();
                TRANSACTION_NO=$("#txtChequeBankNo").val();                
            }
            else if ($("#ddlPaymode").val() == 'Wallet' || $("#ddlPaymode").val() == 'NEFT') 
            {
                BANK_NAME=$("#txtWalletName").val();
                TRANSACTION_NO=$("#txtWalletTransitionNo").val(); 
            }                 
            
            
            _AUSHMAN_CARD_NO = $("#txtaushmancardno").val();
            BPL_CARD_NO = $("#txtbplcardno").val();

            //if ($("#Select2").val() == "") {
            //    //$("#txtname").css('border-color','#ccc').css("border-width","thin").css("border-size","1px").css("border-style","solid");
            //    $("#divErrorMsg").css("display", "block");
            //    $("#spnerrormsg").text("Please Select Source !");
            //    $("#Select2").focus();
            //    $("#divErrorMsg").delay(3200).fadeOut(300);
            //    $("#Select2").css('border-color', 'red');
            //    $(window).scrollTop(0, 0);
            //    return false;
            //}
             if ($("#txtname").val() == "") {
                $("#Select2").css('border-color','#ccc').css("border-width","thin").css("border-size","1px").css("border-style","solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please enter Name !");
                $("#txtname").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#txtname").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#ddlDepartment").val() == "") {
                $("#Select2,#txtname").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Department Name !");
                $("#ddlDepartment").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlDepartment").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            //else if ($("#ddlWardNo").val() == "") {
            //    $("#Select2,#txtname,#ddlDepartment").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            //    $("#divErrorMsg").css("display", "block");
            //    $("#spnerrormsg").text("Please select Ward !");
            //    $("#ddlWardNo").focus();
            //    $("#divErrorMsg").delay(3200).fadeOut(300);
            //    $("#ddlWardNo").css('border-color', 'red');
            //    $(window).scrollTop(0, 0);
            //    return false;
            //}

            //else if ($("#txtMobile").val() == "") {
            //    $("#ddlWardNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            //    $("#divErrorMsg").css("display", "block");
            //    $("#spnerrormsg").text("Please enter Mobile Number !");
            //    $("#txtMobile").focus();
            //    $("#divErrorMsg").delay(3200).fadeOut(300);
            //    $("#txtMobile").css('border-color', 'red');
            //    $(window).scrollTop(0, 0);
            //    return false;
            //}


            else if ($("#ddlGender").val() == "") {
                $("#txtMobile").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Gender !");
                $("#ddlGender").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlGender").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#ddlPatientcategory").val() == "") {
                $("#ddlGender").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Patient Category !");
                $("#ddlPatientcategory").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlPatientcategory").css('border-color', 'red');
                return false;
            }
             
            else if (files.length == "1") {

                if ($("#txtMlcNo").val() == "") {
                    $("#txtMlcNo").css('border-color', 'red');
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please enter MLC No. !");
                    $("#txtMlcNo").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(window).scrollTop(0, 0);
                    return false;
                }
                else {

                    $("#txtMlcNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                }

            }

            $("#ddlGender").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlWardNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtMobile").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtname").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtMlcNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlDepartment").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");



            if ($("#txtHouseNo").val() == '' || $("#txtStreetName").val() == '' || $("#txtStreetNo").val() == '' || $("#txtLandmark").val() == '') {
                _address = '';
            }
            else {
                _address = 'House No.' + $("#txtHouseNo").val() + ', Street Name: ' + $("#txtStreetName").val() + ', Street No.' + $("#txtStreetNo").val() + ', Landmark: ' + $("#txtLandmark").val();
            }

            if ($("#chkPregnancy").prop('checked')) {
                _pregnancy = 1;
            }
            else {
                _pregnancy = 0;
            }

            if ($("#chkParental").prop('checked')) {
                _chkParental = 1;
            }
            else {
                _chkParental = 0;
            }

            if ($("#chkFulltTerm").prop('checked')) {
                _chkFulltTerm = 1;
            }
            else {
                _chkFulltTerm = 0;
            }
            if ($("#ddlLocality option:selected").text() == '') {
                _locality = '';
            }
            else {
                _locality = ($("#ddlLocality option:selected").text());
            }

            if ($("#ddlPatientcategory option:selected").text() == '') {
                _Patient_category = '';
            }
            else {
                _Patient_category = ($("#ddlPatientcategory option:selected").text());
            }

            if ($("#ddlRoomNo option:selected").text() == '') {
                _room_name = '';
            }
            else {
                _room_name = ($("#ddlRoomNo option:selected").text());
            }


            if ($("#ddlReligion option:selected").text() == '') {
                _religion_name = '';
            }
            else {
                _religion_name = ($("#ddlReligion option:selected").text());
            }


            if ($("#ddlOccupation option:selected").text() == '') {
                _occupation_name = '';
            }
            else {
                _occupation_name = ($("#ddlOccupation option:selected").text());
            }


            if ($("#ddlCity option:selected").text() == '') {
                _city_name = '';
            }
            else {
                _city_name = ($("#ddlCity option:selected").text());
            }


            if ($("#ddlState option:selected").text() == '') {
                _state_name = '';
            }
            else {
                _state_name = ($("#ddlState option:selected").text());
            }

            if ($("#ddlDepartment option:selected").text() == '') {
                _department_name = '';
            }
            else {
                _department_name = ($("#ddlDepartment option:selected").text());
            }
            if ($("#ddlCountry option:selected").text() == '') {
                _country_name = '';
            }
            else {
                _country_name = ($("#ddlCountry option:selected").text());
            }


            if ($("#ddlRelation option:selected").text() == '') {
                _kin_relation_Name = '';
            }
            else {
                _kin_relation_Name = ($("#ddlRelation option:selected").text());
            }  
            
//            if ($("#txtReferredBy").val() == '') {
//                _txtRefferedByCode = 0;
//            }
//            else {
//                _txtRefferedByCode = ($("#txtReferredBy").val().substring(3));
//            }         

            if ($("#txtReferredBy").val() == '') {
                _txtReferredByName ='';
            }
            else {
                _txtReferredByName = ($("#txtReferredBy").val());
            }

            if ($("#txtDoctor").val() == '') {
                _doctor_Code = '';
            }
            else {
                _doctor_Code = ($("#txtDoctor").val());
            }

            if ($("#txtDoctor").val() == '') {
                _doctor_Name = '';
            }
            else {
                _doctor_Name = ($("#txtDoctor option:selected").text());
            }
            
            
            var SurgeonCodeArray='';
            var SurgeonNameArray='';
            $("#ddlSurgeon option:selected").each(function()
            {            
                var SurgeonCode = $(this).val();  
                var SurgeonName = $(this).text();     

                if(SurgeonCodeArray!="")
                {            
                    SurgeonCodeArray = SurgeonCodeArray.concat(",",SurgeonCode) ;
                    SurgeonNameArray = SurgeonNameArray.concat(",",SurgeonName) ;
                }
                else
                {            
                    SurgeonCodeArray = SurgeonCode;
                    SurgeonNameArray = SurgeonName;
                }
            });
            
            var AnesthetistCodeArray='';
            var AnesthetistNameArray='';
            $("#ddlAnesthetist option:selected").each(function()
            {            
                var AnesthetistCode = $(this).val();  
                var AnesthetistName = $(this).text();     

                if(AnesthetistCodeArray!="")
                {            
                    AnesthetistCodeArray = AnesthetistCodeArray.concat(",",AnesthetistCode) ;
                    AnesthetistNameArray = AnesthetistNameArray.concat(",",AnesthetistName) ;
                }
                else
                {            
                    AnesthetistCodeArray = AnesthetistCode;
                    AnesthetistNameArray = AnesthetistName;
                }
            });
            
            var _short_stay = 1;
           
            var _relation_with_Dependent_Name ='';
            
//            ($("#ddlSurgeon").val() == '0') ?  _surgeon_Name : _surgeon_Name=($("#ddlSurgeon option:selected").text()) ;
//            
//            ($("#ddlAnesthetist").val() == '0') ?  _anesthetist_Name : _anesthetist_Name=($("#ddlAnesthetist option:selected").text()) ;
            
//            ($("#chkShortStay").prop('checked')) ?  _short_stay = 1 :  _short_stay = 0;
            
            ($("#ddlDependentRelation").val() == '') ?  _relation_with_Dependent_Name : _relation_with_Dependent_Name=($("#ddlDependentRelation option:selected").text()) ;
            
            
            var _isValidate = 0;
            if (_checkLiterate == 1) {
                if ($(".clsEducation").val() == "") {
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please Enter Education !");
                    $(".clsEducation").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(".clsEducation").css('border-color', 'red');
                    $(window).scrollTop(0, 0);
                    return false;
                }
                else if ($(".clsUniversity").val() == "") {
                    $(".clsEducation").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please Enter University !");
                    $(".clsUniversity").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(".clsUniversity").css('border-color', 'red');
                    $(window).scrollTop(0, 0);
                    return false;
                }
                else if ($(".clsPassingYear").val() == "") {
                    $(".clsUniversity").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please Enter Passing Year !");
                    $(".clsPassingYear").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(".clsPassingYear").css('border-color', 'red');
                    $(window).scrollTop(0, 0);
                    return false;
                }
                $(".clsEducation").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $(".clsUniversity").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $(".clsPassingYear").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");



                var XmlRequest = "<DATASET>";

                $('#tblEducationId tr').not(':first').each(function() {

                    var txt_Education = $(this).find('.clsEducation').val();
                    var txt_University = $(this).find('.clsUniversity').val();
                    var txt_Marks = $(this).find('.clsMarks').val();
                    var txtYear = $(this).find('.clsPassingYear').val();

                    if (txt_Education != "" && txt_University != "" && txtYear != "") {
                        _isValidate = 0;
                        XmlRequest += "<RECORD><IPD_EDU_NAME>" + txt_Education + "</IPD_EDU_NAME>";
                        XmlRequest += "<IPD_UNIVERSITY_NAME>" + txt_University + "</IPD_UNIVERSITY_NAME>";
                        XmlRequest += "<IPD_EDU_MARKS>" + txt_Marks + "</IPD_EDU_MARKS>";
                        XmlRequest += "<IPD_EDU_PASSING_YEAR>" + txtYear + "</IPD_EDU_PASSING_YEAR></RECORD>";
                    }
                    else {
                        _isValidate = 1;
                    }
                });
                XmlRequest += "</DATASET>";
            }
            else {
                XmlRequest = "<DATASET></DATASET>";
            }
            if (parseInt(_isValidate) == 0) {

                //--------------------FAMILY History Details Start from here 

                var XmlRequest_FamilyHistory = "<DATASET>";
                $('#tblFamilyHistory tr').not(':first').each(function() {
                    debugger;
                    var _FamilyHistoryCode = $(this).find(".hdnFamilyHistoryCode").val();
                    var _FamilyHistoryName = $(this).find(".txtFamilyHistory").val();
                    var _FamilyHistoryType = $(this).find(".txtFamilyHistoryType").val();
                    var _FamilyHistorysince = $(this).find(".txtFamilyHistorySince").val();
                    var _FamilyHistoryunit = $(this).find(".ddlFamilyHistoryUnit").val();
                    var _FamilyHistoryRelationship = $(this).find(".ddlFamilyHistoryRelation").val();
                    var _FamilyHistoryRemarks = $(this).find(".txtFamilyHistoryNotesComment").val();

                    if (_FamilyHistoryCode != "" && _FamilyHistoryCode != "0" && _FamilyHistoryCode != undefined) {

                        XmlRequest_FamilyHistory += "<RECORD><FAMILYHISTORY_CODE>" + _FamilyHistoryCode + "</FAMILYHISTORY_CODE>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_NAME>" + _FamilyHistoryName + "</FAMILYHISTORY_NAME>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_TYPE>" + _FamilyHistoryType + "</FAMILYHISTORY_TYPE>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_SINCE>" + _FamilyHistorysince + "</FAMILYHISTORY_SINCE>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_UNIT>" + _FamilyHistoryunit + "</FAMILYHISTORY_UNIT>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_RELATIONSHIP>" + _FamilyHistoryRelationship + "</FAMILYHISTORY_RELATIONSHIP>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORYHISTORY_REMARKS>" + _FamilyHistoryRemarks + "</FAMILYHISTORYHISTORY_REMARKS></RECORD>";
                    }
                });
                XmlRequest_FamilyHistory += "</DATASET>";

                //alert('XmlRequest_FamilyHistory '+ XmlRequest_FamilyHistory);

                //--------------------FAMILY History Details End from here


                //--------------------Patient Complaint Details Start from here 

                var XmlRequest_PatientComplaintHistory = "<DATASET>";
                $('#tblComplaintN tr').not(':first').each(function() {

                    var _PatientComplaintCode = $(this).find(".hdnComplaintCode").val();
                    var _PatientComplaintName = $(this).find(".txtComplaint").val();
                    var _PatientComplaintsince = $(this).find(".txtReportedComplaintSince").val();
                    var _PatientComplaintunit = $(this).find(".ddlReportedComplaintUnit").val();
                    var _PatientComplaintRemarks = $(this).find(".txtcomplaintRemarks").val();

                    if (_PatientComplaintCode != "" && _PatientComplaintCode != "0") {

                        XmlRequest_PatientComplaintHistory += "<RECORD><PATIENTCOMPLAINT_CODE>" + _PatientComplaintCode + "</PATIENTCOMPLAINT_CODE>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_NAME>" + _PatientComplaintName + "</PATIENTCOMPLAINT_NAME>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_SINCE>" + _PatientComplaintsince + "</PATIENTCOMPLAINT_SINCE>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_UNIT>" + _PatientComplaintunit + "</PATIENTCOMPLAINT_UNIT>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_REMARKS>" + _PatientComplaintRemarks + "</PATIENTCOMPLAINT_REMARKS></RECORD>";
                    }
                });
                XmlRequest_PatientComplaintHistory += "</DATASET>";

                //alert(XmlRequest_PatientComplaintHistory);

                //--------------------Patient Complaint Details End from here

                //--------------Allergy xml start from here -----------------------------------------------------------------------------------------
                var XmlRequest_Allergy = "<DATASET>";
                //var _isValidateAllergy = 0;
                debugger;
                $('#tblAllergy tr').not(':first').each(function() {
                    // _isValidateAllergy++;

                    debugger;
                    var _allergyCode = $(this).find(".hdnAllergyCode").val();
                    // var _allergyCode = $(".hdnAllergyCode").val();
                    var _allergyName = $(this).find(".txtAllergy").val();
                    var _allergyType = $(this).find(".txtAllergyType").val();
                    var _since = $(this).find(".txtAllergySince").val();
                    var _unit = $(this).find(".ddlAllergySince").val();
                    var _allergyRemarks = $(this).find(".txtNotesComment").val();

                    if (_allergyCode != "" && _allergyCode != "0") {

                        XmlRequest_Allergy += "<RECORD><ALLERGY_CODE>" + _allergyCode + "</ALLERGY_CODE>";
                        XmlRequest_Allergy += "<ALLERGY_NAME>" + _allergyName + "</ALLERGY_NAME>";
                        XmlRequest_Allergy += "<ALLERGY_TYPE>" + _allergyType + "</ALLERGY_TYPE>";
                        XmlRequest_Allergy += "<SINCE>" + _since + "</SINCE>";
                        XmlRequest_Allergy += "<UNIT_CODE>" + _unit + "</UNIT_CODE>";
                        XmlRequest_Allergy += "<REMARKS>" + _allergyRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_Allergy += "</DATASET>";
                //--------------Allergy xml end from here -----------------------------------------------------------------------------------------

                //--------------Past histroy xml start from here -----------------------------------------------------------------------------------------
                var XmlRequest_PastHistory = "<DATASET>";
                $('#tblPastHistory tr').not(':first').each(function() {

                    var _pastHistoryCode = $(this).find(".hdnPastHistoryCode").val();
                    var _pastHistoryName = $(this).find(".txtPastHistory").val();
                    var _pastHistoryType = $(this).find(".txtPastHistoryType").val();
                    var _pastHistorysince = $(this).find(".txtPastHistorySince").val();
                    var _pastHistoryunit = $(this).find(".ddlPastHistoryUnit").val();
                    var _pastHistoryRemarks = $(this).find(".txtPastHistoryNotesComment").val();

                    if (_pastHistoryCode != "" && _pastHistoryCode != "0") {

                        XmlRequest_PastHistory += "<RECORD><HISTORY_CODE>" + _pastHistoryCode + "</HISTORY_CODE>";
                        XmlRequest_PastHistory += "<HISTORY_TYPE>" + _pastHistoryType + "</HISTORY_TYPE>";
                        XmlRequest_PastHistory += "<HISTORY_NAME>" + _pastHistoryName + "</HISTORY_NAME>";
                        XmlRequest_PastHistory += "<SINCE>" + _pastHistorysince + "</SINCE>";
                        XmlRequest_PastHistory += "<UNIT>" + _pastHistoryunit + "</UNIT>";
                        XmlRequest_PastHistory += "<REMARKS>" + _pastHistoryRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_PastHistory += "</DATASET>";
                //--------------Past histroy xml end from here -----------------------------------------------------------------------------------------

                //--------------------PERSONAL History Details Start from here 

                var XmlRequest_PersonalHistory = "<DATASET>";
                $('#tblPersonalHistory tr').not(':first').each(function() {

                    var _PersonalHistoryCode = $(this).find(".hdnPersonalHistoryCode").val();
                    var _PersonalHistoryName = $(this).find(".txtPersonalHistory").val();
                    //var _pastHistoryType = $(".txtPastHistoryType").val();
                    var _PersonalHistorysince = $(this).find(".txtPersonalHistorySince").val();
                    var _PersonalHistoryunit = $(this).find(".ddlPersonalHistoryUnit").val();
                    var _PersonalHistoryQty = $(this).find(".txtPersonalHistoryQty").val();
                    var _PersonalHistoryQtyUnit = $(this).find(".ddlPersonalHistoryQtyUnit").val();
                    var _PersonalHistoryRemarks = $(this).find(".txtPersonalHistoryNotesComment").val();

                    if (_PersonalHistoryCode != "" && _PersonalHistoryCode != "0") {

                        XmlRequest_PersonalHistory += "<RECORD><PERSONAL_CODE>" + _PersonalHistoryCode + "</PERSONAL_CODE>";
                        XmlRequest_PersonalHistory += "<PERSONAL_NAME>" + _PersonalHistoryName + "</PERSONAL_NAME>";
                        XmlRequest_PersonalHistory += "<SINCE>" + _PersonalHistorysince + "</SINCE>";
                        XmlRequest_PersonalHistory += "<UNIT>" + _PersonalHistoryunit + "</UNIT>";
                        XmlRequest_PersonalHistory += "<QTY>" + _PersonalHistoryQty + "</QTY>";
                        XmlRequest_PersonalHistory += "<QTY_UNIT>" + _PersonalHistoryQtyUnit + "</QTY_UNIT>";
                        XmlRequest_PersonalHistory += "<REMARKS>" + _PersonalHistoryRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_PersonalHistory += "</DATASET>";

                //alert('XmlRequest_PersonalHistory'+ XmlRequest_PersonalHistory);

                //--------------------PERSONAL History Details End from here


                var XmlRequest_PatientDisease = "<DATASET>";
                $('#tblDisease tr').not(':first').each(function() {

                    var _PatientDiseaseCode = $(this).find(".hdnDiseaseCode").val();
                    var _PatientDiseaseName = $(this).find(".txtDisease").val();
                    var _PatientDiseasesince = $(this).find(".txtProvisionalDisease").val();
                    var _PatientDiseaseunit = $(this).find(".ddlProvisionalDiseaseUnit").val();
                    var _PatientDiseaseRemarks = $(this).find(".txtDiseaseRemarks").val();

                    if (_PatientDiseaseCode != "" && _PatientDiseaseCode != "0") {

                        XmlRequest_PatientDisease += "<RECORD><DISEASE_CODE>" + _PatientDiseaseCode + "</DISEASE_CODE>";
                        XmlRequest_PatientDisease += "<DISEASE_NAME>" + _PatientDiseaseName + "</DISEASE_NAME>";
                        XmlRequest_PatientDisease += "<SINCE>" + _PatientDiseasesince + "</SINCE>";
                        XmlRequest_PatientDisease += "<UNIT>" + _PatientDiseaseunit + "</UNIT>";
                        XmlRequest_PatientDisease += "<REMARKS>" + _PatientDiseaseRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_PatientDisease += "</DATASET>";

                //alert('XmlRequest_PatientDisease' + XmlRequest_PatientDisease);


                var XmlRequest_AdvisedInvestigation = "<DATASET>";
                $('#tblAdvisedInvestigation tr').not(':first').each(function() {

                    var _AdvisedInvestigationCode = $(this).find(".hdnalreadyinvcode").val();
                    var _AdvisedInvestigationName = $(this).find(".txtAdvisedInvestigation").val();

                    if (_AdvisedInvestigationCode != "" && _AdvisedInvestigationCode != "0") {

                        XmlRequest_AdvisedInvestigation += "<RECORD><ADVISEDINVESTIGATION_CODE>" + _AdvisedInvestigationCode + "</ADVISEDINVESTIGATION_CODE>";
                        XmlRequest_AdvisedInvestigation += "<ADVISEDINVESTIGATION_NAME>" + _AdvisedInvestigationName + "</ADVISEDINVESTIGATION_NAME></RECORD>";
                    }
                });
                XmlRequest_AdvisedInvestigation += "</DATASET>";
                
                
                 var XmlRequest_Procedure = "<DATASET>";
                $('#tblProcedure tr').not(':first').each(function() {

                    var _ProcedureCode = $(this).find(".hdnalreadyProcedurecode").val();
                    var _ProcedureName = $(this).find(".txtProcedure").val();

                    if (_ProcedureCode != "" && _ProcedureCode != "0") {

                        XmlRequest_Procedure += "<RECORD><PROCEDURE_CODE>" + _ProcedureCode + "</PROCEDURE_CODE>";
                        XmlRequest_Procedure += "<PROCEDURE_NAME>" + _ProcedureName + "</PROCEDURE_NAME></RECORD>";
                    }
                });
                XmlRequest_Procedure += "</DATASET>";

                //--------------------Patient Disease Details End from here
                _PAYMODE = $("#ddlPaymode").val();
                _PAID_AMOUNT = $("#txtPaidAmt").val();
                //_BALANCE_AMOUNT = $("#txtBalanceAmount").val();
                // _OTHER_CHARGES_PER = $("#txtOtherChargesPercent").val();
                // _OTHER_CHARGES_AMOUNT = $("#txtOtherChargesAmount").val();
                // _INV_DISCOUNT_PERCENT = $("#txtInvoiceDiscount").val();
                // _INV_DISCOUNT_AMOUNT = $("#txtInvoiceDiscAmount").val();
                // _AMOUNT = $("#txtAmount").val();
                //_DISCOUNT = $("#txtDiscount").val();
                //_TAXABLE_AMOUNT = $("#txtTaxableAmount").val();
                //_TAX_AMOUNT = $("#txtTaxAmount").val();
                //_CASH_DISCOUNT = $("#txtSplDiscount").val();
                //_NET_AMOUNT = $("#txtNetAmount").val();
                var XmlConsulation = "<DATASET>";
                var _isValidate = 0;
                $('#tblPanelSearch tr').not(':first').each(function() {//hdnServiceName
                    var hdnServiceCode = $(this).find('.hdnServiceCode').val();
                    var hdnServiceName = $(this).find('.hdnServiceName').val();
                    var _grddisc = $(this).find('.txtDisc').val();
                    var _grdcashdisc = $(this).find('.txtCashDisc').val();
                    var _grdIgst = $(this).find('.txtIGST').val();
                    var _grdCgst = $(this).find('.txtCGST').val();
                    var _grdSgst = $(this).find('.txtSGST').val(); //txtcharges
                    var txtcharges = $(this).find('.txtcharges').val();
                    var _grdMiscTax = $(this).find('.txtMiscTax').val();
                    var _grdMiscCharges = $(this).find('.txtMiscCharges').val();
                    var _grdNetAmt = $(this).find('.spnNetAmt').text();
                    XmlConsulation += "<RECORD><SERVICE_CODE>" + hdnServiceCode + "</SERVICE_CODE>";
                    XmlConsulation += "<SERVICE_NAME>" + hdnServiceName + "</SERVICE_NAME>";
                    XmlConsulation += "<CHARGES>" + txtcharges + "</CHARGES>";
                    XmlConsulation += "<DISCOUNT>" + _grddisc + "</DISCOUNT>";
                    XmlConsulation += "<CASH_DISCOUNT>" + _grdcashdisc + "</CASH_DISCOUNT>";
                    XmlConsulation += "<IGST>" + _grdIgst + "</IGST>";
                    XmlConsulation += "<CGST>" + _grdCgst + "</CGST>";
                    XmlConsulation += "<SGST>" + _grdSgst + "</SGST>";
                    XmlConsulation += "<MISC_TAX>" + _grdMiscTax + "</MISC_TAX>";
                    XmlConsulation += "<MISC_CHARGES>" + _grdMiscCharges + "</MISC_CHARGES>";

                    XmlConsulation += "<NET_AMOUNT>" + _grdNetAmt + "</NET_AMOUNT></RECORD>";
                });
                var _wardNno = ($("#ddlWardNo").val() == "" ? "": $("#ddlWardNo").val() );
                var _roomNOCodes = ($("#ddlRoomNo").val() == "" ? "" : $("#ddlRoomNo").val())

                XmlConsulation += "</DATASET>";
                //alert(XmlConsulation);
                if (parseInt(_isValidate) == 0) {
                    $.ajax({
                        type: 'POST',
                        url: 'IpdShortStay.aspx/SaveRecord',
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'json',
                        cache: false,
                        async: false,
                        data: "{'SHORT_STAY_NO':'" + $("#txtAdmisssion").val() +
                   "','DEPARTMENT_CODE':'" + $("#ddlDepartment").val() +
                   "','DEPARTMENT_NAME':'" + _department_name +
                   "','OPD_CARD_NO':'" + $("#txtOpdCardNo").val() +
                   "','CASUALTY_NO':'" + $("#txtCasualtyNo").val() +
                   "','DOCTOR_CODE':'" + _doctor_Code +
                   "','DOCTOR_NAME':'" + _doctor_Name +
                   "','DATE':'" + $("#txtDate").val() +
                   "','REFERRED_BY_CODE':'" + _txtRefferedByCode +
                   "','REFERRED_BY_NAME':'" + _txtReferredByName +
                   "','VALIDITY':'" + $("#txtValidity").val() +
                   "','OLD_NO':'" + $("#txtOldNo").val() +
                   "','WARD_NO':'" + _wardNno +
                   "','BED_NO':'" + $("#txtBedNo").val() +
                   "','GATE_PASS_NO':'" + $("#txtGateNo").val() +
                   "','ROOM_NO_CODE':'" + _roomNOCodes +
                   "','ROOM_NO_NAME':'" + _room_name +
                   "','MLC_NO':'" + $("#txtMlcNo").val() +
                   "','MLC_DATETIME':'" + $("#txtMlcDateTime").val() +
                   "','MLC_URL':'" + '' +
                   "','UHID':'" + $("#txtUhid").val() +
                   "','NAME':'" + $("#txtname").val() +
                   "','MOBILE':'" + $("#txtMobile").val() +
                   "','ALTERNATE_MOBILE':'" + $("#txtAlternateMob").val() +
                   "','GENDER':'" + $("#ddlGender").val() +
                   "','DOB':'" + $("#txtDateOfBirth").val() +
                   "','AGE_YY':'" + $("#txtyy").val() +
                   "','AGE_MM':'" + $("#txtmm").val() +
                   "','AGE_DD':'" + $("#txtdd").val() +
                   "','IS_LITERATE':'" + _checkLiterate +
                   "','LANGUAGE_OF_CHOICE':'" + $("#ddlLanguage").val() +
                   "','AADHAAR_NO':'" + $("#txtAadharNo").val() +
                   "','MARITAL_STATUS':'" + $("#ddlmaritalStatus").val() +
                   "','RELIGION_CODE':'" + $("#ddlReligion").val() +
                   "','RELIGION_NAME':'" + _religion_name +
                   "','EMAIL':'" + $("#txtEmail").val() +
                   "','GUARDIAN':'" + $("#txtfatherHusband").val() +
                   "','FAMILY_INCOME':'" + $("#txtFamilyIncome").val() +
                   "','OCCUPATION_CODE':'" + $("#ddlOccupation").val() +
                   "','OCCUPATION_NAME':'" + _occupation_name +
                   "','DIET':'" + $("#ddlDiet").val() +
                   "','PATIENT_CONDITION':'" + $("#ddlCondition").val() +
                   "','PATIENT_CATEGORY_CODE':'" + $("#ddlPatientcategory").val() +
                   "','PATIENT_CATEGORY_NAME':'" + _Patient_category +
                    "','AUSHMAN_CARD_NO':'" + _AUSHMAN_CARD_NO +
                   "','BPL_CARD_NO':'" + BPL_CARD_NO +
                   "','COMPANY_NAME':'" + $("#txtCompanyName").val() +
                   "','EMPLOYEE_ID':'" + $("#txtEmployeeId").val() +
                   "','INSURANCE_COMPANY_NAME':'" + $("#txtInsuranceCompanyName").val() +
                   "','POLICY_NUMBER':'" + $("#txtPolicyNo").val() +
                   "','POLICY_AMOUNT':'" + $("#txtPolicyAmount").val() +
                   "','HEIGHT':'" + $("#txtHT").val() +
                   "','WEIGHT':'" + $("#txtWT").val() +
                   "','BLOOD_GROUP':'" + $("#txtBloodGroup").val() +
                   "','APGAR':'" + $("#txtApgarScore").val() +
                   "','GROWTH':'" + $("#txtGrowth").val() +
                   "','WAIST':'" + $("#txtWaist").val() +
                   "','OBESITY':'" + $("#txtObesity").val() +
                   "','ADDRESS':'" + _address +
                   "','HOUSE_NO':'" + $("#txtHouseNo").val() +
                   "','STREET_NAME':'" + $("#txtStreetName").val() +
                   "','STREET_NO':'" + $("#txtStreetNo").val() +
                   "','LANDMARK':'" + $("#txtLandmark").val() +
                   "','LOCALITY_CODE':'" + $("#ddlLocality").val() +
                   "','LOCALITY_NAME':'" + _locality +
                   "','COUNTRY_CODE':'" + $("#ddlCountry").val() +
                   "','COUNTRY_NAME':'" + _country_name +
                   "','STATE_CODE':'" + $("#ddlState").val() +
                   "','STATE_NAME':'" + _state_name +
                   "','CITY_CODE':'" + $("#ddlCity").val() +
                   "','CITY_NAME':'" + _city_name +
                   "','PIN':'" + $("#txtPinNo").val() +
                   "','KIN_NAME':'" + $("#txtkinName").val() +
                   "','KIN_RELATION_CODE':'" + $("#ddlRelation").val() +
                   "','KIN_RELATION_NAME':'" + _kin_relation_Name +
                   "','KIN_CONTACT_NO':'" + $("#txtKinMobile").val() +
                   "','PHONE':'" + $("#txtKinTelNo").val() +
                   "','KIN_ADDRESS':'" + $("#txtKinAddress").val() +
                   "','PREGNANCY':'" + _pregnancy +
                   "','PRENATAL_CHECKUP':'" + _chkParental +
                   "','FULLTERM':'" + _chkFulltTerm +
                   "','LAST_MANTURAL_DATE':'" + $("#txtlastMenstrualDate").val() +
                   "','EST_DELIVARY_DATE':'" + $("#txtEstDate").val() +
                   "','NOTE':'" + $("#txtNotes").val() +
                   "','TRANSITION_TYPE':'" + $("#ddlVisitcategory").val() +
                   "','XML_REQUEST':'" + XmlRequest +
                   "','XML_CONSULTATION':'" + XmlConsulation +
                   "','PAYMODE':'" + _PAYMODE +
                    "','PAID_AMOUNT':'" + _PAID_AMOUNT +
                    "','BALANCE_AMOUNT':'" + _BALANCE_AMOUNT +
                    "','OTHER_CHARGES_PER':'" + _OTHER_CHARGES_PER +
                    "','OTHER_CHARGES_AMOUNT':'" + _OTHER_CHARGES_AMOUNT +
                    "','INV_DISCOUNT_PERCENT':'" + _INV_DISCOUNT_PERCENT +
                    "','INV_DISCOUNT_AMOUNT':'" + _INV_DISCOUNT_AMOUNT +
                    "','AMOUNT':'" + _AMOUNT +
                    "','DISCOUNT':'" + _DISCOUNT +
                    "','TAXABLE_AMOUNT':'" + _TAXABLE_AMOUNT +
                    "','TAX_AMOUNT':'" + _TAX_AMOUNT +
                    "','CASH_DISCOUNT':'" + _CASH_DISCOUNT +
                    "','NET_AMOUNT':'" + _NET_AMOUNT +
                     "','WARD_CATEGORY_CODE':'" + $("#ddlWardCategory").val() +
                     "','WARD_CATEGORY_NAME':'" + $("#ddlWardCategory option:selected").text() +
                     "','BED_CATEGORY_CODE':'" + $("#ddlBedCategory").val() +
                     "','BED_CATEGORY_NAME':'" + $("#ddlBedCategory option:selected").text() +
                     "','SOURCE':'" + $("#Select2").val() +
                     "','PAYER_CODE':'" + $("#ddlPayer").val() +
                     "','PAYER_NAME':'" + $("#ddlPayer option:selected").text() +
                     "','EMERGENCY_NAME':'" + $("#txtEmergencyName").val() +
                     "','EMERGENCY_ADDRESS':'" + $("#txtEmergencyAddress").val() +
                     "','EMERGENCY_CONTACT':'" + $("#txtEmergencyMobile").val() +
                     "','HEALTH_CARD_NO':'" + $("#ddlBedCategory").val() +
                    "','EMERGENCY_CONTACT':'" + $("#txtEmergencyMobile").val() +
                    "','XML_DATA_ALLERGY':'" + XmlRequest_Allergy +
                    "','XML_DATA_PAST_HISTORY':'" + XmlRequest_PastHistory +
                    "','XML_DATA_PERSONAL_HISTORY':'" + XmlRequest_PersonalHistory +
                    "','XML_DATA_DISEASE':'" + XmlRequest_PatientDisease +
                    "','XML_DATA_INVESTIGATION':'" + XmlRequest_AdvisedInvestigation +
                    "','XML_DATA_FAMILY_HISTORY':'" + XmlRequest_FamilyHistory +
                    "','XML_DATA_PATIENT_COMPLAINT':'" + XmlRequest_PatientComplaintHistory +
                    "','WARD_NAME':'" + $("#ddlWardNo option:selected").text() +
                    "','SURGEON_CODE':'" + SurgeonCodeArray +
                    "','SURGEON_NAME':'" + SurgeonNameArray +
                    "','ANESTHETIST_CODE':'" + AnesthetistCodeArray +
                    "','ANESTHETIST_NAME':'" + AnesthetistNameArray +
                    "','DEPENDENT_NAME':'" + $("#txtDependentName").val() +
                    "','RELATION_WITH_DEPENDENT_CODE':'" + $("#ddlDependentRelation").val() +
                    "','RELATION_WITH_DEPENDENT_NAME':'" + _relation_with_Dependent_Name +
                    "','RANK':'" + $("#txtDependentRank").val() +
                     "','PID_NO':'" + $("#txtDependentPidNo").val() +
                    "','P_UNIT':'" + $("#txtDependentPunit").val() +
                    "','R_ADDRESS':'" + $("#txtRaddress").val() +
                    "','XML_DATA_PROCEDURE':'" + XmlRequest_Procedure +                    
                    "','DEPOSITE_DATE':'" + DEPOSITE_DATE +
                    "','DEPOSITE_TIME':'" + DEPOSITE_TIME +
                    "','DEPOSITOR_NAME':'" + DEPOSITOR_NAME +
                    "','BANK_NAME':'" + BANK_NAME +
                    "','TRANSITION_NO':'" + TRANSACTION_NO +
                    "','SPECIAL_INSTRUCTION':'" + _splInstructions +
                    "','OPERATION':'" + _operations +
                    "','DIAGNOSIS':'" + _diagnosis +
                    "','HISTORY_PRESENT_ILLNESS':'" + $("#txtPresentingIlness").val() +
                    "','TREATMENT':'" + $("#txtTreatment").val() + "','PATIENT_RECORD':'" + $("#txtpatientrecord").val() + "'}",
            
                        beforeSend: function() {
                        },
                        success: function(response) {
                            debugger;
                            FileUploadFunction(response.d);
                            DocumentSaveFunction(response.d);
                            //PrintPDF(response.d);
                            $("#divalertSuccess").css("display", "block");
                            $("#strngSuccess").text("Record Saved Successfully !");
                            $("#divalertSuccess").delay(3200).fadeOut(300);
                            var _urlval = document.location.origin + "/IPD/Report/IPDShorStayReport.aspx?ADMISSION_NO=" + response.d;
                            //alert(_urlval);
                            window.location = _urlval;
                            $(window).scrollTop(0, 0);
                            $("#btnReset").trigger('click');
                        },

                        failure: function(response) {
                            alert('Saving Failed');
                        },
                        error: function(response) {
                            alert('Saving Error');
                        }
                    }); //AJAX END HERE
                }
            }
            else {
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please Enter Education, University and Passing Year !");
                $(".clsEducation").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $('.clsEducation').css('border-color', 'red');
                $('.clsUniversity').css('border-color', 'red');
                $('.clsPassingYear').css('border-color', 'red');
                $(window).scrollTop(0, 0);
            }
        });   //BTNSAVE END

        $("#btnUpdateAdmission").click(function() {

            var _pregnancy = 0;
            var _chkParental = 0;
            var _chkFulltTerm = 0;
            var _room_name = '';
            var _locality = '';
            var _department_name = '';
            var _religion_name = '';
            var _occupation_name = '';
            var _city_name = '';
            var _country_name = '';
            var _state_name = '';
            var _kin_relation_Name = '';
            var _address = '';
            var _validity = '';
            var _Patient_category = '';
            var fileUpload = $("#FileUpload1").get(0);
            var files = fileUpload.files;
            var _txtRefferedByCode = '';
            var _txtReferredByName = '';
            var _doctor_Code = '';
            var _doctor_Name = '';
            var _checkLiterate = 0;
            var _mlcUrl = $("#adownload").attr("href").substring(8);
            var _PAYMODE = '';
            var _PAID_AMOUNT = 0;
            var _BALANCE_AMOUNT = 0;
            var _OTHER_CHARGES_PER = 0;
            var _OTHER_CHARGES_AMOUNT = 0;
            var _INV_DISCOUNT_PERCENT = 0;
            var _INV_DISCOUNT_AMOUNT = 0;
            var _AMOUNT = 0;
            var _DISCOUNT = 0;
            var _TAXABLE_AMOUNT = 0;
            var _TAX_AMOUNT = 0;
            var _CASH_DISCOUNT = 0;
            var _NET_AMOUNT = 0;
            
            var DEPOSITE_DATE='';
            var DEPOSITE_TIME='';
            var DEPOSITOR_NAME='';
            var BANK_NAME='';
            var TRANSACTION_NO='';
            
            //-------PAYMODE-------------
            if ($("#ddlPaymode").val() == 'Cash') 
            {
                DEPOSITE_DATE=$("#txtCashDepositerDate").val();
                DEPOSITE_TIME=$("#txtCashDepositerTime").val();
                DEPOSITOR_NAME=$("#txtCashDepositerName").val();
            }
             else if ($("#ddlPaymode").val() == 'Card') 
            {
                BANK_NAME=$("#txtCardName").val();
                TRANSACTION_NO=$("#txtCardNo").val();               
            }

            else if ($("#ddlPaymode").val() == 'Cheque/Draft') 
            {
                BANK_NAME=$("#txtChequeBankName").val();
                TRANSACTION_NO=$("#txtChequeBankNo").val();                
            }
            else if ($("#ddlPaymode").val() == 'Wallet' || $("#ddlPaymode").val() == 'NEFT') 
            {
                BANK_NAME=$("#txtWalletName").val();
                TRANSACTION_NO=$("#txtWalletTransitionNo").val(); 
            }                 

            if ($("#txtname").val() == "") {
                //$("#txtname").css('border-color','#ccc').css("border-width","thin").css("border-size","1px").css("border-style","solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please enter Name !");
                $("#txtname").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#txtname").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            else if ($("#ddlDepartment").val() == "") {
                $("#txtname").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Department Name !");
                $("#ddlDepartment").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlDepartment").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }
            //else if ($("#ddlWardNo").val() == "") {
            //    $("#ddlDepartment").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            //    $("#divErrorMsg").css("display", "block");
            //    $("#spnerrormsg").text("Please select Ward !");
            //    $("#ddlWardNo").focus();
            //    $("#divErrorMsg").delay(3200).fadeOut(300);
            //    $("#ddlWardNo").css('border-color', 'red');
            //    $(window).scrollTop(0, 0);
            //    return false;
            //}

            //else if ($("#txtMobile").val() == "") {
            //    $("#ddlWardNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            //    $("#divErrorMsg").css("display", "block");
            //    $("#spnerrormsg").text("Please enter Mobile Number !");
            //    $("#txtMobile").focus();
            //    $("#divErrorMsg").delay(3200).fadeOut(300);
            //    $("#txtMobile").css('border-color', 'red');
            //    $(window).scrollTop(0, 0);
            //    return false;
            //}


            else if ($("#ddlGender").val() == "") {
                $("#txtMobile").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please select Gender !");
                $("#ddlGender").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $("#ddlGender").css('border-color', 'red');
                $(window).scrollTop(0, 0);
                return false;
            }

            else if (files.length == "1") {

                if ($("#txtMlcNo").val() == "") {
                    $("#txtMlcNo").css('border-color', 'red');
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please enter MLC No. !");
                    $("#txtMlcNo").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(window).scrollTop(0, 0);
                    return false;
                }
                else {

                    $("#txtMlcNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                }

            }
            $("#ddlGender").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlWardNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtMobile").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtname").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#txtMlcNo").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
            $("#ddlDepartment").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");



            if ($("#txtHouseNo").val() == '' || $("#txtStreetName").val() == '' || $("#txtStreetNo").val() == '' || $("#txtLandmark").val() == '') {
                _address = '';
            }
            else {
                _address = 'House No.' + $("#txtHouseNo").val() + ', Street Name: ' + $("#txtStreetName").val() + ', Street No.' + $("#txtStreetNo").val() + ', Landmark: ' + $("#txtLandmark").val();
            }

            if ($("#chkPregnancy").prop('checked')) {
                _pregnancy = 1;
            }
            else {
                _pregnancy = 0;
            }

            if ($("#chkParental").prop('checked')) {
                _chkParental = 1;
            }
            else {
                _chkParental = 0;
            }

            if ($("#chkFulltTerm").prop('checked')) {
                _chkFulltTerm = 1;
            }
            else {
                _chkFulltTerm = 0;
            }

            if ($("#ddlLocality option:selected").text() == '') {
                _locality = '';
            }
            else {
                _locality = ($("#ddlLocality option:selected").text());
            }

            if ($("#ddlPatientcategory option:selected").text() == '') {
                _Patient_category = '';
            }
            else {
                _Patient_category = ($("#ddlPatientcategory option:selected").text());
            }

            if ($("#ddlRoomNo option:selected").text() == '') {
                _room_name ='';
            }
            else {
                _room_name = ($("#ddlRoomNo option:selected").text());
            }


            if ($("#ddlReligion option:selected").text() == '') {
                _religion_name = '';
            }
            else {
                _religion_name = ($("#ddlReligion option:selected").text());
            }


            if ($("#ddlOccupation option:selected").text() == '') {
                _occupation_name = '';
            }
            else {
                _occupation_name = ($("#ddlOccupation option:selected").text());
            }


            if ($("#ddlCity option:selected").text() == '') {
                _city_name = '';
            }
            else {
                _city_name = ($("#ddlCity option:selected").text());
            }


            if ($("#ddlState option:selected").text() == '') {
                _state_name = '';
            }
            else {
                _state_name = ($("#ddlState option:selected").text());
            }

            if ($("#ddlDepartment option:selected").text() == '') {
                _department_name = '';
            }
            else {
                _department_name = ($("#ddlDepartment option:selected").text());
            }

            if ($("#ddlCountry option:selected").text() == '') {
                _country_name = '';
            }
            else {
                _country_name = ($("#ddlCountry option:selected").text());
            }


            if ($("#ddlRelation option:selected").text() == '') {
                _kin_relation_Name ='';
            }
            else {
                _kin_relation_Name = ($("#ddlRelation option:selected").text());
            }

//            if ($("#txtReferredBy").val() == '') {
//                _txtRefferedByCode = 0;
//            }
//            else {
//                _txtRefferedByCode = ($("#txtReferredBy").val().substring(0, 2));
//            }

            if ($("#txtReferredBy").val() == '') {
                _txtReferredByName = '';
            }
            else {
                _txtReferredByName = ($("#txtReferredBy").val());
            }

            if ($("#txtDoctor").val() == '') {
                _doctor_Code = '';
            }
            else {
                _doctor_Code = ($("#txtDoctor").val());
            }

            if ($("#txtDoctor").val() == '') {
                _doctor_Name = '';
            }
            else {
                _doctor_Name = ($("#txtDoctor option:selected").text());
            }


            var SurgeonCodeArray='';
            var SurgeonNameArray='';
            $("#ddlSurgeon option:selected").each(function()
            {            
                var SurgeonCode = $(this).val();  
                var SurgeonName = $(this).text();     

                if(SurgeonCodeArray!="")
                {            
                    SurgeonCodeArray = SurgeonCodeArray.concat(",",SurgeonCode) ;
                    SurgeonNameArray = SurgeonNameArray.concat(",",SurgeonName) ;
                }
                else
                {            
                    SurgeonCodeArray = SurgeonCode;
                    SurgeonNameArray = SurgeonName;
                }
            });
            
            var AnesthetistCodeArray='';
            var AnesthetistNameArray='';
            $("#ddlAnesthetist option:selected").each(function()
            {            
                var AnesthetistCode = $(this).val();  
                var AnesthetistName = $(this).text();     

                if(AnesthetistCodeArray!="")
                {            
                    AnesthetistCodeArray = AnesthetistCodeArray.concat(",",AnesthetistCode) ;
                    AnesthetistNameArray = AnesthetistNameArray.concat(",",AnesthetistName) ;
                }
                else
                {            
                    AnesthetistCodeArray = AnesthetistCode;
                    AnesthetistNameArray = AnesthetistName;
                }
            });
            
            var _short_stay = 1;
           
            var _relation_with_Dependent_Name ='';
            
//            ($("#ddlSurgeon").val() == '0') ?  _surgeon_Name : _surgeon_Name=($("#ddlSurgeon option:selected").text()) ;
//            
//            ($("#ddlAnesthetist").val() == '0') ?  _anesthetist_Name : _anesthetist_Name=($("#ddlAnesthetist option:selected").text()) ;
            
//            ($("#chkShortStay").prop('checked')) ?  _short_stay = 1 :  _short_stay = 0;
            
            ($("#ddlDependentRelation").val() == '0') ?  _relation_with_Dependent_Name : _relation_with_Dependent_Name=($("#ddlDependentRelation option:selected").text()) ;
            
            
            var XmlRequest = "<DATASET>";
            var _isValidate = 0;

            if ($("#chkUnchekLiterate").attr('class') == "fa fa-check-square-o") {
                if ($(".clsEducation").val() == "") {
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please Enter Education !");
                    $(".clsEducation").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(".clsEducation").css('border-color', 'red');
                    $(window).scrollTop(0, 0);
                    return false;
                }
                else if ($(".clsUniversity").val() == "") {
                    $(".clsEducation").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please Enter University !");
                    $(".clsUniversity").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(".clsUniversity").css('border-color', 'red');
                    $(window).scrollTop(0, 0);
                    return false;
                }
                else if ($(".clsPassingYear").val() == "") {
                    $(".clsUniversity").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                    $("#divErrorMsg").css("display", "block");
                    $("#spnerrormsg").text("Please Enter Passing Year !");
                    $(".clsPassingYear").focus();
                    $("#divErrorMsg").delay(3200).fadeOut(300);
                    $(".clsPassingYear").css('border-color', 'red');
                    $(window).scrollTop(0, 0);
                    return false;
                }
                $(".clsEducation").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $(".clsUniversity").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");
                $(".clsPassingYear").css('border-color', '#ccc').css("border-width", "thin").css("border-size", "1px").css("border-style", "solid");

                if (counterEducation > 0) {
                    $('#tblEditEducationId tr').not(':first').each(function() {

                        var txt_Education = $(this).find('.clsEducation').val();
                        var txt_University = $(this).find('.clsUniversity').val();
                        var txt_Marks = $(this).find('.clsMarks').val();
                        var txtYear = $(this).find('.clsPassingYear').val();


                        if (txt_Education != "" && txt_University != "" && txtYear != "") {
                            _isValidate = 0;
                            XmlRequest += "<RECORD><IPD_EDU_NAME>" + txt_Education + "</IPD_EDU_NAME>";
                            XmlRequest += "<IPD_UNIVERSITY_NAME>" + txt_University + "</IPD_UNIVERSITY_NAME>";
                            XmlRequest += "<IPD_EDU_MARKS>" + txt_Marks + "</IPD_EDU_MARKS>";
                            XmlRequest += "<IPD_EDU_PASSING_YEAR>" + txtYear + "</IPD_EDU_PASSING_YEAR></RECORD>";
                        }
                        else {
                            _isValidate = 1;
                        }
                    });
                    XmlRequest += "</DATASET>";
                }
                else {
                    $('#tblEducationId tr').not(':first').each(function() {

                        var txt_Education = $(this).find('.clsEducation').val();
                        var txt_University = $(this).find('.clsUniversity').val();
                        var txt_Marks = $(this).find('.clsMarks').val();
                        var txtYear = $(this).find('.clsPassingYear').val();


                        if (txt_Education != "" && txt_University != "" && txtYear != "") {
                            _isValidate = 0;
                            XmlRequest += "<RECORD><IPD_EDU_NAME>" + txt_Education + "</IPD_EDU_NAME>";
                            XmlRequest += "<IPD_UNIVERSITY_NAME>" + txt_University + "</IPD_UNIVERSITY_NAME>";
                            XmlRequest += "<IPD_EDU_MARKS>" + txt_Marks + "</IPD_EDU_MARKS>";
                            XmlRequest += "<IPD_EDU_PASSING_YEAR>" + txtYear + "</IPD_EDU_PASSING_YEAR></RECORD>";
                        }
                        else {
                            _isValidate = 1;
                        }
                    });
                    XmlRequest += "</DATASET>";
                }
                _checkLiterate = 1;
            }
            else {
                XmlRequest += "</DATASET>";
                _checkLiterate = 0;
            }
            if (parseInt(_isValidate) == 0) {


                //--------------------FAMILY History Details Start from here 

                var XmlRequest_FamilyHistory = "<DATASET>";
                $('#tblFamilyHistory tr').not(':first').each(function() {
                    debugger;
                    var _FamilyHistoryCode = $(this).find(".hdnFamilyHistoryCode").val();
                    var _FamilyHistoryName = $(this).find(".txtFamilyHistory").val();
                    var _FamilyHistoryType = $(this).find(".txtFamilyHistoryType").val();
                    var _FamilyHistorysince = $(this).find(".txtFamilyHistorySince").val();
                    var _FamilyHistoryunit = $(this).find(".ddlFamilyHistoryUnit").val();
                    var _FamilyHistoryRelationship = $(this).find(".ddlFamilyHistoryRelation").val();
                    var _FamilyHistoryRemarks = $(this).find(".txtFamilyHistoryNotesComment").val();

                    if (_FamilyHistoryCode != "" && _FamilyHistoryCode != "0") {

                        XmlRequest_FamilyHistory += "<RECORD><FAMILYHISTORY_CODE>" + _FamilyHistoryCode + "</FAMILYHISTORY_CODE>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_NAME>" + _FamilyHistoryName + "</FAMILYHISTORY_NAME>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_TYPE>" + _FamilyHistoryType + "</FAMILYHISTORY_TYPE>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_SINCE>" + _FamilyHistorysince + "</FAMILYHISTORY_SINCE>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_UNIT>" + _FamilyHistoryunit + "</FAMILYHISTORY_UNIT>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORY_RELATIONSHIP>" + _FamilyHistoryRelationship + "</FAMILYHISTORY_RELATIONSHIP>";
                        XmlRequest_FamilyHistory += "<FAMILYHISTORYHISTORY_REMARKS>" + _FamilyHistoryRemarks + "</FAMILYHISTORYHISTORY_REMARKS></RECORD>";
                    }
                });
                XmlRequest_FamilyHistory += "</DATASET>";

                //alert('XmlRequest_FamilyHistory '+ XmlRequest_FamilyHistory);

                //--------------------FAMILY History Details End from here


                //--------------------Patient Complaint Details Start from here 

                var XmlRequest_PatientComplaintHistory = "<DATASET>";
                $('#tblComplaintN tr').not(':first').each(function() {

                    var _PatientComplaintCode = $(this).find(".hdnComplaintCode").val();
                    var _PatientComplaintName = $(this).find(".txtComplaint").val();
                    var _PatientComplaintsince = $(this).find(".txtReportedComplaintSince").val();
                    var _PatientComplaintunit = $(this).find(".ddlReportedComplaintUnit").val();
                    var _PatientComplaintRemarks = $(this).find(".txtcomplaintRemarks").val();

                    if (_PatientComplaintCode != "" && _PatientComplaintCode != "0") {

                        XmlRequest_PatientComplaintHistory += "<RECORD><PATIENTCOMPLAINT_CODE>" + _PatientComplaintCode + "</PATIENTCOMPLAINT_CODE>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_NAME>" + _PatientComplaintName + "</PATIENTCOMPLAINT_NAME>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_SINCE>" + _PatientComplaintsince + "</PATIENTCOMPLAINT_SINCE>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_UNIT>" + _PatientComplaintunit + "</PATIENTCOMPLAINT_UNIT>";
                        XmlRequest_PatientComplaintHistory += "<PATIENTCOMPLAINT_REMARKS>" + _PatientComplaintRemarks + "</PATIENTCOMPLAINT_REMARKS></RECORD>";
                    }
                });
                XmlRequest_PatientComplaintHistory += "</DATASET>";

                //alert(XmlRequest_PatientComplaintHistory);

                //--------------------Patient Complaint Details End from here

                //--------------Allergy xml start from here -----------------------------------------------------------------------------------------
                var XmlRequest_Allergy = "<DATASET>";
                //var _isValidateAllergy = 0;
                debugger;
                $('#tblAllergy tr').not(':first').each(function() {
                    // _isValidateAllergy++;

                    debugger;
                    var _allergyCode = $(this).find(".hdnAllergyCode").val();
                    // var _allergyCode = $(".hdnAllergyCode").val();
                    var _allergyName = $(this).find(".txtAllergy").val();
                    var _allergyType = $(this).find(".txtAllergyType").val();
                    var _since = $(this).find(".txtAllergySince").val();
                    var _unit = $(this).find(".ddlAllergySince").val();
                    var _allergyRemarks = $(this).find(".txtNotesComment").val();

                    if (_allergyCode != "" && _allergyCode != "0") {

                        XmlRequest_Allergy += "<RECORD><ALLERGY_CODE>" + _allergyCode + "</ALLERGY_CODE>";
                        XmlRequest_Allergy += "<ALLERGY_NAME>" + _allergyName + "</ALLERGY_NAME>";
                        XmlRequest_Allergy += "<ALLERGY_TYPE>" + _allergyType + "</ALLERGY_TYPE>";
                        XmlRequest_Allergy += "<SINCE>" + _since + "</SINCE>";
                        XmlRequest_Allergy += "<UNIT_CODE>" + _unit + "</UNIT_CODE>";
                        XmlRequest_Allergy += "<REMARKS>" + _allergyRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_Allergy += "</DATASET>";
                //--------------Allergy xml end from here -----------------------------------------------------------------------------------------

                //--------------Past histroy xml start from here -----------------------------------------------------------------------------------------
                var XmlRequest_PastHistory = "<DATASET>";
                $('#tblPastHistory tr').not(':first').each(function() {

                    var _pastHistoryCode = $(this).find(".hdnPastHistoryCode").val();
                    var _pastHistoryName = $(this).find(".txtPastHistory").val();
                    var _pastHistoryType = $(this).find(".txtPastHistoryType").val();
                    var _pastHistorysince = $(this).find(".txtPastHistorySince").val();
                    var _pastHistoryunit = $(this).find(".ddlPastHistoryUnit").val();
                    var _pastHistoryRemarks = $(this).find(".txtPastHistoryNotesComment").val();

                    if (_pastHistoryCode != "" && _pastHistoryCode != "0") {

                        XmlRequest_PastHistory += "<RECORD><HISTORY_CODE>" + _pastHistoryCode + "</HISTORY_CODE>";
                        XmlRequest_PastHistory += "<HISTORY_TYPE>" + _pastHistoryType + "</HISTORY_TYPE>";
                        XmlRequest_PastHistory += "<HISTORY_NAME>" + _pastHistoryName + "</HISTORY_NAME>";
                        XmlRequest_PastHistory += "<SINCE>" + _pastHistorysince + "</SINCE>";
                        XmlRequest_PastHistory += "<UNIT>" + _pastHistoryunit + "</UNIT>";
                        XmlRequest_PastHistory += "<REMARKS>" + _pastHistoryRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_PastHistory += "</DATASET>";
                //--------------Past histroy xml end from here -----------------------------------------------------------------------------------------

                //--------------------PERSONAL History Details Start from here 

                var XmlRequest_PersonalHistory = "<DATASET>";
                $('#tblPersonalHistory tr').not(':first').each(function() {

                    var _PersonalHistoryCode = $(this).find(".hdnPersonalHistoryCode").val();
                    var _PersonalHistoryName = $(this).find(".txtPersonalHistory").val();
                    //var _pastHistoryType = $(".txtPastHistoryType").val();
                    var _PersonalHistorysince = $(this).find(".txtPersonalHistorySince").val();
                    var _PersonalHistoryunit = $(this).find(".ddlPersonalHistoryUnit").val();
                    var _PersonalHistoryQty = $(this).find(".txtPersonalHistoryQty").val();
                    var _PersonalHistoryQtyUnit = $(this).find(".ddlPersonalHistoryQtyUnit").val();
                    var _PersonalHistoryRemarks = $(this).find(".txtPersonalHistoryNotesComment").val();

                    if (_PersonalHistoryCode != "" && _PersonalHistoryCode != "0") {

                        XmlRequest_PersonalHistory += "<RECORD><PERSONAL_CODE>" + _PersonalHistoryCode + "</PERSONAL_CODE>";
                        XmlRequest_PersonalHistory += "<PERSONAL_NAME>" + _PersonalHistoryName + "</PERSONAL_NAME>";
                        XmlRequest_PersonalHistory += "<SINCE>" + _PersonalHistorysince + "</SINCE>";
                        XmlRequest_PersonalHistory += "<UNIT>" + _PersonalHistoryunit + "</UNIT>";
                        XmlRequest_PersonalHistory += "<QTY>" + _PersonalHistoryQty + "</QTY>";
                        XmlRequest_PersonalHistory += "<QTY_UNIT>" + _PersonalHistoryQtyUnit + "</QTY_UNIT>";
                        XmlRequest_PersonalHistory += "<REMARKS>" + _PersonalHistoryRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_PersonalHistory += "</DATASET>";

                //alert('XmlRequest_PersonalHistory'+ XmlRequest_PersonalHistory);

                //--------------------PERSONAL History Details End from here


                var XmlRequest_PatientDisease = "<DATASET>";
                $('#tblDisease tr').not(':first').each(function() {

                    var _PatientDiseaseCode = $(this).find(".hdnDiseaseCode").val();
                    var _PatientDiseaseName = $(this).find(".txtDisease").val();
                    var _PatientDiseasesince = $(this).find(".txtProvisionalDisease").val();
                    var _PatientDiseaseunit = $(this).find(".ddlProvisionalDiseaseUnit").val();
                    var _PatientDiseaseRemarks = $(this).find(".txtDiseaseRemarks").val();

                    if (_PatientDiseaseCode != "" && _PatientDiseaseCode != "0") {

                        XmlRequest_PatientDisease += "<RECORD><DISEASE_CODE>" + _PatientDiseaseCode + "</DISEASE_CODE>";
                        XmlRequest_PatientDisease += "<DISEASE_NAME>" + _PatientDiseaseName + "</DISEASE_NAME>";
                        XmlRequest_PatientDisease += "<SINCE>" + _PatientDiseasesince + "</SINCE>";
                        XmlRequest_PatientDisease += "<UNIT>" + _PatientDiseaseunit + "</UNIT>";
                        XmlRequest_PatientDisease += "<REMARKS>" + _PatientDiseaseRemarks + "</REMARKS></RECORD>";
                    }
                });
                XmlRequest_PatientDisease += "</DATASET>";

                //alert('XmlRequest_PatientDisease' + XmlRequest_PatientDisease);


                var XmlRequest_AdvisedInvestigation = "<DATASET>";
                $('#tblAdvisedInvestigation tr').not(':first').each(function() {

                    var _AdvisedInvestigationCode = $(this).find(".hdnalreadyinvcode").val();
                    var _AdvisedInvestigationName = $(this).find(".txtAdvisedInvestigation").val();

                    if (_AdvisedInvestigationCode != "" && _AdvisedInvestigationCode != "0") {

                        XmlRequest_AdvisedInvestigation += "<RECORD><ADVISEDINVESTIGATION_CODE>" + _AdvisedInvestigationCode + "</ADVISEDINVESTIGATION_CODE>";
                        XmlRequest_AdvisedInvestigation += "<ADVISEDINVESTIGATION_NAME>" + _AdvisedInvestigationName + "</ADVISEDINVESTIGATION_NAME></RECORD>";
                    }
                });
                XmlRequest_AdvisedInvestigation += "</DATASET>";

                //--------------------Patient Disease Details End from here
                
                 var XmlRequest_Procedure = "<DATASET>";
                $('#tblProcedure tr').not(':first').each(function() {

                    var _ProcedureCode = $(this).find(".hdnalreadyProcedurecode").val();
                    var _ProcedureName = $(this).find(".txtProcedure").val();

                    if (_ProcedureCode != "" && _ProcedureCode != "0") {

                        XmlRequest_Procedure += "<RECORD><PROCEDURE_CODE>" + _ProcedureCode + "</PROCEDURE_CODE>";
                        XmlRequest_Procedure += "<PROCEDURE_NAME>" + _ProcedureName + "</PROCEDURE_NAME></RECORD>";
                    }
                });
                XmlRequest_Procedure += "</DATASET>";


                _PAYMODE = $("#ddlPaymode").val();
                _PAID_AMOUNT = $("#txtPaidAmt").val();
                //_BALANCE_AMOUNT = $("#txtBalanceAmount").val();
                //_OTHER_CHARGES_PER = $("#txtOtherChargesPercent").val();
                //_OTHER_CHARGES_AMOUNT = $("#txtOtherChargesAmount").val();
                //_INV_DISCOUNT_PERCENT = $("#txtInvoiceDiscount").val();
                //_INV_DISCOUNT_AMOUNT = $("#txtInvoiceDiscAmount").val();
                //_AMOUNT = $("#txtAmount").val();
                //_DISCOUNT = $("#txtDiscount").val();
                //_TAXABLE_AMOUNT = $("#txtTaxableAmount").val();
                //_TAX_AMOUNT = $("#txtTaxAmount").val();
                //_CASH_DISCOUNT = $("#txtSplDiscount").val();
               // _NET_AMOUNT = $("#txtNetAmount").val();
                var XmlConsulation = "<DATASET>";
                var _isValidate = 0;
                $('#tblPanelSearch tr').not(':first').each(function() {//hdnServiceName
                    var hdnServiceCode = $(this).find('.hdnServiceCode').val();
                    var hdnServiceName = $(this).find('.hdnServiceName').val();
                    var _grddisc = $(this).find('.txtDisc').val();
                    var _grdcashdisc = $(this).find('.txtCashDisc').val();
                    var _grdIgst = $(this).find('.txtIGST').val();
                    var _grdCgst = $(this).find('.txtCGST').val();
                    var _grdSgst = $(this).find('.txtSGST').val(); //txtcharges
                    var txtcharges = $(this).find('.txtcharges').val();
                    var _grdMiscTax = $(this).find('.txtMiscTax').val();
                    var _grdMiscCharges = $(this).find('.txtMiscCharges').val();
                    var _grdNetAmt = $(this).find('.spnNetAmt').text();
                    XmlConsulation += "<RECORD><SERVICE_CODE>" + hdnServiceCode + "</SERVICE_CODE>";
                    XmlConsulation += "<SERVICE_NAME>" + hdnServiceName + "</SERVICE_NAME>";
                    XmlConsulation += "<CHARGES>" + txtcharges + "</CHARGES>";
                    XmlConsulation += "<DISCOUNT>" + _grddisc + "</DISCOUNT>";
                    XmlConsulation += "<CASH_DISCOUNT>" + _grdcashdisc + "</CASH_DISCOUNT>";
                    XmlConsulation += "<IGST>" + _grdIgst + "</IGST>";
                    XmlConsulation += "<CGST>" + _grdCgst + "</CGST>";
                    XmlConsulation += "<SGST>" + _grdSgst + "</SGST>";
                    XmlConsulation += "<MISC_TAX>" + _grdMiscTax + "</MISC_TAX>";
                    XmlConsulation += "<MISC_CHARGES>" + _grdMiscCharges + "</MISC_CHARGES>";

                    XmlConsulation += "<NET_AMOUNT>" + _grdNetAmt + "</NET_AMOUNT></RECORD>";
                });
                XmlConsulation += "</DATASET>";

                var _splInstructions = $("#txtSplInstructions").val();
                var _operations = $("#txtOperation").val();
                var _diagnosis = $("#txtDiagnosis").val();
                var _wardNno = ($("#ddlWardNo").val() == "" ? "" : $("#ddlWardNo").val());
                var _roomNOCodes = ($("#ddlRoomNo").val() == "" ? "" : $("#ddlRoomNo").val());

                if (parseInt(_isValidate) == 0) {
                    $.ajax({
                        type: 'POST',
                        url: 'IpdShortStay.aspx/UpdateRecord',
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'json',
                        cache: false,
                        async: false,
                        data: "{'SHORT_STAY_NO':'" + $("#txtAdmisssion").val() +
                   "','DEPARTMENT_CODE':'" + $("#ddlDepartment").val() +
                   "','DEPARTMENT_NAME':'" + _department_name +
                   "','OPD_CARD_NO':'" + $("#txtOpdCardNo").val() +
                   "','CASUALTY_NO':'" + $("#txtCasualtyNo").val() +
                   "','DOCTOR_CODE':'" + _doctor_Code +
                   "','DOCTOR_NAME':'" + _doctor_Name +
                   "','DATE':'" + $("#txtDate").val() +
                   "','REFERRED_BY_CODE':'" + _txtRefferedByCode +
                   "','REFERRED_BY_NAME':'" + _txtReferredByName +
                   "','VALIDITY':'" + $("#txtValidity").val() +
                   "','OLD_NO':'" + $("#txtOldNo").val() +
                   "','WARD_NO':'" +_wardNno +
                   "','BED_NO':'" + $("#txtBedNo").val() +
                   "','GATE_PASS_NO':'" + $("#txtGateNo").val() +
                   "','ROOM_NO_CODE':'" + _roomNOCodes +
                   "','ROOM_NO_NAME':'" + _room_name +
                   "','MLC_NO':'" + $("#txtMlcNo").val() +
                   "','MLC_DATETIME':'" + $("#txtMlcDateTime").val() +
                   "','MLC_URL':'" + _mlcUrl +
                   "','UHID':'" + $("#txtUhid").val() +
                   "','NAME':'" + $("#txtname").val() +
                   "','MOBILE':'" + $("#txtMobile").val() +
                   "','ALTERNATE_MOBILE':'" + $("#txtAlternateMob").val() +
                   "','GENDER':'" + $("#ddlGender").val() +
                   "','DOB':'" + $("#txtDateOfBirth").val() +
                   "','AGE_YY':'" + $("#txtyy").val() +
                   "','AGE_MM':'" + $("#txtmm").val() +
                   "','AGE_DD':'" + $("#txtdd").val() +
                   "','IS_LITERATE':'" + _checkLiterate +
                   "','LANGUAGE_OF_CHOICE':'" + $("#ddlLanguage").val() +
                   "','AADHAAR_NO':'" + $("#txtAadharNo").val() +
                   "','MARITAL_STATUS':'" + $("#ddlmaritalStatus").val() +
                   "','RELIGION_CODE':'" + $("#ddlReligion").val() +
                   "','RELIGION_NAME':'" + _religion_name +
                   "','EMAIL':'" + $("#txtEmail").val() +
                   "','GUARDIAN':'" + $("#txtfatherHusband").val() +
                   "','FAMILY_INCOME':'" + $("#txtFamilyIncome").val() +
                   "','OCCUPATION_CODE':'" + $("#ddlOccupation").val() +
                   "','OCCUPATION_NAME':'" + _occupation_name +
                   "','DIET':'" + $("#ddlDiet").val() +
                   "','PATIENT_CONDITION':'" + $("#ddlCondition").val() +
                   "','PATIENT_CATEGORY_CODE':'" + $("#ddlPatientcategory").val() +
                   "','PATIENT_CATEGORY_NAME':'" + _Patient_category +
                   "','COMPANY_NAME':'" + $("#txtCompanyName").val() +
                   "','EMPLOYEE_ID':'" + $("#txtEmployeeId").val() +
                   "','INSURANCE_COMPANY_NAME':'" + $("#txtInsuranceCompanyName").val() +
                   "','POLICY_NUMBER':'" + $("#txtPolicyNo").val() +
                   "','POLICY_AMOUNT':'" + $("#txtPolicyAmount").val() +
                   "','HEIGHT':'" + $("#txtHT").val() +
                   "','WEIGHT':'" + $("#txtWT").val() +
                   "','BLOOD_GROUP':'" + $("#txtBloodGroup").val() +
                   "','APGAR':'" + $("#txtApgarScore").val() +
                   "','GROWTH':'" + $("#txtGrowth").val() +
                   "','WAIST':'" + $("#txtWaist").val() +
                   "','OBESITY':'" + $("#txtObesity").val() +
                   "','LOCALITY_CODE':'" + $("#ddlLocality").val() +
                   "','LOCALITY_NAME':'" + _locality +
                   "','ADDRESS':'" + _address +
                   "','HOUSE_NO':'" + $("#txtHouseNo").val() +
                   "','STREET_NAME':'" + $("#txtStreetName").val() +
                   "','STREET_NO':'" + $("#txtStreetNo").val() +
                   "','LANDMARK':'" + $("#txtLandmark").val() +
                   "','COUNTRY_CODE':'" + $("#ddlCountry").val() +
                   "','COUNTRY_NAME':'" + _country_name +
                   "','STATE_CODE':'" + $("#ddlState").val() +
                   "','STATE_NAME':'" + _state_name +
                   "','CITY_CODE':'" + $("#ddlCity").val() +
                   "','CITY_NAME':'" + _city_name +
                   "','PIN':'" + $("#txtPinNo").val() +
                   "','KIN_NAME':'" + $("#txtkinName").val() +
                   "','KIN_RELATION_CODE':'" + $("#ddlRelation").val() +
                   "','KIN_RELATION_NAME':'" + _kin_relation_Name +
                   "','KIN_CONTACT_NO':'" + $("#txtKinMobile").val() +
                   "','PHONE':'" + $("#txtKinTelNo").val() +
                   "','KIN_ADDRESS':'" + $("#txtKinAddress").val() +
                   "','PREGNANCY':'" + _pregnancy +
                   "','PRENATAL_CHECKUP':'" + _chkParental +
                   "','FULLTERM':'" + _chkFulltTerm +
                   "','LAST_MANTURAL_DATE':'" + $("#txtlastMenstrualDate").val() +
                   "','EST_DELIVARY_DATE':'" + $("#txtEstDate").val() +
                   "','NOTE':'" + $("#txtNotes").val() +
                   "','TRANSITION_TYPE':'" + $("#ddlVisitcategory").val() +
                   "','XML_REQUEST':'" + XmlRequest +
                   "','XML_CONSULTATION':'" + XmlConsulation +
                    "','PAYMODE':'" + _PAYMODE +
                    "','PAID_AMOUNT':'" + _PAID_AMOUNT +
                    "','BALANCE_AMOUNT':'" + _BALANCE_AMOUNT +
                    "','OTHER_CHARGES_PER':'" + _OTHER_CHARGES_PER +
                    "','OTHER_CHARGES_AMOUNT':'" + _OTHER_CHARGES_AMOUNT +
                    "','INV_DISCOUNT_PERCENT':'" + _INV_DISCOUNT_PERCENT +
                    "','INV_DISCOUNT_AMOUNT':'" + _INV_DISCOUNT_AMOUNT +
                    "','AMOUNT':'" + _AMOUNT +
                    "','DISCOUNT':'" + _DISCOUNT +
                    "','TAXABLE_AMOUNT':'" + _TAXABLE_AMOUNT +
                    "','TAX_AMOUNT':'" + _TAX_AMOUNT +
                    "','CASH_DISCOUNT':'" + _CASH_DISCOUNT +
                     "','NET_AMOUNT':'" + _NET_AMOUNT +
                     "','WARD_CATEGORY_CODE':'" + $("#ddlWardCategory").val() +
                     "','WARD_CATEGORY_NAME':'" + $("#ddlWardCategory option:selected").text() +
                     "','BED_CATEGORY_CODE':'" + $("#ddlBedCategory").val() +
                     "','BED_CATEGORY_NAME':'" + $("#ddlBedCategory option:selected").text() +
                     "','SOURCE':'" + $("#Select2").val() +
                     "','PAYER_CODE':'" + $("#ddlPayer").val() +
                     "','PAYER_NAME':'" + $("#ddlPayer option:selected").text() +
                     "','EMERGENCY_NAME':'" + $("#txtEmergencyName").val() +
                     "','EMERGENCY_ADDRESS':'" + $("#txtEmergencyAddress").val() +
                     "','EMERGENCY_CONTACT':'" + $("#txtEmergencyMobile").val() +
                     "','HEALTH_CARD_NO':'" + $("#ddlBedCategory").val() +
                    "','EMERGENCY_CONTACT':'" + $("#txtEmergencyMobile").val() +
                     "','XML_DATA_ALLERGY':'" + XmlRequest_Allergy +
                    "','XML_DATA_PAST_HISTORY':'" + XmlRequest_PastHistory +
                    "','XML_DATA_PERSONAL_HISTORY':'" + XmlRequest_PersonalHistory +
                    "','XML_DATA_DISEASE':'" + XmlRequest_PatientDisease +
                    "','XML_DATA_INVESTIGATION':'" + XmlRequest_AdvisedInvestigation +
                    "','XML_DATA_FAMILY_HISTORY':'" + XmlRequest_FamilyHistory +
                    "','XML_DATA_PATIENT_COMPLAINT':'" + XmlRequest_PatientComplaintHistory +                    
                   "','SURGEON_CODE':'" + SurgeonCodeArray +
                    "','SURGEON_NAME':'" + SurgeonNameArray +
                    "','ANESTHETIST_CODE':'" + AnesthetistCodeArray +
                    "','ANESTHETIST_NAME':'" + AnesthetistNameArray +
                    "','DEPENDENT_NAME':'" + $("#txtDependentName").val() +
                    "','RELATION_WITH_DEPENDENT_CODE':'" + $("#ddlDependentRelation").val() +
                    "','RELATION_WITH_DEPENDENT_NAME':'" + _relation_with_Dependent_Name +
                    "','RANK':'" + $("#txtDependentRank").val() +
                     "','PID_NO':'" + $("#txtDependentPidNo").val() +
                    "','P_UNIT':'" + $("#txtDependentPunit").val() +
                    "','R_ADDRESS':'" + $("#txtRaddress").val() +
                    "','XML_DATA_PROCEDURE':'" + XmlRequest_Procedure +                    
                    "','DEPOSITE_DATE':'" + DEPOSITE_DATE +
                    "','DEPOSITE_TIME':'" + DEPOSITE_TIME +
                    "','DEPOSITOR_NAME':'" + DEPOSITOR_NAME +
                    "','BANK_NAME':'" + BANK_NAME +
                    "','TRANSITION_NO':'" + TRANSACTION_NO +
                    "','SPECIAL_INSTRUCTION':'" + _splInstructions +
                    "','OPERATION':'" + _operations +
                    "','DIAGNOSIS':'" + _diagnosis +
                    "','HISTORY_PRESENT_ILLNESS':'" + $("#txtPresentingIlness").val() +
                    "','TREATMENT':'" + $("#txtTreatment").val() + "','PATIENT_RECORD':'" + $("#txtpatientrecord").val() + "'}",

                        beforeSend: function() {
                        },
                        success: function(response) {
                            FileUploadUPdateFunction($("#txtAdmisssion").val(), $("#adownload").text());
                            UpdateDocuments($("#txtAdmisssion").val());
                            //PrintPDF($("#txtAdmisssion").val());
                            $("#divalertSuccess").css("display", "block");
                            $("#strngSuccess").text("Record Updated Successfully !");
                            $("#divalertSuccess").delay(3200).fadeOut(300);

                            var _urlval = document.location.origin + "/IPD/Report/IPDShorStayReport.aspx?ADMISSION_NO=" + $("#txtAdmisssion").val();
                            //alert(_urlval);
                            window.location = _urlval;
                            //var _urlval = document.location.origin + "/IPD/Report/IPDReport.aspx?ADMISSION_NO=" + $("#txtAdmisssion").val()+ "&IS_SHORT_STAY=" + _short_stay;
                            //alert(_urlval);
                            //window.location = _urlval;
                            $(window).scrollTop(0, 0);
                            $("#btnReset").trigger('click');
                            $('#txtAdmisssion').removeAttr("disabled");
                            $("#btnUpdateAdmission").css("display", "none");
                            $("#btnSaveAdmission").css("display", "");
                        },
                        failure: function(response) {
                            alert('Updation Failed');
                        },
                        error: function(response) {
                            alert('Updation Error');
                        }
                    }); //AJAX END HERE
                }
            }
            else {
                $("#divErrorMsg").css("display", "block");
                $("#spnerrormsg").text("Please Enter Education, University and Passing Year !");
                $(".clsEducation").focus();
                $("#divErrorMsg").delay(3200).fadeOut(300);
                $('.clsEducation').css('border-color', 'red');
                $('.clsUniversity').css('border-color', 'red');
                $('.clsPassingYear').css('border-color', 'red');
                $(window).scrollTop(0, 0);
            }
        });   //BTNUPDATE END

        $("#btnPrintPDF").click(function() {


            //var _urlval = document.location.origin + "/IPD/Report/IPDReport.aspx?ADMISSION_NO=" + $("#txtAdmisssion").val();
            var _urlval = document.location.origin + "/IPD/Report/IPDShorStayReport.aspx?ADMISSION_NO=" + $("#txtAdmisssion").val();
            //alert(_urlval);
            window.location = _urlval;

            $("#btnReset").trigger('click');
        });

        $("#btnReset").click(function() {
            S_id =0;
            $("#chkUnchekLiterate").removeClass('fa fa-check-square-o');
            $("#chkUnchekLiterate").addClass('fa fa-square-o');

            $("#divEducation").html('');
            $("#divEducation").html('<table class="table table-bordered table-hover tblEducation" style="display: " id="tblEducationId"><thead style="font-size: 14px;"><tr><th class="text-center">Education</th><th class="text-center">University</th><th class="text-center">Marks</th><th class="text-center">Passing Year</th><th class="text-center">Action</th></tr></thead><tbody><tr id="tr1"><td><input type="text" class="form-control clsEducation" id="txtEducation" placeholder="Education"></td><td><input type="text" class="form-control clsUniversity" id="txtUniversity" placeholder="University"></td><td><input type="text" class="form-control clsMarks" id="txtMarks" placeholder="Marks"></td><td><input type="text" class="form-control clsPassingYear" id="txtPassingYear" placeholder="Year"></td><td style="width: 120px"><button type="button" id="btnDeleteEducation" onclick="DeleteRowEducation(1)" class="btn btn-danger"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button>&nbsp;&nbsp;<button type="button" id="btnPlusEducation1" onclick="AddRowEducation(1);" class="btn btn-primary btnclsPlusEducation"><i class="fa fa-plus" aria-hidden="true"></i></button></td></tr></tbody></table>');
            $(".FileUpload").val('');
            $(".documentLink").text('');
            $(".clsFileName").val(''); //btnPrintPDF
            $("#btnPrintPDF").css("display", "none");
            $("#adownload").text('');
            $("#txtAdmisssion,#txtDependentName,#txtDependentRank,#txtDependentPidNo,#txtDependentPunit,#txtRaddress,#txtEmergencyMobile,#txtCashDepositerTime,#txtCashDepositerName,#txtCardName,#txtCardNo,#txtChequeBankName,#txtChequeBankNo,#txtWalletName,#txtWalletTransitionNo").val('');
            $("#Select2,#ddlDepartment,#ddlSurgeon,#ddlAnesthetist,#ddlWardCategory,#ddlBedCategory,#ddlDependentRelation").val('0');
            $("#txtOpdCardNo").val('');
            $("#txtCasualtyNo").val('');
            $("#txtDoctor").val('');
            $("#txtDate,#txtCashDepositerDate").val($.datepicker.formatDate("dd/mm/yy", new Date()));
            $("#txtReferredBy").val('');
            $("#txtValidity").val('');
            $("#txtOldNo").val('');
            $("#ddlWardNo").val('0');
            $("#txtBedNo").html($("<option></option>").val("").html(""));
            $("#txtGateNo").val('');
            $("#ddlRoomNo").html($("<option></option>").val("").html(""));
            $("#txtMlcNo").val('');
            $("#txtMlcDateTime").val($.datepicker.formatDate("dd/mm/yy", new Date()));
            $("#FileUpload1").val('');
            $("#txtUhid").val('');
            $("#txtname").val('').attr("disabled", "disabled");
            $("#ddlGender").val('');
            $("#ddlGender").val('').attr("disabled", "disabled");
            $("#txtMobile").val('');
            $("#txtAlternateMob,#txtAadharNo").val('');
            $("#txtDateOfBirth").val('');
            $("#txtyy").val('');
            $("#txtmm").val('');
            $("#txtdd").val('');
            $("#InsuredFieldSet").css("display", "none");
            $("#ddlLanguage").val('0');
            $("#txtfatherHusband").val('');
            $("#ddlReligion").val('0');
            $("#ddlmaritalStatus").val('0');
            $("#txtEmail").val('');
            $("#txtfatherHusband").val('').attr("disabled", "disabled");
            $("#txtFamilyIncome").val('');
            $("#ddlPatientcategory").val('0');
            $("#txtCompanyName").val('');
            $("#txtEmployeeId").val('');
            $("#txtInsuranceCompanyName").val('');
            $("#txtPolicyNo").val('');
            $("#txtPolicyAmount").val('');
            $("#ddlOccupation").val('0');
            $("#ddlDiet").val('0');
            $("#ddlCondition").val('0');
            $("#txtHT").val('');
            $("#txtWT").val('');
            $("#txtBloodGroup").val('');
            $("#txtApgarScore").val('');
            $("#txtGrowth").val('');
            $("#txtWaist").val('');
            $("#txtObesity").val('');
            $("#ddlLocality").val('0');
            $("#txtHouseNo").val('');
            $("#txtStreetName").val('');
            $("#txtStreetNo").val('');
            $("#txtLandmark").val('');
            $("#ddlCountry").val('0');
            $("#ddlState").val('0');
            $("#ddlCity").val('0');
            $("#txtPinNo").val('');
            $("#EducationField").css("display", "none");
            $("#txtkinName").val('');
            $("#ddlRelation").val('0');
            $("#txtKinMobile").val('');
            $("#txtKinTelNo").val('');
            $("#txtKinAddress").val('');
            $("#chkPregnancy,#chkShortStay").removeAttr("checked", "checked");
            $("#chkParental").removeAttr("checked", "checked");
            $("#chkFulltTerm").removeAttr("checked", "checked");
            $("#txtlastMenstrualDate").val('').attr("disabled", "disabled");
            $("#txtEstDate").val('').attr("disabled", "disabled");
            $("#txtNotes").val('');
            $("#txtAdmisssion").removeAttr('disabled');
            $("#btnUpdateAdmission").css('display', 'none');
            $("#btnSaveAdmission").css('display', '');
            $("#tblEditDocumentId").css('display', 'none');
            $("#tblDocumentId").css('display', '');
            $("#tblDocumentId").html('');
            $("#tblDocumentId").html('<table class="table table-bordered table-hover tblDocumentUpload" id="tblDocumentId"><thead style="font-size: 14px;"><tr><th class="text-center">File Name</th><th class="text-center">Upload</th><th class="text-center">Action</th></tr></thead><tbody><tr id="Td1"><td><input type="text" class="form-control clsFileName" id="txtFileName1"placeholder="File Name" /></td><td><input type="file" class="btn btn-primary FileUpload" id="File1" /><a href="#" id="a1" target="_blank" class="documentLink"></a></td><td><button type="button" id="btnDeleteDocument" onclick="DeleteRowDocument(1)" class="btn btn-danger"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button><button type="button" id="btnPlusDocument1" onclick="AddRowDocument(1);" class="btn btn-primary ml-1"class="btn btn-primary btnclsPlusDocument"><i class="fa fa-plus" aria-hidden="true"></i></button></td></tr></tbody></table>');
            $("#ddlPaymode").val(0);
            $("#ddlConsultant").val(0);
            $("#txtPaidAmt").val(0);
            $("#txtBalanceAmount").val(0);
            $("#txtOtherChargesPercent").val(0);
            $("#txtOtherChargesAmount").val(0);
            $("#txtInvoiceDiscount").val(0);

            $("#txtInvoiceDiscAmount").val(0);
            $("#txtAmount").val(0);
            $("#txtDiscount").val(0);
            $("#txtTaxableAmount").val(0);
            $("#txtTaxAmount").val(0);
            $("#txtSplDiscount").val(0);
            $("#txtNetAmount").val(0);
            $("#txtEmergencyAddress").val('');
            $("#txtEmergencyName").val('');
            
            $("#tblPastHistory").html('');
            $('#tblPastHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Past History</th><th style="">Type</th><th style="">Since</th><th style="">Unit</th><th style="">Notes / Comments</th><th style="">Action</th></tr></thead><tbody></tbody>');
            $("#tblAllergy").html('');
            $('#tblAllergy').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th>Allergy Details</th><th>Allergy Type</th><th style="white-space:nowrap">Since</th><th>Unit</th><th>Notes / Comments</th><th>Action</th></tr></thead>');
            $("#tblPersonalHistory").html('');
            $('#tblPersonalHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Habit</th><th style="">Since</th><th style="">Unit</th><th style="">Qty</th><th style="">Unit</th><th style="">Notes / Comments</th><th style="">Action</th></tr></thead><tbody></tbody>');
            $("#tblDisease").html('');
            $('#tblDisease').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Diseases Name</th><th style="">Since</th><th style="">Unit</th><th style="">Remarks (Comments)</th><th style="">Action</th></tr></thead>');
            $("#tblAdvisedInvestigation").html('');
            $('#tblAdvisedInvestigation').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Investigation Name</th><th style="">Action</th></tr></thead>');
            $('#tblAllergy').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnAllergyCode' + 1 + '" class="hdnAllergyCode" value=""/><input type="text" id="txtAllergy' + 1 + '" class="form-control txtAllergy" value=""></td><td><input type="text" id="txtAllergyType' + 1 + '" class="form-control txtAllergyType" value=""></td><td><input type="text" id="txtAllergySince' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtAllergySince"/></td><td><select id="ddlAllergySince' + 1 + '" class="form-control ddlAllergySince" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtNotesComment' + 1 + '" class="txtNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddAllergy' + 1 + '" onclick="AddAllergy(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteAllergy' + 1 + '" onclick="DeleteAllergy(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
            $('#tblPersonalHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnPersonalHistoryCode' + 1 + '" class="hdnPersonalHistoryCode" value=""/><input type="text" id="txtPersonalHistory' + 1 + '" class="form-control txtPersonalHistory" value=""></td><td><input type="text" id="txtPersonalHistorySince' + 1 + '" class="form-control txtPersonalHistorySince" style="width:50px;" value=""></td><td><select id="ddlPersonalHistoryUnit' + 1 + '" class="form-control ddlPersonalHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><input type="text" style="width:50px;" id="txtPersonalHistoryQty' + 1 + '" class="form-control txtPersonalHistoryQty" value=""></td><td><select id="ddlPersonalHistoryQtyUnit' + 1 + '" class="form-control ddlPersonalHistoryQtyUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri;" id="txtPersonalHistoryNotesComment' + 1 + '" class="txtPersonalHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPersonalHistory' + 1 + '" onclick="AddPersonalHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePersonalHistory' + 1 + '" onclick="DeletePersonalHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
            $('#tblDisease').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnDiseaseCode1" class="hdnDiseaseCode" value=""/><input type="text" id="txtDisease1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtDisease"/></td><td><input type="text" id="txtProvisionalDisease' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtProvisionalDisease"/></td><td><select id="ddlProvisionalDiseaseUnit' + 1 + '" class="form-control ddlProvisionalDiseaseUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtDiseaseRemarks1" class="form-control txtDiseaseRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddDisease1" onclick="AddDisease(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteDisease1" onclick="DeleteDisease(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
            $('#tblAdvisedInvestigation').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyinvcode1" class="hdnalreadyinvcode" value=""/><input type="hidden" id="hdnalreadyinvName1" class="hdnalreadyinvName" value=""/><input type="text" id="txtAdvisedInvestigation1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtAdvisedInvestigation"/></td><td style="white-space:nowrap"><button type="button" id="btnAddAdvisedInvestigation1" onclick="AddAdvisedInvestigation(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteAdvisedInvestigation1" onclick="DeleteAdvisedInvestigation(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');

            $('#tblPastHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnPastHistoryCode' + 1 + '" class="hdnPastHistoryCode" value=""/><input type="text" id="txtPastHistory' + 1 + '" class="form-control txtPastHistory" value=""></td><td><input type="text" id="txtPastHistoryType' + 1 + '" class="form-control txtPastHistoryType" value=""></td><td><input type="text" id="txtPastHistorySince' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtPastHistorySince"/></td><td><select id="ddlPastHistoryUnit' + 1 + '" class="form-control ddlPastHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtPastHistoryNotesComment' + 1 + '" class="txtPastHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPastHistory' + 1 + '" onclick="AddPastHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePastHistory' + 1 + '" onclick="DeletePastHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');

            $("#tblComplaintN tbody").remove();
             $("#tblFamilyHistory tbody").remove();
            $('#tblComplaintN').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnComplaintCode1" class="hdnComplaintCode" value=""/><input type="text" id="txtComplaint1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtComplaint"/></td><td><input type="text" id="txtReportedComplaintSince1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtReportedComplaintSince"/></td><td><select id="ddlReportedComplaintUnit' + 1 + '" class="form-control ddlReportedComplaintUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtcomplaintRemarks1" class="form-control txtcomplaintRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint1" onclick="AddComplaint(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint1" onclick="DeleteComplaint(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
            $('#tblFamilyHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnFamilyHistoryCode' + 1 + '" class="hdnFamilyHistoryCode" value=""/><input type="text" id="txtFamilyHistory' + 1 + '" class="form-control txtFamilyHistory" value=""></td><td><input type="text" id="txtFamilyHistoryType' + 1 + '" class="form-control txtFamilyHistoryType" style="width:50px;" value=""></td><td><input type="text" id="txtFamilyHistorySince' + 1 + '" class="form-control txtFamilyHistorySince" style="width:50px;" value=""></td><td><select id="ddlFamilyHistoryUnit' + 1 + '" class="form-control ddlFamilyHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><select style="width:200px;font-family:calibri" id="ddlFamilyHistoryRelation' + 1 + '" class="form-control ddlFamilyHistoryRelation"><option value=""></option><option value="Borther">Borther</option><option value="Sister">Sister</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Cousin">Cousin</option><option value="Nephew">Nephew</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Niece">Niece</option><option value="Great Grandmother">Great Grandmother</option><option value="Great Grandfather">Great Grandfather</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Maternal Uncle">Maternal Uncle</option><option value="Maternal Aunt">Maternal Aunt</option><option value="Daughter-in-law">Daughter-in-law</option><option value="Son-in-law">Son-in-law</option><option value=="Brother-in-law">Brother-in-law</option><option value="Sister-in-law">Sister-in-law</option><select></td><td><textarea style="font-family:calibri;" id="txtFamilyHistoryNotesComment' + 1 + '" class="txtFamilyHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddFamilyHistory' + 1 + '" onclick="AddFamilyHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteFamilyHistory' + 1 + '" onclick="DeleteFamilyHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
        
            $("#tblProcedure tbody").remove();
            $('#tblProcedure').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyProcedurecode1" class="hdnalreadyProcedurecode" value=""/><input type="hidden" id="hdnalreadyProcedureName1" class="hdnalreadyProcedureName" value=""/><input type="text" id="txtProcedure1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtProcedure"/></td><td style="white-space:nowrap"><button type="button" id="btnAddProcedure1" onclick="AddProcedure(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteProcedure1" onclick="DeleteProcedure(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>'); 
            BindAutoCompleteForAllergy(1);
            BindAutoCompleteForPersonalHistory(1);
            BindAutoCompleteForPastHistory(1);
            BindAutoCompleteForDisease(1);
            BindAutoCompleteForAdvisedInvestigation(1);
            
            BindAutoCompleteForProcedure(1);
            BindAutoCompleteForFamilyHistory(1);
            BindAutoCompleteForComplaint(1);
               
            $("#txtSplInstructions,#txtDiagnosis,#txtOperation").val('');
      
            $("#txtPresentingIlness").val('');
            $("#txtTreatment").val('');

            $("#btnUpdateDemographic").css('display', 'none');
            $("#txtpatientrecord").val('');
            $("#tblPanelSearch tr").html('');
            $("#fldPatientDetails").css('display', '');
            $("#btnExpand").css('display', '');
            $("#divPatientRemark").css('display', 'none');
            $(window).scrollTop(0);
        });  // BTNRESET END

        EditRecord = function(SHORT_STAY_NO) {
            //alert('search');
            //debugger;
//            if ($(".hdnFormPrivellege").val().includes('U')) {
//                //alert('d');
//                $("#btnUpdateAdmission").css('display', 'inline-block');
//            }
//            else {
//                //alert('dd');
//                $("#btnUpdateAdmission").css('display', 'none');
//            }
             $("#btnCloseAdmPop").trigger('click');
             $("#btnUpdateAdmission").css('display', '');
             $("#btnUpdateDemographic").css('display', 'inline-block');
            var _Admn_id = SHORT_STAY_NO;
            $("#txtAdmisssion").css('border-color', '');
            $("#btnPrintPDF").css("display", "");
            $("#btnSaveAdmission").css("display", "none");
            $.ajax({
                type: 'POST',
                url: 'IpdShortStay.aspx/GetEditRecord',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                cache: false,
                async: false,
                data: "{'SHORT_STAY_NO':'" + _Admn_id + "'}",
                beforeSend: function() { },
                success: function(response) {
                    var xmlDoc = $.parseXML(response.d);
                    var xml = $(xmlDoc);
                    var items = xml.find("Table");
                    var items5 = xml.find("Table4");
                    var items6 = xml.find("Table5");
                    var items7 = xml.find("Table6");
                    var items8 = xml.find("Table7");
                    var items9 = xml.find("Table8");
                    var items10 = xml.find("Table9"); //COMPLAINT
                    var items11 = xml.find("Table10"); //FAMILY HISTORY
                    var items12 = xml.find("Table11"); //PROCEDURE

                    var count = 0;
                    var row = '';
                    $("#txtAdmisssion").attr("disabled", "disabled");
                    
                    //--------------TAB-PROCEDURE-------------
                    $("#tblProcedure").html('');
                    $('#tblProcedure').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Procedure Name</th><th style="">Action</th></tr></thead>');
                    var _tridforProcedure = 1;
                    $.each(items12, function(index) 
                    {  
                        $('#tblProcedure').append('<tr id="tr' + _tridforProcedure + '"><td style=""><input type="hidden" id="hdnalreadyProcedurecode' + _tridforProcedure + '" class="hdnalreadyProcedurecode" value="' + $(this).find('IPD_PROCEDURE_CODE').text() + '"/><input type="hidden" id="hdnalreadyProcedureName' + _tridforProcedure + '" class="hdnalreadyProcedureName" value=""/><input type="text" id="txtProcedure' + _tridforProcedure + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtProcedure" value="' + $(this).find('IPD_PROCEDURE_NAME').text() + '"/></td><td style="white-space:nowrap"><button type="button" id="btnAddProcedure' + _tridforProcedure + '" onclick="AddProcedure(' + _tridforProcedure + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteProcedure' + _tridforProcedure + '" onclick="DeleteProcedure(' + _tridforProcedure + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                         
                        BindAutoCompleteForProcedure(_tridforProcedure);
                        _tridforProcedure++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforProcedure == 1)
                    {
                        $('#tblProcedure').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyProcedurecode1" class="hdnalreadyProcedurecode" value=""/><input type="hidden" id="hdnalreadyProcedureName1" class="hdnalreadyProcedureName" value=""/><input type="text" id="txtProcedure1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtProcedure"/></td><td style="white-space:nowrap"><button type="button" id="btnAddProcedure1" onclick="AddProcedure(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteProcedure1" onclick="DeleteProcedure(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                        BindAutoCompleteForProcedure(1);
                    }
                    
                    //--------------TAB-COMPLAINT---------------
                    $("#tblComplaintN").html('');
                    var _tridforComplaintN = 1;
                    $('#tblComplaintN').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Complaints / Problems Reported</th><th style="">Since</th><th style="">Unit</th><th style="">Remarks (Comments)</th><th style="">Action</th></tr></thead>');
                    $.each(items10, function(index) 
                    {
                        $('#tblComplaintN').append('<tr id="tr' + _tridforComplaintN + '"><td style=""><input type="hidden" id="hdnComplaintCode' + _tridforComplaintN + '" class="hdnComplaintCode" value="' + $(this).find('COMPLAINT_CODE').text() + '"/><input type="text" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" id="txtComplaint' + _tridforComplaintN + '" class="form-control txtComplaint" value="' + $(this).find('COMPLAINT_NAME').text() + '"/></td><td><input type="text" id="txtReportedComplaintSince' + _tridforComplaintN + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtReportedComplaintSince" value="' + $(this).find('SINCE').text() + '"/></td><td><select id="ddlReportedComplaintUnit' + _tridforComplaintN + '" class="form-control ddlReportedComplaintUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtcomplaintRemarks' + _tridforComplaintN + '" class="form-control txtcomplaintRemarks" style="height:45px;">' + $(this).find('REMARKS').text() + '</textarea></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint' + _tridforComplaintN + '" onclick="AddComplaint(' + _tridforComplaintN + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint' + _tridforComplaintN + '" onclick="DeleteComplaint(' + _tridforComplaintN + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                        $("#ddlReportedComplaintUnit" + _tridforComplaintN).val($(this).find('UNIT').text());
                        BindAutoCompleteForComplaint(_tridforComplaintN);
                        _tridforComplaintN++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforComplaintN == 1)
                    {
                        $('#tblComplaintN').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnComplaintCode1" class="hdnComplaintCode" value=""/><input type="text" id="txtComplaint1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtComplaint"/></td><td><input type="text" id="txtReportedComplaintSince1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtReportedComplaintSince"/></td><td><select id="ddlReportedComplaintUnit' + 1 + '" class="form-control ddlReportedComplaintUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtcomplaintRemarks1" class="form-control txtcomplaintRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint1" onclick="AddComplaint(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint1" onclick="DeleteComplaint(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForComplaint(1);
                    }
                    
                    //--------------TAB-FAMILY HISTORY-----------
                    $("#tblFamilyHistory").html('');
                    var _tridforFamilyHistory = 1;
                    $('#tblFamilyHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Disease Name</th><th style="">Disease Type</th><th style="">Since</th><th style="">Unit</th><th style="">Relationship</th><th style="">Notes / Comments</th><th>Action</th></tr></thead>');
                    $.each(items11, function(index) {

                        $('#tblFamilyHistory').append('<tr id="tr' + _tridforFamilyHistory + '"><td style=""><input type="hidden" id="hdnFamilyHistoryCode' + _tridforFamilyHistory + '" class="hdnFamilyHistoryCode" value="' + $(this).find('HISTORY_CODE').text() + '"/><input type="text" id="txtFamilyHistory' + _tridforFamilyHistory + '" class="form-control txtFamilyHistory" value="' + $(this).find('HISTORY_NAME').text() + '"></td><td><input type="text" id="txtFamilyHistoryType' + _tridforFamilyHistory + '" class="form-control txtFamilyHistoryType" style="width:50px;" value="' + $(this).find('HISTORY_TYPE').text() + '"></td><td><input type="text" id="txtFamilyHistorySince' + _tridforFamilyHistory + '" class="form-control txtFamilyHistorySince" style="width:50px;" value="' + $(this).find('SINCE').text() + '"></td><td><select id="ddlFamilyHistoryUnit' + _tridforFamilyHistory + '" class="form-control ddlFamilyHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><select style="width:200px;font-family:calibri" id="ddlFamilyHistoryRelation' + _tridforFamilyHistory + '" class="form-control ddlFamilyHistoryRelation"><option value=""></option><option value="Borther">Borther</option><option value="Sister">Sister</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Cousin">Cousin</option><option value="Nephew">Nephew</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Niece">Niece</option><option value="Great Grandmother">Great Grandmother</option><option value="Great Grandfather">Great Grandfather</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Maternal Uncle">Maternal Uncle</option><option value="Maternal Aunt">Maternal Aunt</option><option value="Daughter-in-law">Daughter-in-law</option><option value="Son-in-law">Son-in-law</option><option value=="Brother-in-law">Brother-in-law</option><option value="Sister-in-law">Sister-in-law</option><select></td><td><textarea style="font-family:calibri;" id="txtFamilyHistoryNotesComment' + _tridforFamilyHistory + '" class="txtFamilyHistoryNotesComment" value="">' + $(this).find('REMARKS').text() + '</textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddFamilyHistory' + _tridforFamilyHistory + '" onclick="AddFamilyHistory(' + _tridforFamilyHistory + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteFamilyHistory' + _tridforFamilyHistory + '" onclick="DeleteFamilyHistory(' + _tridforFamilyHistory + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
                        $("#ddlFamilyHistoryUnit" + _tridforFamilyHistory).val($(this).find('UNIT').text());
                        $("#ddlFamilyHistoryRelation" + _tridforFamilyHistory).val($(this).find('RELATION').text());
                        BindAutoCompleteForFamilyHistory(_tridforFamilyHistory);
                        _tridforFamilyHistory++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforFamilyHistory == 1)
                    {
                        $('#tblFamilyHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnFamilyHistoryCode' + 1 + '" class="hdnFamilyHistoryCode" value=""/><input type="text" id="txtFamilyHistory' + 1 + '" class="form-control txtFamilyHistory" value=""></td><td><input type="text" id="txtFamilyHistoryType' + 1 + '" class="form-control txtFamilyHistoryType" style="width:50px;" value=""></td><td><input type="text" id="txtFamilyHistorySince' + 1 + '" class="form-control txtFamilyHistorySince" style="width:50px;" value=""></td><td><select id="ddlFamilyHistoryUnit' + 1 + '" class="form-control ddlFamilyHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><select style="width:200px;font-family:calibri" id="ddlFamilyHistoryRelation' + 1 + '" class="form-control ddlFamilyHistoryRelation"><option value=""></option><option value="Borther">Borther</option><option value="Sister">Sister</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Cousin">Cousin</option><option value="Nephew">Nephew</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Niece">Niece</option><option value="Great Grandmother">Great Grandmother</option><option value="Great Grandfather">Great Grandfather</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Maternal Uncle">Maternal Uncle</option><option value="Maternal Aunt">Maternal Aunt</option><option value="Daughter-in-law">Daughter-in-law</option><option value="Son-in-law">Son-in-law</option><option value=="Brother-in-law">Brother-in-law</option><option value="Sister-in-law">Sister-in-law</option><select></td><td><textarea style="font-family:calibri;" id="txtFamilyHistoryNotesComment' + 1 + '" class="txtFamilyHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddFamilyHistory' + 1 + '" onclick="AddFamilyHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteFamilyHistory' + 1 + '" onclick="DeleteFamilyHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForFamilyHistory(1);
                    }


                    //-------------- TABLE ALLERGY CODE START FROM HERE --------------------------
                    $("#tblAllergy").html('');
                    var _tridforallergy = 1;
                    $('#tblAllergy').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th>Allergy Details</th><th>Allergy Type</th><th style="white-space:nowrap">Since</th><th>Unit</th><th>Notes / Comments</th><th>Action</th></tr></thead>');
                    $.each(items5, function(index) {

                        $('#tblAllergy').append('<tr id="tr' + _tridforallergy + '"><td style=""><input type="hidden" id="hdnAllergyCode' + _tridforallergy + '" class="hdnAllergyCode" value="' + $(this).find('ALLERGY_CODE').text() + '"/><input type="text" id="txtAllergy' + _tridforallergy + '" class="form-control txtAllergy" value="' + $(this).find('ALLERGY_NAME').text() + '"></td><td><input type="text" id="txtAllergyType' + _tridforallergy + '" class="form-control txtAllergyType" value="' + $(this).find('ALLERGY_TYPE').text() + '"></td><td><input type="text" id="txtAllergySince' + _tridforallergy + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtAllergySince" value="' + $(this).find('SINCE').text() + '"/></td><td><select id="ddlAllergySince' + _tridforallergy + '" class="form-control ddlAllergySince" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtNotesComment' + _tridforallergy + '" class="txtNotesComment" value="' + $(this).find('REMARKS').text() + '">' + $(this).find('REMARKS').text() + '</textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddAllergy' + _tridforallergy + '" onclick="AddAllergy(' + _tridforallergy + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteAllergy' + _tridforallergy + '" onclick="DeleteAllergy(' + _tridforallergy + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
                        $("#ddlAllergySince" + _tridforallergy).val($(this).find('UNIT').text());
                        BindAutoCompleteForAllergy(_tridforallergy);
                        _tridforallergy++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforallergy == 1)
                    {
                        $('#tblAllergy').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnAllergyCode' + 1 + '" class="hdnAllergyCode" value=""/><input type="text" id="txtAllergy' + 1 + '" class="form-control txtAllergy" value=""></td><td><input type="text" id="txtAllergyType' + 1 + '" class="form-control txtAllergyType" value=""></td><td><input type="text" id="txtAllergySince' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtAllergySince"/></td><td><select id="ddlAllergySince' + 1 + '" class="form-control ddlAllergySince" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtNotesComment' + 1 + '" class="txtNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddAllergy' + 1 + '" onclick="AddAllergy(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteAllergy' + 1 + '" onclick="DeleteAllergy(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForAllergy(1);
                    }


                    //--------------TAB-PAST HISTORY-----------
                    $("#tblPastHistory").html('');
                    $('#tblPastHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Past History</th><th style="">Type</th><th style="">Since</th><th style="">Unit</th><th style="">Notes / Comments</th><th style="">Action</th></tr></thead><tbody></tbody>');
                    var _tridforPastHistory = 1;
                    $.each(items8, function(index) {

                        $('#tblPastHistory').append('<tr id="tr' + _tridforPastHistory + '"><td style=""><input type="hidden" id="hdnPastHistoryCode' + _tridforPastHistory + '" class="hdnPastHistoryCode" value="' + $(this).find('HISTORY_CODE').text() + '"/><input type="text" id="txtPastHistory' + _tridforPastHistory + '" class="form-control txtPastHistory" value="' + $(this).find('HISTORY_NAME').text() + '"></td><td><input type="text" id="txtPastHistoryType' + _tridforPastHistory + '" class="form-control txtPastHistoryType" value="' + $(this).find('HISTORY_TYPE').text() + '"></td><td><input type="text" id="txtPastHistorySince' + _tridforPastHistory + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtPastHistorySince" value="' + $(this).find('SINCE').text() + '"/></td><td><select id="ddlPastHistoryUnit' + _tridforPastHistory + '" class="form-control ddlPastHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtPastHistoryNotesComment' + _tridforPastHistory + '" class="txtPastHistoryNotesComment" value="">' + $(this).find('REMARKS').text() + '</textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPastHistory' + _tridforPastHistory + '" onclick="AddPastHistory(' + _tridforPastHistory + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePastHistory' + _tridforPastHistory + '" onclick="DeletePastHistory(' + _tridforPastHistory + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');

                        $("#ddlPastHistoryUnit" + _tridforPastHistory).val($(this).find('UNIT').text());
                        BindAutoCompleteForPastHistory(_tridforPastHistory);
                        _tridforPastHistory++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforPastHistory == 1)
                    {
                        $('#tblPastHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnPastHistoryCode' + 1 + '" class="hdnPastHistoryCode" value=""/><input type="text" id="txtPastHistory' + 1 + '" class="form-control txtPastHistory" value=""></td><td><input type="text" id="txtPastHistoryType' + 1 + '" class="form-control txtPastHistoryType" value=""></td><td><input type="text" id="txtPastHistorySince' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtPastHistorySince"/></td><td><select id="ddlPastHistoryUnit' + 1 + '" class="form-control ddlPastHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri" id="txtPastHistoryNotesComment' + 1 + '" class="txtPastHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPastHistory' + 1 + '" onclick="AddPastHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePastHistory' + 1 + '" onclick="DeletePastHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForPastHistory(1);
                    }
                    
                     
                    //--------------TAB-PERSONAL HISTORY-----------
                    $("#tblPersonalHistory").html('');
                    $('#tblPersonalHistory').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Habit</th><th style="">Since</th><th style="">Unit</th><th style="">Qty</th><th style="">Unit</th><th style="">Notes / Comments</th><th style="">Action</th></tr></thead><tbody></tbody>');

                    var _tridforPersonalHistory = 1;
                    $.each(items7, function(index) {

                        $('#tblPersonalHistory').append('<tr id="tr' + _tridforPersonalHistory + '"><td style=""><input type="hidden" id="hdnPersonalHistoryCode' + _tridforPersonalHistory + '" class="hdnPersonalHistoryCode" value="' + $(this).find('PERSONAL_CODE').text() + '"/><input type="text" id="txtPersonalHistory' + _tridforPersonalHistory + '" class="form-control txtPersonalHistory" value="' + $(this).find('PERSONAL_NAME').text() + '"></td><td><input type="text" id="txtPersonalHistorySince' + _tridforPersonalHistory + '" class="form-control txtPersonalHistorySince" style="width:50px;" value="' + $(this).find('SINCE').text() + '"></td><td><select id="ddlPersonalHistoryUnit' + _tridforPersonalHistory + '" class="form-control ddlPersonalHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><input type="text" style="width:50px;" id="txtPersonalHistoryQty' + _tridforPersonalHistory + '" class="form-control txtPersonalHistoryQty" value="' + $(this).find('QTY').text() + '"></td><td><select id="ddlPersonalHistoryQtyUnit' + _tridforPersonalHistory + '" class="form-control ddlPersonalHistoryQtyUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri;" id="txtPersonalHistoryNotesComment' + _tridforPersonalHistory + '" class="txtPersonalHistoryNotesComment" value="">' + $(this).find('REMARKS').text() + '</textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPersonalHistory' + _tridforPersonalHistory + '" onclick="AddPersonalHistory(' + _tridforPersonalHistory + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePersonalHistory' + _tridforPersonalHistory + '" onclick="DeletePersonalHistory(' + _tridforPersonalHistory + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');

                        $("#ddlPersonalHistoryUnit" + _tridforPersonalHistory).val($(this).find('UNIT').text());
                        $("#ddlPersonalHistoryQtyUnit" + _tridforPersonalHistory).val($(this).find('QTY_UNIT').text());
                        BindAutoCompleteForPersonalHistory(_tridforPersonalHistory);
                        _tridforPersonalHistory++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforPersonalHistory == 1)
                    {
                        $('#tblPersonalHistory').append('<tr id="tr' + 1 + '"><td style=""><input type="hidden" id="hdnPersonalHistoryCode' + 1 + '" class="hdnPersonalHistoryCode" value=""/><input type="text" id="txtPersonalHistory' + 1 + '" class="form-control txtPersonalHistory" value=""></td><td><input type="text" id="txtPersonalHistorySince' + 1 + '" class="form-control txtPersonalHistorySince" style="width:50px;" value=""></td><td><select id="ddlPersonalHistoryUnit' + 1 + '" class="form-control ddlPersonalHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><input type="text" style="width:50px;" id="txtPersonalHistoryQty' + 1 + '" class="form-control txtPersonalHistoryQty" value=""></td><td><select id="ddlPersonalHistoryQtyUnit' + 1 + '" class="form-control ddlPersonalHistoryQtyUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea style="font-family:calibri;" id="txtPersonalHistoryNotesComment' + 1 + '" class="txtPersonalHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPersonalHistory' + 1 + '" onclick="AddPersonalHistory(' + 1 + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePersonalHistory' + 1 + '" onclick="DeletePersonalHistory(' + 1 + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForPersonalHistory(1);
                    }
                    
                    
                    //--------------TAB-PERSONAL HISTORY-----------
                    $("#tblDisease").html('');
                    $('#tblDisease').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Diseases Name</th><th style="">Since</th><th style="">Unit</th><th style="">Remarks (Comments)</th><th style="">Action</th></tr></thead>');
                    var _tridforDisease = 1;
                    $.each(items6, function(index) {

                        $('#tblDisease').append('<tr id="tr' + _tridforDisease + '"><td style=""><input type="hidden" id="hdnDiseaseCode' + _tridforDisease + '" class="hdnDiseaseCode" value="' + $(this).find('DISEASE_CODE').text() + '"/><input type="text" id="txtDisease' + _tridforDisease + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtDisease" value="' + $(this).find('DISEASE_NAME').text() + '"/></td><td><input type="text" id="txtProvisionalDisease' + _tridforDisease + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtProvisionalDisease" value="' + $(this).find('SINCE').text() + '"/></td><td><select id="ddlProvisionalDiseaseUnit' + _tridforDisease + '" class="form-control ddlProvisionalDiseaseUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtDiseaseRemarks' + _tridforDisease + '" class="form-control txtDiseaseRemarks" style="height:45px;font-family:calibri;">' + $(this).find('REMARKS').text() + '</textarea></td><td style="white-space:nowrap"><button type="button" id="btnAddDisease' + _tridforDisease + '" onclick="AddDisease(' + _tridforDisease + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteDisease' + _tridforDisease + '" onclick="DeleteDisease(' + _tridforDisease + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');

                        $("#ddlProvisionalDiseaseUnit" + _tridforDisease).val($(this).find('UNIT').text());

                        BindAutoCompleteForDisease(_tridforDisease);
                        _tridforDisease++; // = parseInt(_tridforallergy) + 1;
                    });
                    //$('#tblAdvisedInvestigation').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyinvcode1" class="hdnalreadyinvcode" value=""/><input type="hidden" id="hdnalreadyinvName1" class="hdnalreadyinvName" value=""/><input type="text" id="txtAdvisedInvestigation1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtAdvisedInvestigation"/></td><td style="white-space:nowrap"><button type="button" id="btnAddAdvisedInvestigation1" onclick="AddAdvisedInvestigation(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteAdvisedInvestigation1" onclick="DeleteAdvisedInvestigation(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                    //$('#tblDisease').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnDiseaseCode1" class="hdnDiseaseCode" value=""/><input type="text" id="txtDisease1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtDisease"/></td><td><input type="text" id="txtProvisionalDisease' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtProvisionalDisease"/></td><td><select id="ddlProvisionalDiseaseUnit' + 1 + '" class="form-control ddlProvisionalDiseaseUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtDiseaseRemarks1" class="form-control txtDiseaseRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddDisease1" onclick="AddDisease(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteDisease1" onclick="DeleteDisease(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                    if (_tridforDisease == 1)
                    {
                        $('#tblDisease').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnDiseaseCode1" class="hdnDiseaseCode" value=""/><input type="text" id="txtDisease1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtDisease"/></td><td><input type="text" id="txtProvisionalDisease' + 1 + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtProvisionalDisease"/></td><td><select id="ddlProvisionalDiseaseUnit' + 1 + '" class="form-control ddlProvisionalDiseaseUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtDiseaseRemarks1" class="form-control txtDiseaseRemarks" style="height:45px;font-family:calibri;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddDisease1" onclick="AddDisease(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteDisease1" onclick="DeleteDisease(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForDisease(1);
                    }


                     //--------------TAB-INVESTIGATION----------
                    $("#tblAdvisedInvestigation").html('');
                    $('#tblAdvisedInvestigation').html('<thead style="font-family: Calibri; font-weight: normal; font-size: 12px;"><tr><th style="">Investigation Name</th><th style="">Action</th></tr></thead>');
                    var _tridforAdvisedInvestigation = 1;
                    $.each(items9, function(index) {

                        $('#tblAdvisedInvestigation').append('<tr id="tr' + _tridforAdvisedInvestigation + '"><td style=""><input type="hidden" id="hdnalreadyinvcode' + _tridforAdvisedInvestigation + '" class="hdnalreadyinvcode" value="' + $(this).find('IPD_ADVISE_INVEST_CODE').text() + '"/><input type="hidden" id="hdnalreadyinvName' + _tridforAdvisedInvestigation + '" class="hdnalreadyinvName" value=""/><input type="text" id="txtAdvisedInvestigation' + _tridforAdvisedInvestigation + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtAdvisedInvestigation" value="' + $(this).find('IPD_ADVISE_INVES_NAME').text() + '"/></td><td style="white-space:nowrap"><button type="button" id="btnAddAdvisedInvestigation' + _tridforAdvisedInvestigation + '" onclick="AddAdvisedInvestigation(' + _tridforAdvisedInvestigation + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteAdvisedInvestigation' + _tridforAdvisedInvestigation + '" onclick="DeleteAdvisedInvestigation(' + _tridforAdvisedInvestigation + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');


                        BindAutoCompleteForAdvisedInvestigation(_tridforAdvisedInvestigation);
                        _tridforAdvisedInvestigation++; // = parseInt(_tridforallergy) + 1;
                    });
                    if (_tridforAdvisedInvestigation == 1)
                    {
                        $('#tblAdvisedInvestigation').append('<tr id="tr1"><td style=""><input type="hidden" id="hdnalreadyinvcode1" class="hdnalreadyinvcode" value=""/><input type="hidden" id="hdnalreadyinvName1" class="hdnalreadyinvName" value=""/><input type="text" id="txtAdvisedInvestigation1" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtAdvisedInvestigation"/></td><td style="white-space:nowrap"><button type="button" id="btnAddAdvisedInvestigation1" onclick="AddAdvisedInvestigation(' + 1 + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteAdvisedInvestigation1" onclick="DeleteAdvisedInvestigation(' + 1 + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');
                         BindAutoCompleteForAdvisedInvestigation(1);
                    }
                    
                    

                    //-------------- TABLE ALLERGY CODE END FROM HERE --------------------------


                    var ctr = 0;
                   
                    $.each(items, function(index) {
                        ctr++;
                        var _valCheckLiterate = $(this).find("IS_LITERATE").text();
                        if (_valCheckLiterate == 'true') {
                            $("#chkUnchekLiterate").removeClass('fa fa-square-o');
                            $("#chkUnchekLiterate").addClass('fa fa-check-square-o');
                            $("#EducationField").css("display", "");
                        }

                        var _valCheckPregnancy = $(this).find("PREGNANCY").text();
                        if (_valCheckPregnancy == 'true') {
                            $("#chkPregnancy").attr("checked", "checked");
                            $("#txtlastMenstrualDate").removeAttr("disabled", "");
                            $("#txtEstDate").removeAttr("disabled", "");
                        }

                        var _valPrenatalCheckup = $(this).find("PRENATAL_CHECKUP").text();
                        if (_valPrenatalCheckup == 'true') {
                            $("#chkParental").attr("checked", "checked");
                        }

                        var _valFullTerm = $(this).find("FULLTERM").text();
                        if (_valFullTerm == 'true') {
                            $("#chkFulltTerm").attr("checked", "checked");
                        }

                        $("#Select2").val($(this).find("SOURCE").text());
                        $("#adownload").css("display", "");
                        $("#adownload").text($(this).find("MLC_URL").text());
                        $("#adownload").attr("href", "MLCFILE/" + $(this).find("MLC_URL").text());
                        $("#txtAdmisssion").val($(this).find("SHORT_STAY_NO").text());
                        $("#ddlDepartment").val($(this).find("DEPARTMENT_CODE").text());
                        $("#ddlDepartment").trigger('change');
                        $("#txtOpdCardNo").val($(this).find("OPD_CARD_NO").text());
                        $("#txtCasualtyNo").val($(this).find("CASUALTY_NO").text());
                        var _doctor = 0;
                        if ($(this).find("DOCTOR_CODE").text() == '0') {
                            _doctor = '';
                        }
                        else {
                            _doctor = $(this).find("DOCTOR_CODE").text() + '-' + $(this).find("DOCTOR_NAME").text();
                        }

                        $("#txtDoctor").val($(this).find("DOCTOR_CODE").text());
                        $("#txtDate").val($(this).find("DATE").text());
                        var _referred_by = '';
                        if ($(this).find("REFERRED_BY_CODE").text() == '0') {
                            _referred_by = '';
                        }
                        else {
                            _referred_by = $(this).find("REFERRED_BY_CODE").text() + '-' + $(this).find("REFERRED_BY_NAME").text();
                        }
                        debugger;
                        //$("#ddlSurgeon").val($(this).find("SURGEON_CODE").text());
                       // $("#ddlAnesthetist").val($(this).find("ANESTHETIST_CODE").text());
                        
                        var SurgeonCode =$(this).find("SURGEON_CODE").text()
                        var _SurgeonArrayCode=SurgeonCode.split(',');
                        var i='';
                        for(i=0;i<_SurgeonArrayCode.length;i++)
                        {         
                            $("#ddlSurgeon option[value='" + _SurgeonArrayCode[i] + "']").attr("selected", 1);
                        }   
                        
                        var AnesthetistCode =$(this).find("ANESTHETIST_CODE").text()
                        var _AnesthetistCodeCode=AnesthetistCode.split(',');
                        var i='';
                        for(i=0;i<_AnesthetistCodeCode.length;i++)
                        {         
                            $("#ddlAnesthetist option[value='" + _AnesthetistCodeCode[i] + "']").attr("selected", 1);
                        } 
                        
//                         var _shortStay = $(this).find("SHORT_STAY").text();
//                        if (_shortStay == 'true') {
//                            $("#chkShortStay").attr("checked", "checked");
//                        }
                         
                         $("#txtDependentName").val($(this).find("DEPENDENT_NAME").text());
                         $("#ddlDependentRelation").val($(this).find("RELATION_WITH_DEPENDENT_CODE").text());
                        // $("#ddlDependentRelation").val($(this).find("RELATION_WITH_DEPENDENT_NAME").text());
                         $("#txtDependentRank").val($(this).find("RANK").text());
                         $("#txtDependentPidNo").val($(this).find("PID_NO").text());
                         $("#txtDependentPunit").val($(this).find("P_UNIT").text());
                         $("#txtRaddress").val($(this).find("R_ADDRESS").text());

                         $("#txtSplInstructions").val($(this).find("SPECIAL_INSTRUCTION").text());
                         $("#txtOperation").val($(this).find("OPERATION").text());
                         $("#txtDiagnosis").val($(this).find("DIAGNOSIS").text());
                        
                        $("#txtReferredBy").val($(this).find("REFERRED_BY_NAME").text());
                        $("#txtValidity").val($(this).find("VALIDITY").text());  //
                        $("#txtOldNo").val($(this).find("OLD_NO").text());
                        $("#ddlBedCategory").val($(this).find("BED_CATEGORY_CODE").text());
                        $("#ddlWardCategory").val($(this).find("WARD_CATEGORY_CODE").text());
                        $("#ddlWardNo").val($(this).find("WARD_NO").text());
                        $("#ddlRoomNo option:selected").val($(this).find("ROOM_NO_CODE").text());
                        $("#ddlRoomNo option:selected").text($(this).find("ROOM_NO_CODE").text());
                        $("#ddlWardCategory").trigger('change');
                        $("#txtBedNo").val($(this).find("BED_NO").text());
                       // $("#txtBedNo option:selected").text($(this).find("BED_NO").text());
                        $("#txtGateNo").val($(this).find("GATE_PASS_NO").text());
                        $("#ddlRoomNo").val($(this).find("ROOM_NO_CODE").text());
                        $("#txtMlcNo").val($(this).find("MLC_NO").text());
                        $("#txtMlcDateTime").val($(this).find("MLC_DATETIME").text());
                        $("#txtUhid").val($(this).find("UHID").text());
                        $("#txtname").val($(this).find("NAME").text());
                        $("#ddlGender").val($(this).find("GENDER").text());
                        $("#txtMobile").val($(this).find("MOBILE").text());
                        $("#txtAlternateMob").val($(this).find("ALTERNATE_MOBILE").text());
                        $("#txtDateOfBirth").val($(this).find("DOB").text());
                        $("#txtyy").val($(this).find("AGE_YY").text());
                        $("#txtmm").val($(this).find("AGE_MM").text());
                        $("#txtdd").val($(this).find("AGE_DD").text());
                        $("#ddlLanguage").val($(this).find("LANGUAGE_OF_CHOICE").text());
                        $("#txtAadharNo").val($(this).find("AADHAAR_NO").text());
                        $("#ddlReligion").val($(this).find("RELIGION_CODE").text());
                        $("#ddlmaritalStatus").val($(this).find("MARITAL_STATUS").text());
                        $("#txtEmail").val($(this).find("EMAIL").text());
                        $("#txtfatherHusband").val($(this).find("GUARDIAN").text());
                        $("#txtFamilyIncome").val($(this).find("FAMILY_INCOME").text());
                        $("#ddlPatientcategory").val($(this).find("PATIENT_CATEGORY_CODE").text());
                        $("#ddlPatientcategory").trigger('change');
                        if ($(this).find("PATIENT_CATEGORY_CODE").text() == "5") {
                            $("#asuhmanid").css('display', '');
                            $("#txtaushmancardno").val($(this).find("AUSHMAN_CARD_NO").text());
                            $("#txtaushmancardno").attr("disabled", "disabled");
                            $("#idforbplcard").css('display', 'none');
                        }
                        else if ($(this).find("PATIENT_CATEGORY_CODE").text() == "3") {
                            $("#idforbplcard").css('display', '');
                            $("#txtbplcardno").val($(this).find("BPL_CARD_NO").text());
                            $("#txtbplcardno").attr("disabled", "disabled");
                            $("#asuhmanid").css('display', 'none');
                        }
                        else {
                            $("#asuhmanid").css('display', 'none');
                            $("#idforbplcard").css('display', 'none');
                        }
                        $("#txtCompanyName").val($(this).find("COMPANY_NAME").text());
                        $("#txtEmployeeId").val($(this).find("EMPLOYEE_ID").text());
                        $("#txtInsuranceCompanyName").val($(this).find("INSURANCE_COMPANY_NAME").text());
                        $("#txtPolicyNo").val($(this).find("POLICY_NUMBER").text());
                        $("#txtPolicyAmount").val($(this).find("POLICY_AMOUNT").text());
                        $("#ddlOccupation").val($(this).find("OCCUPATION_CODE").text());
                        $("#ddlDiet").val($(this).find("DIET").text());
                        $("#ddlCondition").val($(this).find("PATIENT_CONDITION").text());
                        $("#txtHT").val($(this).find("HEIGHT").text());
                        $("#txtWT").val($(this).find("WEIGHT").text());
                        $("#txtBloodGroup").val($(this).find("BLOOD_GROUP").text());
                        $("#txtApgarScore").val($(this).find("APGAR").text());
                        $("#txtGrowth").val($(this).find("GROWTH").text());
                        $("#txtWaist").val($(this).find("WAIST").text());
                        $("#txtObesity").val($(this).find("OBESITY").text());
                        $("#ddlLocality").val($(this).find("LOCALITY_CODE").text());
                        $("#txtHouseNo").val($(this).find("HOUSE_NO").text());
                        $("#txtStreetName").val($(this).find("STREET_NAME").text());
                        $("#txtStreetNo").val($(this).find("STREET_NO").text());
                        $("#txtLandmark").val($(this).find("LANDMARK").text());
                        $("#ddlCountry").val($(this).find("COUNTRY_CODE").text());
                        $("#ddlCountry").trigger('change');
                        $("#ddlState").val($(this).find("STATE_CODE").text());
                        $("#ddlState").trigger('change');
                        $("#ddlCity").val($(this).find("CITY_CODE").text());
                        $("#txtPinNo").val($(this).find("PIN").text());
                        $("#txtkinName").val($(this).find("KIN_NAME").text());
                        $("#ddlRelation").val($(this).find("KIN_RELATION_CODE").text());
                        $("#txtKinMobile").val($(this).find("KIN_CONTACT_NO").text());
                        $("#txtKinTelNo").val($(this).find("PHONE").text());
                        $("#txtKinAddress").val($(this).find("KIN_ADDRESS").text());
                        $("#txtlastMenstrualDate").val($(this).find("LAST_MANTURAL_DATE").text());
                        $("#txtEstDate").val($(this).find("EST_DELIVARY_DATE").text());
                        $("#txtNotes").val($(this).find("NOTE").text());
                        $("#ddlVisitcategory").val($(this).find("TRANSITION_TYPE").text());
                        //------------------------------------------------------------- EMERGENCY DETAILS 
                        $("#txtEmergencyName").val($(this).find("EMERGENCY_NAME").text());
                        $("#txtEmergencyMobile").val($(this).find("EMERGENCY_CONTACT").text());
                        $("#txtEmergencyAddress").val($(this).find("EMERGENCY_ADDRESS").text());

                        //-------------------------------------------------------------
                        $("#ddlPaymode").val($(this).find("PAY_MODE").text());
                        $("#ddlConsultant").val($(this).find("DOCTOR_CODE").text());
                        $("#txtPaidAmt").val($(this).find("PAID_AMOUNT").text());
                        $("#txtBalanceAmount").val($(this).find("BALANCE_AMOUNT").text());
                        $("#txtOtherChargesPercent").val($(this).find("OTHER_CHRG_PERCENT").text());
                        $("#txtOtherChargesAmount").val($(this).find("OTHER_CHRG_AMOUNT").text());
                        $("#txtInvoiceDiscount").val($(this).find("INVOICE_DISC_PERCENT").text());

                        $("#txtInvoiceDiscAmount").val($(this).find("INVOICE_DISC_AMOUNT").text());
                        $("#txtAmount").val($(this).find("AMOUNT").text());
                        $("#txtDiscount").val($(this).find("DISCOUNT").text());
                        $("#txtTaxableAmount").val($(this).find("TAXABLE_DISCOUNT").text());
                        $("#txtTaxAmount").val($(this).find("TAX_AMOUNT").text());
                        $("#txtSplDiscount").val($(this).find("CASH_DISCOUNT").text());
                        $("#txtNetAmount").val($(this).find("NET_AMOUNT").text());

                        $("#txtPresentingIlness").val($(this).find("HISTORY_PRESENT_ILLNESS").text());
                        $("#txtTreatment").val($(this).find("TREATMENT").text());

                        $("#btnPrintPDF").css('display', '');
                        
                        var paymode=$(this).find("PAY_MODE").text();
                        
                       
                        
                        if (paymode == 'Cash') 
                        {
                            $("#divCash").show();
                            $("#DivCard").hide();
                            $("#divChequeDraft").hide();
                            $("#divWallet").hide();
                            $("#txtCashDepositerDate").val($(this).find("DEPOSITE_DATE").text());
                            $("#txtCashDepositerTime").val($(this).find("DEPOSITE_TIME").text());
                            $("#txtCashDepositerName").val($(this).find("DEPOSITOR_NAME").text());
                            
                            
                        }
                        else if (paymode == 'Card') 
                        {
                            $("#DivCard").show();
                            $("#divCash").hide();
                            $("#divChequeDraft").hide();
                            $("#divWallet").hide();
                            $("#txtCardName").val($(this).find("BANK_NAME").text());
                            $("#txtCardNo").val($(this).find("TRANSITION_NO").text());
                        }

                        else if (paymode == 'Cheque/Draft') 
                        {
                            $("#divChequeDraft").show();
                            $("#DivCard").hide();
                            $("#divCash").hide();
                            $("#divWallet").hide();
                            $("#txtChequeBankName").val($(this).find("BANK_NAME").text());
                            $("#txtChequeBankNo").val($(this).find("TRANSITION_NO").text());
                        }
                        else if (paymode == 'Wallet' || paymode == 'NEFT') 
                        { 
                            $("#divWallet").show();
                            $("#divChequeDraft").hide();
                            $("#DivCard").hide();
                            $("#divCash").hide();
                            $("#txtWalletName").val($(this).find("BANK_NAME").text());
                            $("#txtWalletTransitionNo").val($(this).find("TRANSITION_NO").text());
                        }
                        else 
                        {
                            $("#divWallet").hide();
                            $("#divChequeDraft").hide();
                            $("#DivCard").hide();
                            $("#divCash").hide();
                        }                        
                        
                        //-----------------------------------------------------------------------
                        var _patientRecord = $(this).find("PATIENT_RECORD").text().trim();
                        if (_patientRecord != "") {
                            $("#fldPatientDetails").css('display', 'none'); btnExpand
                            $("#btnExpand").css('display', 'none');
                            $("#divPatientRemark").css('display', '');
                            $("#txtpatientrecord").val(_patientRecord);
                        }

                    });     //table loop end here 


                    //------------------------------------------Table 1-----------------------------------------------------//

                    var xmlDoc = $.parseXML(response.d);
                    var xml = $(xmlDoc);
                    var items1 = xml.find("Table1");
                    var table = $('</br><table id="tblEditEducationId" style="font-family:Calibri;" class="table table-bordered table-hover tblUpdateEducation" ></table>');

                    var row = '';
                    var count = 0;

                    $.each(items1, function(index) {
                        if (parseInt(count) == 0) {
                            var rowheader = '<thead style="font-size:14px;"><tr>';
                            //var rowheader = '<tr>';
                            rowheader += '<th class="text-center">Education</th>';
                            rowheader += '<th class="text-center">University</th>';
                            rowheader += '<th class="text-center">Marks</th>';
                            rowheader += '<th class="text-center">Passing Year</th>';
                            rowheader += '<th class="text-center">Action</th>';
                            rowheader += '</tr></thead>';
                            //rowheader += '</tr>';
                            table.append(rowheader);
                        }
                        var _new = count + 1;
                        var rowcol = '';
                        rowcol += "<tbody><tr id='tr" + _new + "'>";
                        rowcol += "<td><input type='text' class='form-control clsEducation' id='txtEducation' placeholder='Education' value='" + $(this).find('IPD_EDU_NAME').text() + "' /></td>";
                        rowcol += "<td><input type='text' class='form-control clsUniversity' id='txtUniversity' placeholder='University'  value='" + $(this).find('IPD_UNIVERSITY_NAME').text() + "' /></td>";
                        rowcol += "<td><input type='text' class='form-control clsMarks' id='txtMarks' placeholder='Marks'  value='" + $(this).find('IPD_EDU_MARKS').text() + "'/></td>";
                        rowcol += "<td><input type='text' class='form-control clsPassingYear' id='txtPassingYear' placeholder='Year'  value='" + $(this).find('IPD_EDU_PASSING_YEAR').text() + "'/></td>";
                        rowcol += "<td style='width:120px'> <button type='button' id='btnDeleteEducation' onclick='DeleteRowEditEducation(" + _new + ")' class='btn btn-danger'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></button>\
                                   <button type='button' onclick='AddEditRowEducation(" + _new + ");' class='btn btn-primary'><i class='fa fa-plus' aria-hidden='true'></i></button></td>";
                        rowcol += "</tr></tbody>";
                        //rowcol += '</tr>';

                        table.append(rowcol);
                        count += 1;

                    }); //each end here
                    counterEducation = count;

                    if (parseInt(count) == 0) {

                        $("#divEducation").html('<br/><table class="table table-bordered table-hover tblEducation" style="display: " id="tblEducationId"><thead style="font-size: 14px;"><tr><th class="text-center">Education</th><th class="text-center">University</th><th class="text-center">Marks</th><th class="text-center">Passing Year</th><th class="text-center">Action</th></tr></thead><tbody><tr id="tr1"><td><input type="text" class="form-control clsEducation" id="txtEducation" placeholder="Education"></td><td><input type="text" class="form-control clsUniversity" id="txtUniversity" placeholder="University"></td><td><input type="text" class="form-control clsMarks" id="txtMarks" placeholder="Marks"></td><td><input type="text" class="form-control clsPassingYear" id="txtPassingYear" placeholder="Year"></td><td style="width: 120px"><button type="button" id="btnDeleteEducation" onclick="DeleteRowEducation(1)" class="btn btn-danger"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button>&nbsp;<button type="button" id="btnPlusEducation1" onclick="AddRowEducation(1);" class="btn btn-primary btnclsPlusEducation"><i class="fa fa-plus" aria-hidden="true"></i></button></td></tr></tbody></table>');
                    }
                    else {

                        $('#divEducation').html('');
                        $('#divEducation').html(table);
                    }
                    //-------------------------------------------------SERVICE DETAIL BIND HERE -------------------------------
                    debugger;
                    var xmlDoc = $.parseXML(response.d);
                    //alert(response.d);
                    var xml = $(xmlDoc);
                    var items3 = xml.find("Table3");
                    var table = $('<table id="tblPanelSearch" style="font-family:Calibri;width:100%" class="table table-bordered table-hover" ></table>');

                    var row3 = '';
                    var count3 = 0;
                    var trid = 1;
                    S_id =1;
                    $.each(items3, function(index) {
                        if (parseInt(count3) == 0) {

                            var rowheader = '<thead><tr>';
                            //var rowheader = '<tr style="font-size:15px">';                   
                            rowheader += '<th style="font-size:15px;width:auto;white-space:nowrap;">Service Name</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">Charges</th>';

                            rowheader += '<th style="white-space:nowrap;font-size:12px">Disc %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">Cash Disc %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">IGST %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">CGST %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">SGST %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">Misc Tax %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">Misc Charges %</th>';
                            rowheader += '<th style="white-space:nowrap;font-size:12px">Net Amount</th>';


                            rowheader += '</thead></tr>';

                            table.append(rowheader);
                        }

                        var rowcol = '';
                        rowcol += '<tbody><tr>';
                        rowcol += '<td style="white-space:nowrap;"><input type="hidden" class="hdnServiceName" id="hdnServiceName' + $(this).find("SERVICE_NAME").text() + '" value="' + $(this).find("SERVICE_NAME").text() + '">' + $(this).find("SERVICE_NAME").text() + '</td>';
                        rowcol += '<td><input type="hidden" class="hdnServiceCode" id="hdnServiceCode' + trid + '"  value="' + $(this).find("SERVICE_CODE").text() + '"><input type="text"  id="txtcharges' + trid + '" onChange="CalculateRowAmount(' + trid + ')" class="form-control txtcharges" style="width:150px;text-align:right;color:blue;" value="' + $(this).find("CHARGES").text() + '" /></td>';

                        rowcol += '<td><input type="text" style="width:90px;text-align:right" onchange="CalculateRowAmount(' + trid + ')" id="txtDisc' + trid + '" class="form-control txtDisc" placeholder="Discount" value="' + $(this).find("DISCOUNT").text() + '"></td>';
                        rowcol += '<td><input type="text" onchange="CalculateRowAmount(' + trid + ')" style="width:90px;text-align:right" id="txtCashDisc' + trid + '" class="form-control txtCashDisc" placeholder="Cash Discount" value="' + $(this).find("CASH_DISCOUNT").text() + '"></td>';
                        rowcol += '<td><input type="text" style="width:90px;text-align:right" id="txtIGST' + trid + '" class="form-control txtIGST" onchange="CalculateRowAmount(' + trid + ')" placeholder="IGST" value="' + $(this).find("IGST").text() + '"></td>';
                        rowcol += '<td><input type="text" style="width:90px;text-align:right" onchange="CalculateRowAmount(' + trid + ')" id="txtCGST' + trid + '" class="form-control txtCGST" placeholder="CGST" value="' + $(this).find("CGST").text() + '"></td>';
                        rowcol += '<td><input type="text" style="width:90px;text-align:right" onchange="CalculateRowAmount(' + trid + ')" id="txtSGST' + trid + '" class="form-control txtSGST" placeholder="SGST" value="' + $(this).find("SGST").text() + '"></td>';
                        rowcol += '<td><input type="text" style="width:90px;text-align:right" onchange="CalculateRowAmount(' + trid + ')" id="txtMiscTax' + trid + '" class="form-control txtMiscTax" placeholder="Misc Tax" value="' + $(this).find("MISC_TAX").text() + '"></td>';
                        rowcol += '<td><input type="text" onchange="CalculateRowAmount(' + trid + ')" style="width:120px;text-align:right" id="txtMiscCharges' + trid + '" class="form-control txtMiscCharges" placeholder="Misc Charges" value="' + $(this).find("MISC_CHARGES").text() + '"></td>';
                        rowcol += '<td style="text-align:right;"><span style="color:blue;font-weight:bold;text-align:right;" class="spnNetAmt" id="spnNetAmt' + trid + '">' + $(this).find("NET_AMOUNT").text() + '</span></td>';
                        rowcol += '</tbody></tr>';
                        table.append(rowcol);
                        //_FAmount=parseInt(_FAmount)+ parseInt($(this).find("OPD_CHARGE").text());

                        count3 += 1;
                        trid += 1;
                        S_id += 1;

                    });     //EACH END HERE ..........

                    if (parseInt(count3) == 0) {
                        var rowcol = '';
                        rowcol += '<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;No Service Available for selected Doctor !</td></tr>';
                        table.append(rowcol);
                        $('#divDRService').html(table);
                        //$('#txtAmount').val(0);
                    }
                    else {
                        //alert('dd');  
                        $("#fldConsultationServices").css('display', '');
                        $('#divDRService').html(table); //txtNetAmount
                        //                    $('#txtAmount').val(_FAmount);
                        //                    $('#txtNetAmount').val(_FAmount);
                    }




                    //----------------------------------------------------SERVICE DETAIL BIND END HERE ----------------------------------

                    //------------------------------------------Table 2-----------------------------------------------------//

                    var xmlDoc = $.parseXML(response.d);
                    var xml = $(xmlDoc);
                    var items2 = xml.find("Table2");
                    var table = $('<table id="tblEditDocumentId" style="font-family:Calibri;" class="table table-bordered table-hover tblDocumentUpload" ></table>');

                    var row = '';
                    var count = 0;

                    $.each(items2, function(index) {
                        if (parseInt(count) == 0) {
                            var rowheader = '<thead style="font-size:14px;"><tr>';
                            //var rowheader = '<tr>';
                            rowheader += '<th class="text-center">File Name</th>';
                            rowheader += '<th class="text-center">Upload</th>';
                            rowheader += '<th class="text-center">Action</th>';
                            rowheader += '</tr></thead>';
                            //rowheader += '</tr>';
                            table.append(rowheader);
                        }

                        var _new = count + 1;
                        var rowcol = '';
                        rowcol += "<tbody><tr id='Td" + _new + "'>";
                        rowcol += "<td><input type='text' class='form-control clsFileName' id='txtFileName" + _new + "' placeholder='File Name' value='" + $(this).find('DOCUMENT_NAME').text() + "' /></td>";
                        rowcol += "<td><input type='file' class='btn btn-primary FileUpload' id='File" + _new + "' /><a href='Documents/" + $(this).find("DOCUMENT_URL").text() + "' id='a" + _new + "' class='documentLink' target='_blank'>" + $(this).find("DOCUMENT_URL").text() + "</a></td>";
                        rowcol += "<td> <button type='button' id='btnDeleteDocument' onclick='DeleteRow(" + _new + ")' class='btn btn-danger'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></button>&nbsp;&nbsp;\
                                   <button type='button' onclick='Addfunction(" + _new + ")'  class='btn btn-primary btnclsPlusDocument'><i class='fa fa-plus' aria-hidden='true'></i></button></td>";
                        rowcol += "</tr></tbody>";
                        //rowcol += '</tr>';

                        table.append(rowcol);

                        count += 1;

                    }); //each end here

                    counterDocuments = count;

                    if (parseInt(count) > 0) {
                        $('#tblDocumentId').css('display', 'none');
                    }
                    $('#grdDocumentDetail').html(table);
                    var _table = $('#grdDocumentDetail table');

                    if (parseInt(ctr) == 0) {
                        $("#divErrorMsg").css("display", "block");
                        $("#spnerrormsg").text("No records found !");
                        $("#txtAdmisssion").focus();
                        $("#txtAdmisssion").css('border-color', 'red');
                        $("#txtAdmisssion").removeAttr("disabled");
                        $("#divErrorMsg").delay(3200).fadeOut(300);
                        $(window).scrollTop(0, 0);
                    }
                },
                failure: function(response) {
                    alert('Edit Bind Failed');
                },

                error: function(response) {
                    alert('Edit Bind Error');
                }
            });
        } // GET DATA THROUGH ADMISSION NO. ENDING

        $("#ddlVisitcategory").change(function() {
            //alert('hello');
            //            if ($("#ddlVisitcategory").val() == "General") {
            //                alert('free');
            //                $(".txtcharges").val();
            //                $(".txtDisc").val();
            //                $(".txtCashDisc").val();
            //                $(".txtIGST").val();
            //                $(".txtCGST").val();
            //                $(".txtSGST").val();
            //                $(".txtMiscTax").val();
            //                $(".txtMiscCharges").val();
            //                $(".spnNetAmt").text();

            //                $("#txtBalanceAmount").val();
            //                $("#txtAmount").val();
            //                $("#txtNetAmount").val();
            //                $("#txtOtherChargesPercent").val();
            //                $("#txtOtherChargesAmount").val();
            //                $("#txtInvoiceDiscount").val();
            //                $("#txtInvoiceDiscAmount").val();
            //                $("#txtInvoiceDiscAmount").val();
            //                $("#txtDiscount").val();
            //                $("#txtTaxableAmount").val();
            //                $("#txtTaxableAmount").val();
            //                $("#txtTaxAmount").val();
            //                $("#txtSplDiscount").val();
            //            }
            if ($("#ddlVisitcategory").val() == "Complementary" || $("#ddlVisitcategory").val() == "Free") {
                //alert('complementary');
                $(".txtcharges").val('0');
                $(".txtDisc").val('0');
                $(".txtCashDisc").val('0');
                $(".txtIGST").val('0');
                $(".txtCGST").val('0');
                $(".txtSGST").val('0');
                $(".txtMiscTax").val('0');
                $(".txtMiscCharges").val('0');
                $(".spnNetAmt").text('0');

                $("#txtBalanceAmount").val('0');
                $("#txtAmount").val('0');
                $("#txtNetAmount").val('0');
                $("#txtOtherChargesPercent").val('0');
                $("#txtOtherChargesAmount").val('0');
                $("#txtInvoiceDiscount").val('0');
                $("#txtInvoiceDiscAmount").val('0');
                $("#txtInvoiceDiscAmount").val('0');
                $("#txtDiscount").val('0');
                $("#txtTaxableAmount").val('0');
                $("#txtTaxableAmount").val('0');
                $("#txtTaxAmount").val('0');
                $("#txtSplDiscount").val('0');
            }

            else {
                //alert('else');
                //$("#divDRService").remove("#tblPanelSearch");
                $("#tblPanelSearch").empty();
                $("#divDRService").append('<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;Please Choose Services Again !</td></tr>');

                $("#txtBalanceAmount").val('0');
                $("#txtAmount").val('0');
                $("#txtNetAmount").val('0');
                $("#txtOtherChargesPercent").val('0');
                $("#txtOtherChargesAmount").val('0');
                $("#txtInvoiceDiscount").val('0');
                $("#txtInvoiceDiscAmount").val('0');
                $("#txtInvoiceDiscAmount").val('0');
                $("#txtDiscount").val('0');
                $("#txtTaxableAmount").val('0');
                $("#txtTaxableAmount").val('0');
                $("#txtTaxAmount").val('0');
                $("#txtSplDiscount").val('0');

            }

        }); //on change end here


        $("#ddlServiceType").on('change', function() {

            $("#ddlCategory").empty();
            $("#ddlCategoryDetail").empty();
            var service_typ_code = $("#ddlServiceType").val();

            $.ajax({
                type: 'POST',
                url: 'IpdShortStay.aspx/GetCategory',
                async: false,
                cache: false,
                data: "{'SERVICE_CODE':'" + service_typ_code + "'}",
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                beforeSend: function() {
                    // before_loading($('#ddlAppraisalCycle'));
                },
                success: function(response) {
                    //alert(response.d);
                    var xmlDoc = $.parseXML(response.d);
                    var xml = $(xmlDoc);
                    var items = xml.find("Table");
                    $("#ddlCategory").append($("<option></option>").val("").html(""));
                    $("#ddlCategoryDetail").append($("<option></option>").val("").html(""));

                    $.each(items, function(index) {
                        if ($(this).find("NAME").text() != "PROFILE" && $(this).find("NAME").text() != "INVESTIGATION") {

                            $("#ddlCategory").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                            $("#ddlCategoryDetail").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                        }
                    }); //each end here
                },
                failure: function(response) {
                    //alert(response.d);
                    alert('Loading Failed');
                    // after_loading();
                },
                error: function(response) {
                    //alert(response.d);
                    alert('Error');
                    // after_loading();
                }

            }); //POST END HERE

        }); //CHANGE END HERE

        $("#btnSearchDetail").click(function() {
            //alert('hello');
            $("#ddlServiceTypeDetail").val('');



            $("#ddlCategoryDetail").val('');
            $("txtServiceNameDetail").val('');
            $("#tblBrand").html(''); //tblSearchInfoDetail
            //$("#tblSearchInfoDetail").html('');

            $("#pnlMain").css('display', 'none');

            $("#myModalAddItemDetail").modal({
                show: true,
                width: '740px' //probably not needed//txtMobileNo
                //probably not needed 
            });
            $("#ddlServiceTypeDetail").val($("#ddlServiceType").val());
            //$("#ddlCategoryDetail").val($("#ddlServiceCategory").val());
            $("#ddlCategoryDetail").val($("#ddlCategory").val());
            $("#txtServiceNameDetail").val($("#txtServiceName").val());
            $("#btnDetailGo").trigger('click');
            BindServicetype();
        });
        $("#btnSelectServiceDetail1").click(function() {
            // alert('hello');
            debugger;
            var trid = S_id;

            


            var is_data_in_table = 0;

            $('#tblSearchInfoDetail tr').not(':first').each(function() {
                // alert('inside table');

                var chkitem = $(this).find('input:checkbox[name="chkItemN"]');
                //alert(chkitem);
                if ((chkitem).is(':checked')) {

                    is_data_in_table++;
                    // TABLE LOOP ITERATIONS START FROM HERE

                    var _serviceCode = $(this).find('#hdnServiceCode').val();
                    //alert(_serviceCode);

                    var _serviceType = $(this).find('#hdnServiceType').val();
                    var _serviceCategory = $(this).find('#hdnServiceCategory').val();
                    var _serviceName = $(this).find('#hdnServiceName').val();
                    var _opdCharges = $(this).find('#hdnOPDCharges').val();

                    var _winwidth = $("#divContainer").innerWidth() - 100;



                    $("#chkItemN").css('display', 'none');
                    $('#tblPanelSearch').append('<tr id="tr' + trid + '"><input type="hidden" id="hdnServiceCode"  class="hdnServiceCode" value="' + _serviceCode + '"/><td style="white-space:nowrap; width:100px;"><input type="hidden" id="hdnServiceName" class="hdnServiceName" value="' + _serviceName + '"/>' + _serviceName + '</td><td style="white-space:nowrap;"><input type="text" style="width: 90px; text-align:right" id="txtcharges' + trid + '" value="' + _opdCharges + '" onchange="CalculateRowAmount(' + trid + ')" class="form-control txtcharges" /></td><td><input type="text" style="width: 90px; text-align: right" id="txtDisc' + trid + '" value="0" class="form-control txtDisc" onchange="CalculateRowAmount(' + trid + ')" placeholder="Discount"></td><td><input type="text" style="width: 90px; text-align: right" id="txtCashDisc' + trid + '" value="0" class="form-control txtCashDisc" onchange="CalculateRowAmount(' + trid + ')" placeholder="Cash Disc"></td><td><input type="text" style="width: 90px; text-align: right" id="txtIGST' + trid + '" value="0" class="form-control txtIGST" onchange="CalculateRowAmount(' + trid + ')" placeholder="IGST"></td><td><input type="text" style="width: 90px; text-align: right" id="txtCGST' + trid + '" value="0" class="form-control txtCGST" onchange="CalculateRowAmount(' + trid + ')" placeholder="CGST"></td><td><input type="text" style="width: 90px; text-align: right" id="txtSGST' + trid + '" value="0" class="form-control txtSGST" onchange="CalculateRowAmount(' + trid + ')" placeholder="SGST"></td><td><input type="text" style="width: 90px; text-align: right" id="txtMiscTax' + trid + '" value="0" class="form-control txtMiscTax" onchange="CalculateRowAmount(' + trid + ')" placeholder="Misc Tax"></td><td><input type="text" style="width: 90px; text-align: right" id="txtMiscCharges' + trid + '" value="0" class="form-control txtMiscCharges" onchange="CalculateRowAmount(' + trid + ')" placeholder="Misc Charges"></td><td style="text-align: right;"><span style="color: blue; font-weight: bold; text-align: right; width:200px;" class="spnNetAmt" id="spnNetAmt' + trid + '">' + _opdCharges + '</span></td><td><button type="button" class="btn btn-danger" onclick="DeleteDosageRow(' + trid + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>');

                    trid++;
                    S_id++;
                    $("#btnmodclose1").trigger('click');
                    $("#divScrollN").css('width', _winwidth);

                } //check box check end here 

            }); //each end here

            if (parseInt(is_data_in_table) == 0) {

            }
            var _table = $('#divDRService');

            $("#fldConsultationServices").css("display", "");
            CalculateRowAmount();
            bind_filterevent(_table);
            paginateIt(_table, 4);
            visibility_paging(_table);

        }); //btn select service Detail end here

        $("#ddlPaymode").click(function() {
        debugger;
            //alert('hello');
            if ($("#ddlPaymode").val() == 'Cash') {
                $("#divCash").show();
                $("#DivCard").hide();
                $("#divChequeDraft").hide();
                $("#divWallet").hide();
            }
            else if ($("#ddlPaymode").val() == 'Card') {

                $("#DivCard").show();
                $("#divCash").hide();
                $("#divChequeDraft").hide();
                $("#divWallet").hide();
            }

            else if ($("#ddlPaymode").val() == 'Cheque/Draft') {

                $("#divChequeDraft").show();

                $("#DivCard").hide();
                $("#divCash").hide();

                $("#divWallet").hide();
            }
            else if ($("#ddlPaymode").val() == 'Wallet' || $("#ddlPaymode").val() == 'NEFT') {

                $("#divWallet").show();
                $("#divChequeDraft").hide();

                $("#DivCard").hide();
                $("#divCash").hide();


            }
            else {
                $("#divWallet").hide();
                $("#divChequeDraft").hide();

                $("#DivCard").hide();
                $("#divCash").hide();

            }

        });


//        $("#ddlPayer").click(function() {
//            //alert('hello');
//            if ($("#ddlPayer").val() == 1) {
//                $("#divEsicInformation").show();
//                $("#divYojana").hide();
//                $("#CompanyInfo").hide();
//                $("#HealthInsuranceInfo").hide();


//            }
//            else if ($("#ddlPayer").val() == 3) {
//                $("#divYojana").show();
//                $("#divEsicInformation").hide();
//                $("#CompanyInfo").hide();
//                $("#HealthInsuranceInfo").hide();

//            }

//            else if ($("#ddlPayer").val() == 2) {
//                $("#CompanyInfo").show();
//                $("#divYojana").hide();
//                $("#divEsicInformation").hide();

//                $("#HealthInsuranceInfo").hide();

//            }
//            else if ($("#ddlPayer").val() == 4) {
//                // alert('insurabnce');
//                $("#HealthInsuranceInfo").show();
//                $("#CompanyInfo").hide();
//                $("#divYojana").hide();
//                $("#divEsicInformation").hide();



//            }

//            else {
//                $("#HealthInsuranceInfo").hide();
//                $("#CompanyInfo").hide();
//                $("#divEsicInformation").hide();
//                $("#divYojana").hide();
//            }

//        });








    });  // READY FUNCTION END

    DeleteDosageRow = function(_trid) {
        var _newtrId = "#tr" + _trid;
        var spnAmt = "#spnAmount" + _trid;
        var txtAmount = $("#txtAmount").val();
        var _fAmount = parseFloat($("#txtAmount").val()) - parseFloat($(spnAmt).text());
        $("#txtAmount").val(_fAmount);

        var _netAmount = parseFloat($("#txtAmount").val()) + parseFloat($("#txtMiscDiscount").val()) - parseFloat($("#txtDiscount").val()) - parseFloat($("#txtCashdiscount").val());

        $("#txtNetAmount").val(_netAmount);
        //Calculation end from here 
        $(_newtrId).remove().delay(3200).fadeOut(300);
    }



    BindService = function() {

        $("#ddlServiceType").empty("");
        $("#ddlServiceTypeDetail").empty("");

        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetService',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                // alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                gtable = (response.d);
                var items = xml.find("Table");

                $("#ddlServiceType").append($("<option></option>").val("").html(""));
                $("#ddlServiceTypeDetail").append($("<option></option>").val("").html(""));

                $.each(items, function(index) {

                    if ($(this).find("NAME").text() != "OPD" && $(this).find("NAME").text() != "LAB" && $(this).find("NAME").text() != "THERAPY" && $(this).find("NAME").text() != "PROCEDURE" && $(this).find("NAME").text() != "CASUALTY" && $(this).find("NAME").text() != "CONSULTATION") {
                        $("#ddlServiceType").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                        $("#ddlServiceTypeDetail").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                    }

                }); //each end here 
            },
            failure: function(response) {
                alert('Loading Failed');
            },
            error: function(response) {
                alert('Error');
            }

        }); //Post end here

    } //Bind Services end here

    BindServicetype = function() {
        //alert('hello11');

        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetSearchPatientDetailInfo',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            cache: false,
            async: false,
            data: "{'SERVICE_TYPE':'" + $("#ddlServiceType option:selected").text() + "','SERVICE_CATEGORY':'" + $("#ddlCategory option:selected").text() + "','PATIENT_CATEGORY':'" + $("#ddlPatientcategory option:selected").text() + "'}",
            beforeSend: function() {
            },
            success: function(response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                var table = $('<table id="tblSearchInfoDetail" style="font-family:Calibri;" class="table table-bordered table-hover" ></table>');
                var row = '';
                var count = 0;
                var trid = 1;
                $.each(items, function(index) {

                    if (parseInt(count) == 0) {
                        var rowheader = '<tr style="font-size:14px;">';
                        rowheader += '<th><input type="checkbox" style="zoom:1.5;" style="zoom:1.5;" onclick="checkAll(this)" name="chkAllUnAssignItemN" /></th>';
                        rowheader += '<th>Code</th>';
                        rowheader += '<th>Service Type</th>';
                        rowheader += '<th>Service Category</th>';
                        rowheader += '<th>Service Name</th>';
                        rowheader += '<th> Charge</th>';
                        rowheader += '</tr>';
                        table.append(rowheader);
                    }
                    var rowcol = '';
                    rowcol += '<tr>';
                    rowcol += '<td><input type="checkbox" style="zoom:1.5;" onclick="Check_Click(this)" name="chkItemN" class="chkItemN"  /> </td>';
                    rowcol += '<td><input type="hidden" id="hdnOPDCharges"  class="hdnOPDCharges" value="' + $(this).find("PRICE_SERVICE_CHARGES").text() + '"/><input type="hidden" id="hdnServiceName"  class="hdnServiceName" value="' + $(this).find("SERVICE_NAME").text() + '"/><input type="hidden" id="hdnServiceCode"  class="hdnServiceCode" value="' + $(this).find("SERVICE_CODE").text() + '"/>' + $(this).find("SERVICE_CODE").text() + '</td>';
                    rowcol += '<td>' + $(this).find("SERVICE_TYPE").text() + '</td>';
                    rowcol += '<td>' + $(this).find("SERVICE_CATEGORY").text() + '</td>';
                    rowcol += '<td>' + $(this).find("SERVICE_NAME").text() + '</td>';
                    rowcol += '<td>' + $(this).find("PRICE_SERVICE_CHARGES").text() + '</td>';
                    rowcol += '</tr>';
                    table.append(rowcol);

                    count += 1;
                }); //each end here 

                if (parseInt(count) == 0) {
                    var rowcol = '';
                    rowcol += '<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;No matching record found !</td></tr>';
                    table.append(rowcol);
                    $('#divSearchBindK').html(table);
                }
                else {
                    $('#divSearchBindK').html(table);
                    var _table = $('#divSearchBindK table');
                    bind_filterevent(_table);
                    paginateIt(_table, 4);
                    visibility_paging(_table);

                }
            },
            failure: function(response) {
                alert('Service Billing  Bind Failed');
            },
            error: function(response) {
                alert('Service Billing Bind Error');
            }
        }); //Post Data end here 

    } //click end here  



    var counterDocuments = 0;

    SelectPatientRecord = function(_uhid) {
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/SearchUHIDRecord',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            cache: false,
            async: false,
            data: "{'UHID':'" + _uhid + "','NAME':'" + '' + "','MOBILE':'" + '' + "'}",
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                var row = '';
                var count = 0;
                $.each(items, function(index) {
                    $("#txtUhid").val($(this).find("UHID").text());
                    $("#txtname").val($(this).find("FNAME").text());
                    $("#ddlGender").val($(this).find("GENDER").text());
                    $("#txtAadharNo").val($(this).find("ADHAR_NO").text());
                    $("#txtMobile").val($(this).find("MOBILE").text());
                    $("#txtAlternateMob").val($(this).find("ALTERNATE_NO").text());
                    $("#txtDateOfBirth").val($(this).find("DOB").text());
                    $("#txtyy").val($(this).find("AGE_YY").text());
                    $("#txtmm").val($(this).find("AGE_MM").text());
                    $("#txtdd").val($(this).find("AGE_DD").text());
                    $("#ddlReligion").val($(this).find("RELIGION").text());
                    $("#ddlmaritalStatus").val($(this).find("MARITAL_STATUS").text());
                    $("#txtEmail").val($(this).find("EMAIL").text());
                    $("#txtfatherHusband").val($(this).find("FATHER_NAME").text());
                    $("#txtFamilyIncome").val($(this).find("FAMILY_INCOME").text());
                    $("#ddlPatientcategory").val($(this).find("PATIENT_CATEGORY").text());
                    $("#ddlPatientcategory").trigger('change');
                    $("#ddlOccupation").val($(this).find("OCCUPATION_CODE").text());
                    $("#txtHT").val($(this).find("HEIGHT").text());
                    $("#txtWT").val($(this).find("WEIGHT").text());
                    $("#txtBloodGroup").val($(this).find("BLOOD_GROUP").text());
                    $("#txtApgarScore").val($(this).find("APGAR").text());
                    $("#txtGrowth").val($(this).find("GROWTH").text());
                    $("#txtWaist").val($(this).find("WAIST").text());
                    $("#txtObesity").val($(this).find("OBESITY").text());
                    $("#ddlCountry").val($(this).find("COUNTRY_CODE").text());
                    $("#ddlCountry").trigger('change');
                    $("#ddlState").val($(this).find("STATE_CODE").text());
                    $("#ddlState").trigger('change');
                    $("#ddlCity").val($(this).find("CITY_CODE").text());
                    $("#txtPinNo").val($(this).find("PINCODE").text());
                    $("#ddlLocality").val($(this).find("LOCALITY_CODE").text());
                    $("#txtReferredBy").val($(this).find("REF_BY").text());
                    $("#txtInsuranceCompanyName").val($(this).find("COMPANY_NAME").text());
                    $("#txtPolicyAmount").val($(this).find("POLICY_AMOUNT").text());
                    $("#btnCloseP").trigger('click');
                });     //table loop end here 
            },
            failure: function(response) {
                alert('Searching Failed');
            },
            error: function(response) {
                alert('Searching Error');
            }
        });

    }  // SEARCH PATIENT THROUGH UHID ENDS HERE


    SelectAllPatientRecord = function(_uhid) {
        debugger;
        $("#btnReset").trigger('click');
        CheckExistingPDischarged(_uhid);
        if (discharged_Status == '0') {
            alert('Patient is Already ACTIVE. Please search from Short Stay No. below to search ACTIVE patient');
            $("#btnClosePop1").trigger('click');
            discharged_Status = '';
        }
        else {
            
            var _OPD_CARD_NO = $("#txtOPDNOSearch").val();
            _OPD_CARD_NO = $("#txtOPDNoPop1").val();
            var _IPD_no = $("#txtIPDNoSearch").val();
            _IPD_no = $("#txtIPDPop1").val();
            var _name = $("#txtNameSearch").val();
            _name = $("#txtNamePop1").val();
            var _mobileno = $("#txtMobileSearch").val();
            _mobileno = $("#txtMobilePop1").val();
            var _Aadhaar_no = $("#txtAadhaarSearch").val();
            _Aadhaar_no = $("#txtAdhaarnoPop1").val();
            var _Casualty_no = $("#txtCasualtySearch").val();
            _Casualty_no = $("#txtCasualtyPop1").val();
            $.ajax({
                type: 'POST',
                url: 'IpdShortStay.aspx/SearchAllRecord',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                cache: false,
                async: false,
                data: "{'SEARCH_UHID':'" + _uhid
                + "','SEARCH_NAME':'" + _name
                + "','SEARCH_MOBILE':'" + _mobileno
                + "','SEARCH_OPD':'" + _OPD_CARD_NO
                + "','SEARCH_IPD':'" + _IPD_no
                + "','SEARCH_AADHAAR':'" + _Aadhaar_no
                + "','SEARCH_CASUALTY':'" + _Casualty_no
                + "'}",
                beforeSend: function () {
                },
                success: function (response) {
                    var xmlDoc = $.parseXML(response.d);
                    var xml = $(xmlDoc);
                    var items = xml.find("Table");
                    var row = '';
                    var count = 0;
                    $.each(items, function (index) {
                        $("#txtUhid").val($(this).find("UHID").text());
                        $("#txtname").val($(this).find("NAME").text());
                        $("#txtMobile").val($(this).find("MOBILE").text());
                        $("#txtOpdCardNo").val($(this).find("OPD_CARD_NO").text());
                        //$("#txtAdmisssion").val($(this).find("ADMISSION_NO").text());
                        $("#txtCasualtyNo").val($(this).find("CR_NO").text());
                        $("#txtAadharNo").val($(this).find("ADHAR_NO").text());
                        $("#txtyy").val($(this).find("AGE_YY").text());
                        $("#txtmm").val($(this).find("AGE_MM").text());
                        $("#txtdd").val($(this).find("AGE_DD").text());

                        $("#txtDependentName").val($(this).find("DEPENDENT_NAME").text());
                        $("#txtDependentRank").val($(this).find("RANK").text());
                        $("#txtDependentPidNo").val($(this).find("PID_NO").text());
                        $("#txtDependentPunit").val($(this).find("UNIT").text());

                        //$("#txtdd").val($(this).find("TITLE").text());

                        //------bind department--------
                        $("#ddlDepartment").val($(this).find("DEPARTMENT_CODE").text());
                        $("#ddlLocality").val($(this).find("LOCALITY_CODE").text());
                        $("#txtHT").val($(this).find("HEIGHT").text());
                        $("#txtWT").val($(this).find("WEIGHT").text());
                        $("#txtBloodGroup").val($(this).find("BLOOD_GROUP").text());
                        $("#txtApgarScore").val($(this).find("APGAR").text());
                        $("#txtGrowth").val($(this).find("GROWTH").text());
                        $("#txtWaist").val($(this).find("WAIST").text());
                        $("#txtObesity").val($(this).find("OBESITY").text());
                        $("#txtfatherHusband").val($(this).find("FATHER_NAME").text());
                        $("#ddlGender").val($(this).find("GENDER").text());
                        $("#txtDateOfBirth").val($(this).find("DOB").text());
                        $("#txtBedNo").val($(this).find("IPD_BED_NO").text());
                        $("#ddlOccupation").val($(this).find("OCCUPATION_CODE").text());
                        $("#ddlmaritalStatus").val($(this).find("MARITAL_STATUS").text());
                        $("#txtEmail").val($(this).find("EMAIL").text());
                        $("#ddlCountry").val($(this).find("COUNTRY_CODE").text());
                        $("#ddlCountry").trigger('change');
                        $("#ddlState").val($(this).find("STATE_CODE").text());
                        $("#ddlState").trigger('change');
                        $("#ddlCity").val($(this).find("CITY_CODE").text());
                        $("#ddlCity").trigger('change');
                        $("#txtPinNo").val($(this).find("PINCODE").text());
                        $("#txtReferredBy").val($(this).find("REF_BY").text());

                        //-------------NEW ADD--------------
                        $("#txtAlternateMob").val($(this).find("ALTERNATE_NO").text());
                        $("#ddlReligion").val($(this).find("RELIGION").text());
                        $("#txtFamilyIncome").val($(this).find("FAMILY_INCOME").text());
                        $("#txtCompanyName").val($(this).find("COMPANY_NAME").text());
                        $("#txtEmployeeId").val($(this).find("EMPLOYEE_ID").text());
                        $("#txtRaddress").val($(this).find("ADDRESS_1").text());
                        $("#ddlPaymode").val($(this).find("PAY_MODE").text());
                        $("#txtReferredBy").val($(this).find("REF_BY").text());
                        $("#txtDoctor").val($(this).find("DOCTOR_CODE").text());
                        $("#ddlWardNo").val($(this).find("WARD_NO").text());
                        $("#txtBedNo").val($(this).find("BED_NO").text());
                        $("#ddlDiet").val($(this).find("DIET").text());
                        $("#ddlRoomNo").val($(this).find("ROOM_NO_CODE").text());
                        $("#txtHouseNo").val($(this).find("HOUSE_NO").text());
                        $("#txtStreetName").val($(this).find("STREET_NAME").text());
                        $("#txtStreetNo").val($(this).find("STREET_NO").text());
                        $("#txtLandmark").val($(this).find("LANDMARK").text());
                        $("#ddlLanguage").val($(this).find("LANGUAGE_OF_CHOICE").text());
                        $("#txtkinName").val($(this).find("KIN_NAME").text());
                        $("#txtKinAddress").val($(this).find("KIN_ADDRESS").text());
                        $("#ddlRelation").val($(this).find("KIN_RELATION_CODE").text());
                        $("#txtKinMobile").val($(this).find("KIN_CONTACT_NO").text());
                        $("#txtDependentName").val($(this).find("DEPENDENT_NAME").text());
                        $("#ddlDependentRelation").val($(this).find("RELATION_WITH_DEPENDENT_CODE").text());
                        $("#txtDependentRank").val($(this).find("RANK").text());
                        $("#txtDependentPidNo").val($(this).find("PID_NO").text());
                        $("#txtDependentPunit").val($(this).find("P_UNIT").text());
                        $("#txtEmergencyName").val($(this).find("EMERGENCY_NAME").text());
                        $("#txtEmergencyMobile").val($(this).find("EMERGENCY_CONTACT").text());
                        $("#txtEmergencyAddress").val($(this).find("EMERGENCY_ADDRESS").text());

                        var PatientCategory = $(this).find("PATIENT_CATEGORY").text();
                        if ($(this).find("PATIENT_CATEGORY").text() == '7') {
                            $("#InsuredFieldSet").css("display", "");
                        }
                        $("#ddlPatientcategory").val($(this).find("PATIENT_CATEGORY").text());
                        if ($(this).find("PATIENT_CATEGORY").text() == "5") {
                            $("#asuhmanid").css('display', '');
                            $("#txtaushmancardno").val($(this).find("AUSHMAN_CARD_NO").text());
                            $("#txtaushmancardno").attr("disabled", "disabled");
                            $("#idforbplcard").css('display', 'none');
                        }
                        else if ($(this).find("PATIENT_CATEGORY").text() == "3") {
                            $("#idforbplcard").css('display', '');
                            $("#txtbplcardno").val($(this).find("BPL_CARD_NO").text());
                            $("#txtbplcardno").attr("disabled", "disabled");
                            $("#asuhmanid").css('display', 'none');
                        }
                        else {
                            $("#asuhmanid").css('display', 'none');
                            $("#idforbplcard").css('display', 'none');
                        }

                        if (PatientCategory == '')
                        {
                            $("#ddlPatientcategory").attr("disabled", false);
                        }
                        else {
                            $("#ddlPatientcategory").attr("disabled", true);
                        }


                        $("#btnClosePop1").trigger('click');
                        discharged_Status = '';

                    });     //table loop end here
                    BindDefaultServiceGrid();
                },
                failure: function (response) {
                    alert('Searching Failed');
                },
                error: function (response) {
                    alert('Searching Error');
                }
            });
        } ////end of search patient
       
    }  // SEARCH PATIENT THROUGH UHID ENDS HERE


    CheckExistingPDischarged = function (_uhid) {
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/EXISTING_PATIENT_STATUS_SS',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            cache: false,
            async: false,
            data: "{'UHID':'" + _uhid + "'}",
            beforeSend: function () {
            },
            success: function (response) {

                discharged_Status = response.d;



            },
            failure: function (response) {
                alert('Searching New Record Failed');
            },
            error: function (response) {
                alert('Searching New Record Error');
            }
        });
    }

    SelectNewPatientRecord = function(_uhid) {
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/SearchNewUHIDRecord',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            cache: false,
            async: false,
            data: "{'UHID':'" + _uhid + "'}",
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                var row = '';
                var count = 0;
                $.each(items, function(index) {
                    $("#txtUhid").val($(this).find("UHID").text());
                    $("#txtname").val($(this).find("FNAME").text());
                    $("#ddlGender").val($(this).find("GENDER").text());
                    $("#txtMobile").val($(this).find("MOBILE").text());
                    $("#txtyy").val($(this).find("AGE_YY").text());
                    $("#txtAadharNo").val($(this).find("ADHAR_NO").text());
                    $("#ddlLocality").val($(this).find("LOCALITY_CODE").text());
                    $("#ddlPatientcategory").val($(this).find("PATIENT_CATEGORY").text());

                    $("#ddlDepartment").val($(this).find("DEPARTMENT_CODE").text());
                    //if ($(this).find("PATIENT_CATEGORY").text() == "5") {
                    //    $("#asuhmanid").css('display', '');
                    //    $("#txtaushmancardno").val($(this).find("AUSHMAN_CARD_NO").text());
                    //    $("#txtaushmancardno").attr("disabled", "disabled");
                    //    $("#idforbplcard").css('display', 'none');
                    //}
                    //else if ($(this).find("PATIENT_CATEGORY").text() == "3") {
                    //    $("#idforbplcard").css('display', '');
                    //    $("#txtbplcardno").val($(this).find("BPL_CARD_NO").text());
                    //    $("#txtbplcardno").attr("disabled", "disabled");
                    //    $("#asuhmanid").css('display', 'none');
                    //}
                    //else {
                    //    $("#asuhmanid").css('display', 'none');
                    //    $("#idforbplcard").css('display', 'none');
                    //}
                    $("#txtDependentRank").val($(this).find("RANK").text());
                    $("#txtDependentPidNo").val($(this).find("PID_NO").text());
                    $("#txtDependentPunit").val($(this).find("UNIT").text());
                    $("#ddlDependentRelation").val($(this).find("RELATION_WITH_DEPENDENT").text());
                    $("#txtDependentName").val($(this).find("DEPENDENT_NAME").text());


                    $("#ddlPatientcategory").attr("disabled", "disabled");
                    //$("#btnCloseNewPatient").trigger('click');
                    $("#btnResetNewPatient").trigger('click');
                    $("#btnUpdateAdmission").css("display", "none");
                    $("#btnSaveAdmission").css("display", "");
                    CalculateRowAmount();




                });     //table loop end here
                BindDefaultServiceGrid();
            },
            failure: function(response) {
                alert('Searching New Record Failed');
            },
            error: function(response) {
                alert('Searching New Record Error');
            }
        });

    }  // GET NEW PATIENT RECORD THROUGH UHID ENDS HERE


    FileUploadFunction = function(_ID) 
    {
        debugger;
        var fileUpload = $("#FileUpload1").get(0);
        var files = fileUpload.files;
        var data = new FormData();
        for (var i = 0; i < files.length; i++) 
        {
            data.append(files[i].name, files[i]);
        }
        $.ajax
        ({
            url: "IpdShortStayMLCDetail.ashx?ID=" + _ID + "",
            type: "POST",
            data: data,
            contentType: false,
            processData: false,
            success: function(result) { },
            error: function(err) 
            {
                //alert(err.statusText)  
            }
        });

        //evt.preventDefault();

    }  // FILE UPLOAD FUNCTION ENDING



    FileUploadUPdateFunction = function(_ID, _fname) {

        var fileUpload = $("#FileUpload1").get(0);
        var files = fileUpload.files;
        var data = new FormData();
        for (var i = 0; i < files.length; i++) {
            data.append(files[i].name, files[i]);
        }

        $.ajax({
            url: "IpdShortStayMLCFileUpdate.ashx?ID=" + _ID + "&Fname=" + _fname,
            type: "POST",
            data: data,
            contentType: false,
            processData: false,
            success: function(result) { },
            error: function(err) {
                //alert(err.statusText)  
            }
        });
    }


    PrintPDF = function(_Admn_id) {
        window.location.href = "/webdhanvantri/IPD/Report/IPDReport.aspx?ADMISSION_NO=" + _Admn_id;

    }

    AddEditRowEducation = function(_id) {
        var _newId = parseInt(_id) + 1;
        $("#tblEditEducationId").append("<tbody><tr id='tr" + _newId + "'><td><input type='text' class='form-control clsEducation' id='txtEducation' placeholder='Education'/></td>\
            <td><input type='text' class='form-control clsUniversity' id='txtUniversity' placeholder='University' /></td>\
            <td><input type='text' class='form-control clsMarks' id='txtMarks' placeholder='Marks'/></td>\
            <td><input type='text' class='form-control clsPassingYear' id='txtPassingYear' placeholder='Year'/></td>\
            <td><button type='button' id='btnDeleteEducation' onclick='DeleteRowEditEducation(" + _newId + ")' class='btn btn-danger'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></button>\
            <button type='button' onclick='AddEditRowEducation(" + _newId + ");' class='btn btn-primary'><i class='fa fa-plus' aria-hidden='true'></i></button></td></tr></tbody>");
    }

    DeleteRowEditEducation = function(_trid) {
        var _ctr = 0;
        $('#tblEditEducationId tr ').not(':first').each(function() {
            _ctr++;
        });
        if (parseInt(_ctr) != 1) {
            var _trId = "#tr" + _trid;
            //$(_trId).remove().delay(3200).fadeOut(300);
            $(_trId).remove().fadeOut(100);
        }
    }

    Addfunction = function(_id) {
        var _newId = parseInt(_id) + 1;
        $("#tblEditDocumentId").append("<tbody><tr id='Td" + _newId + "'><td><input type='text' class='form-control clsFileName' id='txtFileName" + _newId + "' placeholder='File Name' /></td>\
            <td><input type='file' class='btn btn-primary FileUpload' id='File" + _newId + "'/><a href='#' id='a" + _newId + "' class='documentLink'  target='_blank'></a></td>\
            <td> <button type='button' id='btnDeleteDocument' onclick='DeleteRow(" + _newId + ")' class='btn btn-danger'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></button>&nbsp;&nbsp;\
            <button type='button' onclick='Addfunction(" + _newId + ")' class='btn btn-primary btnclsPlusDocument'><i class='fa fa-plus' aria-hidden='true'></i></button></td></tr></tbody>");
    }

    DeleteRow = function(_trid) {
        var _ctr = 0;
        $('#tblEditDocumentId tr ').not(':first').each(function() {
            _ctr++;
        });
        if (parseInt(_ctr) != 1) {
            var _trId = "#Td" + _trid;
            //$(_trId).remove().delay(3200).fadeOut(300);
            $(_trId).remove().fadeOut(100);

        }
    }


    AddRowEducation = function(_trid) {
        var _btnAdd = "#btnPlusEducation" + _trid;
        var _newTrid = parseInt(_trid) + 1;
        //$(_btnAdd).css('display','none');
        var Ftrid = "<tr id='tr" + _newTrid + "'><td><input type='text' class='form-control clsEducation' id='txtEducation'+trid+'' placeholder='Education'  /></td>\
           <td><input type='text' class='form-control clsUniversity' id='txtUniversity'+trid+'' placeholder='University'  /></td>\
           <td><input type='text' class='form-control clsMarks' id='txtMarks'+trid+'' placeholder='Marks'  /></td>\
           <td><input type='text' class='form-control clsPassingYear' id='txtPassingYear'+trid+'' placeholder='Year'  /></td>\
           <td style='width:120px'><button type='button' id='btnDeleteEducation' onclick='DeleteRowEducation(" + _newTrid + ")' class='btn btn-danger'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></button>\
            <button type='button' id='btnPlusEducation" + _newTrid + "' onclick='AddRowEducation(" + _newTrid + "); 'class='btn btn-primary ml-1'><i class='fa fa-plus btnclsPlusEducation' aria-hidden='true'></i></button></td></tr>";
        $(".tblEducation tbody").append(Ftrid);
        $(".tblUpdateEducation tbody").append(Ftrid);

    }

    DeleteRowEducation = function(_trid) {

        //           var lastId=$('#tblEducationId tr:last').attr('id');   //last row
        //           alert(lastId);
        //            var _CurrentId="tr"+_trid;  //current row
        //           alert(_CurrentId);
        if (_trid == 1) {
            $("#btnDeleteEducation").css("disabled", "disabled");
        }

        else {
            var _deltrId = "#tr" + _trid;

            $(_deltrId).remove().delay(3200).fadeOut(300);
        }
    }

    AddRowDocument = function(_trid) {
        var _btnAdd = "#btnPlusDocument" + _trid;
        var _newTrid = parseInt(_trid) + 1;
        // $(_btnAdd).css('display','none');
        var Ftrid = "<tr id='Td" + _newTrid + "'><td><a href='#' id='a" + _newTrid + "' target='_blank' class='documentLink'></a><input type='text' class='form-control clsFileName' id='txtFileName" + _newTrid + "' placeholder='File Name'  /></td>\
           <td ><input type='file' class='btn btn-primary FileUpload' id='File" + _newTrid + "' /></td>\
           <td><button type='button' id='btnDeleteDocument' onclick='DeleteRowDocument(" + _newTrid + ")' class='btn btn-danger'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></button>&nbsp;\
            <button type='button' id='btnPlusDocument" + _newTrid + "' style='margin-top: 3px;' onclick='AddRowDocument(" + _newTrid + ");' class='btn btn-primary btnclsPlusDocument'><i class='fa fa-plus ' aria-hidden='true'></i></button></td></tr>";
        $(".tblDocumentUpload tbody").append(Ftrid);
    }

    DeleteRowDocument = function(_trid) {
        if (_trid == 1) {
            $("#btnDeleteDocument").css("disabled", "disabled");
        }

        else {
            var _deltrId = "#Td" + _trid;

            $(_deltrId).remove().delay(3200).fadeOut(300);
        }
    }


    UpdateDocuments = function(_ID) {
debugger;
        //  deleteSelectedRecord(_ID);
        if (counterDocuments > 0) {
            var lastId = $('#tblEditDocumentId tr:last').attr('id');
        }
        else {
            var lastId = $('#tblDocumentId tr:last').attr('id');
        }

        var _last_id = lastId.substring(2, 3);

        if (_last_id == 0) {
            var lastId = $('#tblDocumentId tr:last').attr('id');
            var _last_id = lastId.substring(2, 3);
        }
        for (var j = 1; j <= _last_id; j++) {
            var name = $("#txtFileName" + j).val();
            if (name == undefined) {
                continue;
            }
            var fileUpload1 = $("#File" + j).get(0);
            var files1 = fileUpload1.files;
            if (files1.length == 0) {
                files1 = $("#a" + j).attr("href").substring(10);
                //            if(files1!="")
                //            {
                //                saveUpdateDocuments(_ID,name,files1);
                //            }
            }
            var data = new FormData();

            for (var i = 0; i < files1.length; i++) {
                data.append(files1[i].name, files1[i]);
            }

            $.ajax({
                url: "IpdShortStayUpdateDocuments.ashx?ID=" + _ID + "&Name=" + name + "&files=" + files1,
                type: "POST",
                data: data,
                contentType: false,
                processData: false,
                success: function(result) { },
                error: function(err) {
                    //alert(err.statusText)  
                }
            });
        }
    }  // DOCUMENT UPLOAD FUNCTION ENDING


    DocumentSaveFunction = function(_ID) {
        debugger;
        var lastId = $('#tblDocumentId tr:last').attr('id');
        var _last_id = lastId.substring(2, 3);

        for (var j = 1; j <= _last_id; j++) {
            var name = $("#txtFileName" + j).val();
            if (name == undefined) {
                continue;
            }
            var fileUpload1 = $("#File" + j).get(0);

            var files1 = fileUpload1.files;
            var data = new FormData();

            for (var i = 0; i < files1.length; i++) {
                data.append(files1[i].name, files1[i]);
            }

            $.ajax({
                url: "IpdShortStaySaveDocument.ashx?ID=" + _ID + "&Name=" + name,
                type: "POST",
                data: data,
                contentType: false,
                processData: false,
                success: function(result) { },
                error: function(err) {
                    //alert(err.statusText)  
                }
            });
        }
    }  // DOCUMENT UPLOAD FUNCTION ENDING

    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function(e) {
                $('#blah')
                        .attr('src', e.target.result)
                        .width(105)
                        .height(200);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }

    chkGender = function() {
        if ($("#ddlGender").val() == 'Male' || $("#ddlGender").val() == 'MALE') {
            $("#chkPregnancy").attr("disabled", "disabled");
            $("#chkParental").attr("disabled", "disabled");
            $("#txtlastMenstrualDate").attr("disabled", "disabled");
            $("#txtEstDate").attr("disabled", "disabled");
        }
        else {
            $("#chkPregnancy").removeAttr("disabled", "disabled");
            $("#chkParental").removeAttr("disabled", "disabled");
        }
    }


    function CalculateAge() {
        var mdate = $("#txtDateOfBirth").val().toString();
        //        var yearThen = parseInt(mdate.substring(0,4), 10);
        //        var monthThen = parseInt(mdate.substring(5,7), 10);
        //        var dayThen = parseInt(mdate.substring(8,10), 10);


        var dayThen = parseInt(mdate.substring(0, 2), 10);
        var monthThen = parseInt(mdate.substring(3, 5), 10);
        var yearThen = parseInt(mdate.substring(6, 10), 10);

        var today = new Date();
        var birthday = new Date(yearThen, monthThen - 1, dayThen);

        var differenceInMilisecond = today.valueOf() - birthday.valueOf();

        var year_age = Math.floor(differenceInMilisecond / 31536000000);
        var day_age = Math.floor((differenceInMilisecond % 31536000000) / 86400000);

        if ((today.getMonth() == birthday.getMonth()) && (today.getDate() == birthday.getDate())) {
            alert("Happy B'day!!!");
        }

        var month_age = Math.floor(day_age / 30);
        //alert(day_age);
        day_age = day_age % 30;
        //alert(day_age);
        //        if (isNaN(year_age) || isNaN(month_age) || isNaN(day_age)) {
        //            $("#exact_age").text("Invalid birthday - Please try again!");
        //        }
        //        else {
        //            $("#exact_age").html("You are<br/><span id=\"age\">" + year_age + " years " + month_age + " months " + day_age + " days</span> old");
        //        }
        $("#txtdd").val(day_age);
        $("#txtmm").val(month_age);
        $("#txtyy").val(year_age);
        //        alert(year_age);
        //        alert(month_age);
        //        alert(day_age);
    }


    //---------------------------------BIND DROPDOWNS------------------------------------//

    BindCountry = function() {

        $("#ddlCountry").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetCountryList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {

                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlCountry").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlCountry").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Country Failed');
            },
            error: function(response) {
                alert('Bind Country Error');
            }
        });
    }  // BIND COUNTRY FUNCTION ENDING


    BindState = function(_countryId) {

        $("#ddlState").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetStateList',
            async: false,
            cache: true,
            data: "{'COUNTRY_CODE':'" + _countryId + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlState").removeAttr("disabled");
                $("#ddlState").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlState").append($("<option></option>").val($(this).find("STATE_CODE").text()).html($(this).find("STATE_NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind State Failed');
            },
            error: function(response) {
                alert('Bind State Error');
            }
        });
    }  //  BIND STATE FUNCTION ENDING


    BindCity = function(_state_id) {

        $("#ddlCity").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetCityList',
            async: false,
            cache: false,
            data: "{'STATE_CODE':'" + _state_id + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlCity").removeAttr("disabled");
                $("#ddlCity").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlCity").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind City Failed');
            },
            error: function(response) {
                alert('Bind City Error');
            }
        }); //POST END HERE 
    }  // BIND CITY FUNCTION ENDING


    BindPincode = function(_city_id) {
        $("#txtPinNo").empty("");
        $("#txtPinNo").val('');
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetPincodeRecord',
            async: false,
            cache: false,
            data: "{'CITY_CODE':'" + _city_id + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $.each(items, function(index) {
                    $("#txtPinNo").val($(this).find("PINCODE").text());
                });
            },
            failure: function(response) {
                alert('Get Pin Code Failed');
            },
            error: function(response) {
                alert('Get Pin Code Error');
            }
        }); //POST END HERE 
    }  //  GET PIN CODE FUNCTION ENDING


    AddAllergy = function(_rowId) {
        var _totctr = 0; //btnAddComplaint
        var btnAddComplaint = "#btnAddAllergy" + _rowId;
        $(btnAddComplaint).css('display', 'none');
        $("#tblAllergy tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="td'+_newTrid+'"><td>'+_newTrid+'</td><td><select id="ddlBrand'+_newTrid+'" style="width: 100px;" class="form-control ddlBrand"><option></option></select></td><td><input type="text" class="form-control txDosageForm" id="txDosageForm'+_newTrid+'" /></td><td><select style="width: 140px;" id="ddlStrength'+_newTrid+'" class="form-control ddlStrength"><option value="0">-- Select --</option></select></td><td><select style="width: 140px;" id="ddlDosages'+_newTrid+'" class="form-control ddlDosages"></select></td><td><select id="ddlDosagesComment'+_newTrid+'" style="width: 100px;" class="form-control ddlDosagesComment"><option value="0">-- Select --</option></select></td><td><input type="text" style="width: 120px;" id="txtDuration'+_newTrid+'" class="form-control txtDuration" /></td><td><select style="width: 120px;" id="ddlGrdBrandUnit'+_newTrid+'" class="form-control ddlGrdBrandUnit"><option value="0">-- Select --</option><option value="1">Minute(s)</option><option value="2">Hour(s)</option><option value="3">Day(s)</option><option value="4">Week(s)</option><option value="5">Month(s)</option><option value="6">Year(s)</option></select></td><td><input type="text" class="form-control txtBrandRemarks" id="txtBrandRemarks" /></td><td style="white-space: nowrap"><button type="button" id="btnGrdBrandUnitAdd'+_newTrid+'" onClick="AddBrand('+_newTrid+')" class="btn btn-info" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnGrdBrandUnitDelete" onClick="DeleteBrand('+_newTrid+')" class="btn btn-danger ml-2" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnAllergyCode' + _newTrid + '" class="hdnAllergyCode" value="0"/><input type="text" id="txtAllergy' + _newTrid + '" class="form-control txtAllergy" /></td><td><input type="text" id="txtAllergyType' + _newTrid + '" class="form-control txtAllergyType"></td><td><input type="text" id="txtAllergySince' + _newTrid + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtAllergySince"/></td><td><select id="ddlAllergySince' + _newTrid + '" class="form-control ddlAllergySince" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtNotesComment' + _newTrid + '" class="txtNotesComment"></textarea></td><td align="center" style=""><button type="button" id="btnAddAllergy' + _newTrid + '" onclick="AddAllergy(' + _newTrid + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteAllergy' + _newTrid + '" onclick="DeleteAllergy(' + _newTrid + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        $("#tblAllergy tbody").append(Ftrid);
        BindAutoCompleteForAllergy(_newTrid);
    }
    DeleteAllergy = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeleteAllergy" + _rowId).css("disabled", "disabled");
            $("#btnAddAllergy" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }
    AddPastHistory = function(_rowId) {
        var _totctr = 0; //btnAddComplaint
        var btnAddComplaint = "#btnAddPastHistory" + _rowId;
        $(btnAddComplaint).css('display', 'none');
        $("#tblPastHistory tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="td'+_newTrid+'"><td>'+_newTrid+'</td><td><select id="ddlBrand'+_newTrid+'" style="width: 100px;" class="form-control ddlBrand"><option></option></select></td><td><input type="text" class="form-control txDosageForm" id="txDosageForm'+_newTrid+'" /></td><td><select style="width: 140px;" id="ddlStrength'+_newTrid+'" class="form-control ddlStrength"><option value="0">-- Select --</option></select></td><td><select style="width: 140px;" id="ddlDosages'+_newTrid+'" class="form-control ddlDosages"></select></td><td><select id="ddlDosagesComment'+_newTrid+'" style="width: 100px;" class="form-control ddlDosagesComment"><option value="0">-- Select --</option></select></td><td><input type="text" style="width: 120px;" id="txtDuration'+_newTrid+'" class="form-control txtDuration" /></td><td><select style="width: 120px;" id="ddlGrdBrandUnit'+_newTrid+'" class="form-control ddlGrdBrandUnit"><option value="0">-- Select --</option><option value="1">Minute(s)</option><option value="2">Hour(s)</option><option value="3">Day(s)</option><option value="4">Week(s)</option><option value="5">Month(s)</option><option value="6">Year(s)</option></select></td><td><input type="text" class="form-control txtBrandRemarks" id="txtBrandRemarks" /></td><td style="white-space: nowrap"><button type="button" id="btnGrdBrandUnitAdd'+_newTrid+'" onClick="AddBrand('+_newTrid+')" class="btn btn-info" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnGrdBrandUnitDelete" onClick="DeleteBrand('+_newTrid+')" class="btn btn-danger ml-2" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnPastHistoryCode' + _newTrid + '" class="hdnPastHistoryCode" value=""/><input type="text" id="txtPastHistory' + _newTrid + '" class="form-control txtPastHistory" value=""></td><td><input type="text" id="txtPastHistoryType' + _newTrid + '" class="form-control txtPastHistoryType" value=""></td><td><input type="text" id="txtPastHistorySince' + _newTrid + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtPastHistorySince"/></td><td><select id="ddlPastHistoryUnit' + _newTrid + '" class="form-control ddlPastHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtPastHistoryNotesComment' + _newTrid + '" class="txtPastHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPastHistory' + _newTrid + '" onclick="AddPastHistory(' + _newTrid + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePastHistory' + _newTrid + '" onclick="DeletePastHistory(' + _newTrid + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        $("#tblPastHistory tbody").append(Ftrid);
        BindAutoCompleteForPastHistory(_newTrid);
    }
    DeletePastHistory = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeletePastHistory" + _rowId).css("disabled", "disabled");
            $("#btnAddPastHistory" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }
    AddDisease = function(_rowId) {

        var _totctr = 0; //btnAddComplaint
        var btnAddDisease = "#btnAddDisease" + _rowId;
        $(btnAddDisease).css('display', 'none');
        $("#tblDisease tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="tr'+_newTrid+'"><td style=""><input type="hidden" id="hdnComplaintCode'+_newTrid+'" value=""/><input type="text" id="txtComplaint'+_newTrid+'" class="form-control"/></td><td><textarea id="txtcomplaintRemarks14" class="form-control" style="height:36px;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint'+_newTrid+'" onclick="AddComplaint('+_newTrid+')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint'+_newTrid+'" onclick="DeleteComplaint('+_newTrid+');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnDiseaseCode' + _newTrid + '" class="hdnDiseaseCode" value=""/><input type="text" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" id="txtDisease' + _newTrid + '" class="form-control txtDisease"/></td><td><input type="text" id="txtProvisionalDisease' + _newTrid + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtProvisionalDisease"/></td><td><select id="ddlProvisionalDiseaseUnit' + _newTrid + '" class="form-control ddlProvisionalDiseaseUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtDiseaseRemarks' + _newTrid + '" class="form-control txtDiseaseRemarks" style="height:45px;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddDisease' + _newTrid + '" onclick="AddDisease(' + _newTrid + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteDisease' + _newTrid + '" onclick="DeleteDisease(' + _newTrid + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        $("#tblDisease tbody").append(Ftrid);
        //BindBrand();
        BindAutoCompleteForDisease(_newTrid);


    }
    DeleteDisease = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeleteDisease" + _rowId).css("disabled", "disabled");
            $("#btnAddDisease" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }
    AddAdvisedInvestigation = function(_rowId) {

        var _totctr = 0; //btnAddComplaint
        var btnAddDisease = "#btnAddAdvisedInvestigation" + _rowId;
        $(btnAddDisease).css('display', 'none');
        $("#tblAdvisedInvestigation tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="tr'+_newTrid+'"><td style=""><input type="hidden" id="hdnComplaintCode'+_newTrid+'" value=""/><input type="text" id="txtComplaint'+_newTrid+'" class="form-control"/></td><td><textarea id="txtcomplaintRemarks14" class="form-control" style="height:36px;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint'+_newTrid+'" onclick="AddComplaint('+_newTrid+')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint'+_newTrid+'" onclick="DeleteComplaint('+_newTrid+');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnalreadyinvcode' + _newTrid + '" class="hdnalreadyinvcode" value=""/><input type="hidden" id="hdnalreadyinvName' + _newTrid + '" class="hdnalreadyinvName" value=""/><input type="text" id="txtAdvisedInvestigation' + _newTrid + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtAdvisedInvestigation"/></td><td style="white-space:nowrap"><button type="button" id="btnAddAdvisedInvestigation' + _newTrid + '" onclick="AddAdvisedInvestigation(' + _newTrid + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteAdvisedInvestigation' + _newTrid + '" onclick="DeleteAdvisedInvestigation(' + _newTrid + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        $("#tblAdvisedInvestigation tbody").append(Ftrid);
        //BindBrand();
        BindAutoCompleteForAdvisedInvestigation(_newTrid);


    }
    DeleteAdvisedInvestigation = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeleteAdvisedInvestigation" + _rowId).css("disabled", "disabled");
            $("#btnAddAdvisedInvestigation" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }
    
      AddProcedure = function(_rowId) {

        var _totctr = 0; //btnAddComplaint
        var btnAddDisease = "#btnAddProcedure" + _rowId;
        $(btnAddDisease).css('display', 'none');
        $("#tblProcedure tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="tr'+_newTrid+'"><td style=""><input type="hidden" id="hdnComplaintCode'+_newTrid+'" value=""/><input type="text" id="txtComplaint'+_newTrid+'" class="form-control"/></td><td><textarea id="txtcomplaintRemarks14" class="form-control" style="height:36px;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint'+_newTrid+'" onclick="AddComplaint('+_newTrid+')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint'+_newTrid+'" onclick="DeleteComplaint('+_newTrid+');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnalreadyProcedurecode' + _newTrid + '" class="hdnalreadyProcedurecode" value=""/><input type="hidden" id="hdnalreadyProcedureName' + _newTrid + '" class="hdnalreadyProcedureName" value=""/><input type="text" id="txtProcedure' + _newTrid + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" class="form-control txtProcedure "/></td><td style="white-space:nowrap"><button type="button" id="btnAddProcedure' + _newTrid + '" onclick="AddProcedure(' + _newTrid + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteProcedure' + _newTrid + '" onclick="DeleteProcedure(' + _newTrid + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        $("#tblProcedure tbody").append(Ftrid);
        //BindBrand();
        BindAutoCompleteForProcedure(_newTrid);


    }
    DeleteProcedure = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeleteProcedure" + _rowId).css("disabled", "disabled");
            $("#btnAddProcedure" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }

    AddPersonalHistory = function(_rowId) {
        var _totctr = 0; //btnAddComplaint
        var btnAddComplaint = "#btnAddPersonalHistory" + _rowId;
        $(btnAddComplaint).css('display', 'none');
        $("#tblPersonalHistory tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="td'+_newTrid+'"><td>'+_newTrid+'</td><td><select id="ddlBrand'+_newTrid+'" style="width: 100px;" class="form-control ddlBrand"><option></option></select></td><td><input type="text" class="form-control txDosageForm" id="txDosageForm'+_newTrid+'" /></td><td><select style="width: 140px;" id="ddlStrength'+_newTrid+'" class="form-control ddlStrength"><option value="0">-- Select --</option></select></td><td><select style="width: 140px;" id="ddlDosages'+_newTrid+'" class="form-control ddlDosages"></select></td><td><select id="ddlDosagesComment'+_newTrid+'" style="width: 100px;" class="form-control ddlDosagesComment"><option value="0">-- Select --</option></select></td><td><input type="text" style="width: 120px;" id="txtDuration'+_newTrid+'" class="form-control txtDuration" /></td><td><select style="width: 120px;" id="ddlGrdBrandUnit'+_newTrid+'" class="form-control ddlGrdBrandUnit"><option value="0">-- Select --</option><option value="1">Minute(s)</option><option value="2">Hour(s)</option><option value="3">Day(s)</option><option value="4">Week(s)</option><option value="5">Month(s)</option><option value="6">Year(s)</option></select></td><td><input type="text" class="form-control txtBrandRemarks" id="txtBrandRemarks" /></td><td style="white-space: nowrap"><button type="button" id="btnGrdBrandUnitAdd'+_newTrid+'" onClick="AddBrand('+_newTrid+')" class="btn btn-info" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnGrdBrandUnitDelete" onClick="DeleteBrand('+_newTrid+')" class="btn btn-danger ml-2" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnPersonalHistoryCode' + _newTrid + '" class="hdnPersonalHistoryCode" value=""/><input type="text" id="txtPersonalHistory' + _newTrid + '" class="form-control txtPersonalHistory" value=""></td><td><input type="text" id="txtPersonalHistorySince' + _newTrid + '" class="form-control txtPersonalHistorySince" style="width:50px;" value=""></td><td><select id="ddlPersonalHistoryUnit' + _newTrid + '" class="form-control ddlPersonalHistoryUnit"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><input type="text" style="width:50px;" id="txtPersonalHistoryQty' + _newTrid + '" class="form-control txtPersonalHistoryQty" value=""></td><td><select id="ddlPersonalHistoryQtyUnit' + _newTrid + '" class="form-control ddlPersonalHistoryQtyUnit"><option value="Days">Days</option><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtPersonalHistoryNotesComment' + _newTrid + '" class="txtPersonalHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddPersonalHistory' + _newTrid + '" onclick="AddPersonalHistory(' + _newTrid + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeletePersonalHistory' + _newTrid + '" onclick="DeletePersonalHistory(' + _newTrid + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        $("#tblPersonalHistory tbody").append(Ftrid);
        BindAutoCompleteForPersonalHistory(_newTrid);
    }
    DeletePersonalHistory = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeletePersonalHistory" + _rowId).css("disabled", "disabled");
            $("#btnAddPersonalHistory" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }

    BindRoom = function () {

        $("#ddlRoomNo").empty();
        $.ajax({
            type: 'POST',
            url: '../Masters/BedOccupancyStatus.aspx/GetRoomList',
            async: false,
            cache: false,
            data: "{'DERPARTMENT_CODE':'" + $("#ddlDepartment").val() + "','WARD_CODE':'" + $("#ddlWardNo").val() + "','MODULE_CODE':'" + jsModuleCode + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {
            },
            success: function (response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlRoomNo").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#ddlRoomNo").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function (response) {
                alert('Bind Room Failed');
            },
            error: function (response) {
                alert('Bind Room Error');
            }
        });



    }
    BindBedNo = function () {
        debugger;
        $("#txtBedNo").empty("");

        //var _deptCode = $("#ddlDepartment").val();
        //var _wardCode = $("#ddlWardNo").val();
        //var _roomNO = $("#ddlRoomNo").val();
        //var _bedCategoryCode = $("#ddlBedCategory").val();
        var _wardCategoryCode = $("#ddlWardCategory").val();




        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetBedNo',
            async: false,
            cache: true,
            data: "{'WARD_CATEGORY_CODE':'" + _wardCategoryCode + "'}",
            //data: "{'DERPARTMENT_CODE':'" + _deptCode + "','WARD_CODE':'" + _wardCode + "','ROOM_NO':'" + _roomNO + "','BED_CATEGORY_CODE':'" + _bedCategoryCode + "','WARD_CATEGORY_CODE':'" + _wardCategoryCode + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {

            },
            success: function (response) {
               //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#txtBedNo").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#txtBedNo").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function (response) {

                alert('Loading Failed');

            },
            error: function (response) {
                alert('Error');
            }

        });
      }
    BindBedNo_old = function () {
        debugger;
        $("#txtBedNo").empty("");

        var _deptCode = $("#ddlDepartment").val();
        var _wardCode = $("#ddlWardNo").val();
        var _roomNO = $("#ddlRoomNo").val();
        var _bedCategoryCode = $("#ddlBedCategory").val();
        var _wardCategoryCode = $("#ddlWardCategory").val();




        $.ajax({
            type: 'POST',
            url: '../Casualty/PatientTransfer.aspx/GetBedNoTransferDetail',
            async: false,
            cache: true,
            data: "{'DEPARTMENT_CODE':'" + _deptCode + "','WARD_CATEGORY_CODE':'" + _wardCategoryCode + "','WARD_CODE':'" + _wardCode + "','ROOM_CODE':'" + _roomNO + "','BED_CATEGORY_CODE':'" + _bedCategoryCode + "','MODULE_CODE':'" + jsModuleCode + "'}",
            //data: "{'DERPARTMENT_CODE':'" + _deptCode + "','WARD_CODE':'" + _wardCode + "','ROOM_NO':'" + _roomNO + "','BED_CATEGORY_CODE':'" + _bedCategoryCode + "','WARD_CATEGORY_CODE':'" + _wardCategoryCode + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {

            },
            success: function (response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#txtBedNo").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#txtBedNo").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function (response) {

                alert('Loading Failed');

            },
            error: function (response) {
                alert('Error');
            }

        });



    }
    BindWARD = function () {

        //alert('HELLO');
        $("#ddlWardNo").empty("");
        /* Post Data Start */
        $.ajax({
            type: 'POST',
            url: '../Masters/RoomNoN.aspx/GetWard',
            async: false,
            cache: true,
            data: "{'MODULE_CODE':'" + jsModuleCode + "','DEPARTMENT_CODE':'" + $("#ddlDepartment").val() + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {
                // before_loading($('#ddlAppraisalCycle'));
            },
            success: function (response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlWardNo").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#ddlWardNo").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function (response) {
                //alert(response.d);
                alert('Loading Failed');
                // after_loading();
            },
            error: function (response) {
                //alert(response.d);
                alert('Error');
                // after_loading();
            }

        });


    }

    BindWardNo_remove = function() {

        $("#ddlWardNo").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetWardNoList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlWardNo").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlWardNo").append($("<option></option>").val($(this).find("WARD_CODE").text()).html($(this).find("WARD_NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Ward No. Failed');
            },
            error: function(response) {
                alert('Bind Ward No. Error');
            }
        });
    }  //  BIND WARD NO. FUNCTION ENDING

    BindWardCategory = function() {

        $("#ddlWardCategory").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetWardCategory',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlWardCategory").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlWardCategory").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Ward Category Failed');
            },
            error: function(response) {
                alert('Bind Ward Category Error');
            }
        });
    }  //  BIND WARD NO. FUNCTION ENDING

    BindBedCategory = function() {

        $("#ddlBedCategory").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetBedCategory',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlBedCategory").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlBedCategory").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Bed Category Failed');
            },
            error: function(response) {
                alert('Bind Bed Category Error');
            }
        });
    }  //  BIND WARD NO. FUNCTION ENDING

    BindPayer = function() {

        $("#ddlPayer").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/PayerDetails',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlPayer").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlPayer").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Bed Category Failed');
            },
            error: function(response) {
                alert('Bind Bed Category Error');
            }
        });
    }  //  BIND WARD NO. FUNCTION ENDING





    BindOccupation = function() {

        $("#ddlOccupation").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetOccupationList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {

                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlOccupation").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlOccupation").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Occupation Failed');
            },
            error: function(response) {
                alert('Bind Occupation Error');
            }
        });
    }  // BIND OCCUPATION FUNCTION ENDING


    BindRelation = function() {

        $("#ddlRelation").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetRelationList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {

                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlRelation").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlRelation").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Relation Failed');
            },
            error: function(response) {
                alert('Bind Relation Error');
            }
        });
    }  // BIND RELATION FUNCTION ENDING




    BindReligion = function() {

        $("#ddlReligion").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetReligionList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {

                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlReligion").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlReligion").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Religion Failed');
            },
            error: function(response) {
                alert('Bind Religion Error');
            }
        });
    }  //BIND RELIGION FUNCTION ENDING

    BindPatientCategory = function() {

        $("#ddlPatientcategory").empty("");
        $("#ddlPatientcategoryNewPatient").empty("");//#
       // $("#txtPatientCategory").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetPatientCategoryList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {

                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlPatientcategory").append($("<option></option>").val("").html(""));
                $("#ddlPatientcategoryNewPatient").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlPatientcategory").append($("<option></option>").val($(this).find("PATIENT_CATEGORY_CODE").text()).html($(this).find("PATIENT_CATEGORY_NAME").text()));
                    $("#ddlPatientcategoryNewPatient").append($("<option></option>").val($(this).find("PATIENT_CATEGORY_CODE").text()).html($(this).find("PATIENT_CATEGORY_NAME").text()));

                });
            },
            failure: function(response) {
                alert('Bind Patient Category Failed');
            },
            error: function(response) {
                alert('Bind Patient Category Error');
            }
        });
    }  //BIND PATIENT CATEGORY FUNCTION ENDING


    BindRoomNo = function(_DepartmentId) {

        $("#ddlRoomNo").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetRoomNoList',
            async: false,
            cache: true,
            data: "{'DEPARTMENT_CODE':'" + _DepartmentId + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function (response) {
                alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlRoomNo").removeAttr("disabled");
                $("#ddlRoomNo").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlRoomNo").append($("<option></option>").val($(this).find("ROOM_CODE").text()).html($(this).find("ROOM_NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind RoomNo. Failed');
            },
            error: function(response) {
                alert('Bind RoomNo. Error');
            }
        });
    }  // BIND ROOMNO. FUNCTION ENDING

    BindDoctor = function(_DepartmentId) {
        var _department = $("#ddlDepartment").val();
        var _speciality='';
        $("#txtDoctor").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/SearchDRDeptWise',
            async: false,
            cache: true,
            data: "{'DEPT_CODE':'" + _DepartmentId + "','SPECIALITY':'" + _speciality + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#txtDoctor").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#txtDoctor").append($("<option></option>").val($(this).find("DOCTOR_CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Doctor Failed');
            },
            error: function(response) {
                alert('Bind Doctor Error');
            }
        });

    } // BIND DEPARTMENT FUNCTION ENDING
    
    BindSurgeon = function(_DepartmentId) {
        var _department = $("#ddlDepartment").val();
        var _speciality='Surgeon';
        $("#ddlSurgeon").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/SearchDRDeptWise',
            async: false,
            cache: true,
            data: "{'DEPT_CODE':'" + _DepartmentId + "','SPECIALITY':'" + _speciality + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlSurgeon").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlSurgeon").append($("<option></option>").val($(this).find("DOCTOR_CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Surgeon Failed');
            },
            error: function(response) {
                alert('Bind Surgeon Error');
            }
        });

    } // BIND SURGEON FUNCTION ENDING
    
    BindAnesthetist = function(_DepartmentId) {
        var _department = $("#ddlDepartment").val();
        var _speciality='Anesthetist';
        $("#ddlAnesthetist").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/SearchDRDeptWise',
            async: false,
            cache: true,
            data: "{'DEPT_CODE':'" + _DepartmentId + "','SPECIALITY':'" + _speciality + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlAnesthetist").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlAnesthetist").append($("<option></option>").val($(this).find("DOCTOR_CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Anesthetist Failed');
            },
            error: function(response) {
                alert('Bind Anesthetist Error');
            }
        });

    } // BIND BindAnesthetist FUNCTION ENDING


    BindDepartment = function () {
        $("#ddlDepartment").empty("");
        $("#ddlDepartmentPop").empty("");
        /* Post Data Start */
        $.ajax({
            type: 'POST',
            url: '../Masters/WardN.aspx/GetDepartment',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {
                // before_loading($('#ddlAppraisalCycle'));
            },
            success: function (response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlDepartment").append($("<option></option>").val("").html(""));
                $("#ddlDepartmentPop").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#ddlDepartment").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                    $("#ddlDepartmentPop").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function (response) {
                //alert(response.d);
                alert('Loading Failed');
                // after_loading();
            },
            error: function (response) {
                //alert(response.d);
                alert('Error');
                // after_loading();
            }

        });
        /* Post Data End*/

    }

    BindDepartment_Remove = function() {

        $("#ddlDepartment").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetDepartmentList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlDepartment").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlDepartment").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Department Failed');
            },
            error: function(response) {
                alert('Bind Department Error');
            }
        });

    } // BIND DEPARTMENT FUNCTION ENDING


    BindLocality = function() {

        $("#ddlLocality").empty("");
        $("#ddlNewLocalityPop").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetLocalityList',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) {
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlLocality").append($("<option></option>").val("").html(""));
                $("#ddlNewLocalityPop").append($("<option></option>").val("").html(""));
                $.each(items, function(index) {
                    $("#ddlLocality").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                    $("#ddlNewLocalityPop").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function(response) {
                alert('Bind Locality Failed');
            },
            error: function(response) {
                alert('Bind Locality Error');
            }

        });
    } // BIND LOCALITY FUNCTION ENDING


    BindDefaultServiceGrid = function() {
        //debugger;
        // alert('welcome page');
        var _patientcategory = $("#ddlPatientcategory option:selected").text();
        //alert(_patientcategory);
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/DefaultServiceRecord',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            cache: false,
            async: false,

            data: "{'PATIENT_CATEGORY':'" + _patientcategory + "'}",
            beforeSend: function() {
            },
            success: function(response) {
                //alert(response.d);

                var xmlDoc = $.parseXML(response.d);
                table = $('<table id="tblPanelSearch" style="font-family:Calibri;width:100%" class="table table-bordered table-hover" ></table>');
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                var row = '';
                var count = 0;
                var trid = 1;
                S_id=1;
                var _FAmount = 0;


                $.each(items, function(index) {
                    if (parseInt(count) == 0) {
                        var rowheader = '<thead><tr >'; ;
                        //var rowheader = '<tr style="font-size:15px">';
                        rowheader += '<th style="font-size:15px;width:auto;white-space:nowrap;">Service Name</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">Charges</th>';

                        rowheader += '<th style="white-space:nowrap;font-size:12px">Disc %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">Cash Disc %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">IGST %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">CGST %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">SGST %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">Misc Tax %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">Misc Charges %</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">Net Amount</th>';
                        rowheader += '<th style="white-space:nowrap;font-size:12px">Action</th>';

                        rowheader += '</thead></tr>';

                        table.append(rowheader);
                    }
                    var rowcol = '';

                    rowcol += '<tbody><tr id="tr' + trid + '">';
                    rowcol += '<td style="white-space:nowrap; width:100px;"><input type="hidden" class="hdnServiceName" id="hdnServiceName' + trid + '" value="' + $(this).find("SERVICE_NAME").text() + '">' + $(this).find("SERVICE_NAME").text() + '</td>';
                    rowcol += '<td style="display:none;"><input type="hidden" class="hdnServiceCode" id="hdnServiceCode' + trid + '" value="' + $(this).find("SERVICE_CODE").text() + '">' + $(this).find("SERVICE_CODE").text() + '</td>';
                    rowcol += '<td><input type="text" style="width:90px;text-align:right" onChange="CalculateRowAmount(' + trid + ')" id="txtcharges' + trid + '" class="form-control txtcharges" placeholder="Charges" value="' + $(this).find("PRICE_OPD_CHARGE").text() + '"></td>';
                    rowcol += '<td><input type="text" style="width:90px;text-align:right" onChange="CalculateRowAmount(' + trid + ')" id="txtDisc' + trid + '" class="form-control txtDisc" placeholder="Discount" value="0"></td>';
                    rowcol += '<td><input type="text"  style="width:90px;text-align:right" id="txtCashDisc' + trid + '" onChange="CalculateRowAmount(' + trid + ')" class="form-control txtCashDisc" placeholder="Cash Discount" value="0"></td>';
                    rowcol += '<td><input type="text" style="width:90px;text-align:right" id="txtIGST' + trid + '" class="form-control txtIGST" onChange="CalculateRowAmount(' + trid + ')" placeholder="IGST" value="0"></td>';
                    rowcol += '<td><input type="text" style="width:90px;text-align:right" onChange="CalculateRowAmount(' + trid + ')" id="txtCGST' + trid + '" class="form-control txtCGST" placeholder="CGST" value="0"></td>';
                    rowcol += '<td><input type="text" style="width:90px;text-align:right" onChange="CalculateRowAmount(' + trid + ')" id="txtSGST' + trid + '" class="form-control txtSGST" placeholder="SGST" value="0"></td>';
                    rowcol += '<td><input type="text" style="width:90px;text-align:right" onChange="CalculateRowAmount(' + trid + ')" id="txtMiscTax' + trid + '" class="form-control txtMiscTax" placeholder="Misc Tax" value="0"></td>';
                    rowcol += '<td><input type="text" onChange="CalculateRowAmount(' + trid + ')" style="width:120px;text-align:right" id="txtMiscCharges' + trid + '" class="form-control txtMiscCharges" placeholder="Misc Charges" value="0"></td>';
                    rowcol += '<td><span style="color:blue;font-weight:bold;text-align:right;" class="spnNetAmt" id="spnNetAmt' + trid + '">' + $(this).find("PRICE_OPD_CHARGE").text() + '</span></td>';
                    rowcol += '<td><button type="button" class="btn btn-danger" onclick="DeleteDosageRow1(' + trid + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td>';

                    rowcol += '</tr></tbody>';
                    table.append(rowcol);
                    _FAmount = parseInt(_FAmount) + parseInt($(this).find("PRICE_OPD_CHARGE").text());
                   // alert($(this).find("SERVICE_CODE").text());

                    $('#divDRService').html(table);
                    count += 1;
                    trid += 1;
                    S_id += 1;


                }); //end each function
                if (parseInt(count) == 0) {
                    var rowcol = '';
                    rowcol += '<tbody><tr><td colspan="7" style="font-weight:bold;"><i class="fa fa-exclamation-triangle" style="font-size:24px;color:red;"></i>&nbsp;&nbsp;No Service Available for selected Doctor !</td></tr>';
                    table.append(rowcol);
                    $('#divDRService').html(table);
                    $('#txtAmount').val(0);
                }
                else {

                    $('#divDRService').html(table); //txtNetAmount
                    $('#txtAmount').val(_FAmount);
                    $('#txtNetAmount').val(_FAmount);
                    $("#fldConsultationServices").css("display", "");
                }

            },

            failure: function(response) {
                alert('Searching Failed');
            },
            error: function(response) {
                alert('Searching Error');
            }
        });
    }

    //onchange
    CalculateRowAmount = function(_qty) {
        // alert('coming with trid = '+_qty);
        debugger;
        var qty = 0, _freeqty = 0, _prate = 0, _disc = 0, _cash_disc = 0, _igst = 0, _cgst = 0, _sgst = 0, _miscTax = 0, _miscCharges = 0;
        var txtCharges = $("#txtcharges" + _qty).val();



        var _totqty = 1; //+parseInt(txtfreeQtyN);
        var amt = parseInt(txtCharges);
        //POQty
        $("#txtcharges" + _qty).val(amt);
        var spnAmount = $("#txtcharges" + _qty).val();

        var spnNetAmt = $("#spnNetAmt" + _qty).text();

        //        $("#spnPoQty"+_qty).text(_totqty);
        //var POQty=$("#POQty"+_qty).text(parseInt(txtQtyN)+parseInt(txtfreeQtyN));

        var txtDisc = $("#txtDisc" + _qty).val();
        var txtCashDisc = $("#txtCashDisc" + _qty).val();
        var txtIGST = $("#txtIGST" + _qty).val();
        var txtCGST = $("#txtCGST" + _qty).val();
        var txtSGST = $("#txtSGST" + _qty).val();
        var txtMiscTax = $("#txtMiscTax" + _qty).val();
        var txtMiscCharges = $("#txtMiscCharges" + _qty).val();


        if (txtDisc != "0") {
            //netAmt = amt-disN_Per; 
            _disc = parseFloat(amt) * parseFloat(txtDisc / 100);

        }
        if (txtCashDisc != "0") {
            _cash_disc = parseFloat(amt) * parseFloat(txtCashDisc / 100);
        }
        if (txtIGST != "0") {
            _igst = parseFloat(amt) * parseFloat(txtIGST / 100);
        }
        if (txtCGST != "0") {
            _cgst = parseFloat(amt) * parseFloat(txtCGST / 100);
        }
        if (txtSGST != "0") {
            _sgst = parseFloat(amt) * parseFloat(txtSGST / 100);
        }
        if (txtMiscTax != "0") {
            _miscTax = parseFloat(amt) * parseFloat(txtMiscTax / 100);
        }
        if (txtMiscCharges != "0") {
            _miscCharges = parseFloat(amt) * parseFloat(txtMiscCharges / 100);
        }

        var _fdiscount = parseFloat(_disc) + parseFloat(_cash_disc);
        var _calNetAmt = parseFloat(amt) + parseFloat(_igst) + parseFloat(_cgst) + parseFloat(_sgst) + parseFloat(_miscTax) + parseFloat(_miscCharges) - parseFloat(_fdiscount);
        $("#spnNetAmt" + _qty).text(_calNetAmt);


        var _calNetAmtafterdisc = 0; //this is holding net amount after discount
        var _calAmtafterdisc = 0; ///spnAmount this is holding total amount of services
        $('#tblPanelSearch tr').not(':first').each(function() {
            _calNetAmtafterdisc += parseFloat($(this).find('.spnNetAmt').text());
            _calAmtafterdisc += parseFloat($(this).find('.txtcharges').val());

        });


        $("#txtAmount").val(_calAmtafterdisc);



        var _totNetAmt = 0; var _totDiscAmount = 0; var _totcashDiscAmount = 0; var _totigstAmount = 0; var _totcgstAmount = 0;
        var _totsgstAmount = 0; var _totmiscTaxAmount = 0; var _totmiscChargeAmount = 0;
        var _isCaltaxAmt = 0; var _totaltaxableAmt = 0; var _finaltaxableAmt = 0;

        $('#tblPanelSearch tr').not(':first').each(function() {
            _totNetAmt += parseFloat($(this).find('.spnNetAmt').text());
            var _discNo = parseFloat($(this).find('.txtDisc').val());
            _isCaltaxAmt = 0;
            var _cashdiscNo = parseFloat($(this).find('.txtCashDisc').val());
            var _igstNo = parseFloat($(this).find('.txtIGST').val());
            var _cgstNo = parseFloat($(this).find('.txtCGST').val());
            var _sgstNo = parseFloat($(this).find('.txtSGST').val());
            var _miscTaxNo = parseFloat($(this).find('.txtMiscTax').val());
            var _miscChargeNo = parseFloat($(this).find('.txtMiscCharges').val());

            if (_discNo != "" || _discNo != "0.00" || _discNo != "0") {
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_discNo) / 100;
                _totDiscAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (_cashdiscNo != "" || _cashdiscNo != "0.00" || _cashdiscNo != "0") {
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_cashdiscNo) / 100;
                _totcashDiscAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (_igstNo != "" || _igstNo != "0.00" || _igstNo != "0") {
                _isCaltaxAmt++;
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_igstNo) / 100;
                _totigstAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (_cgstNo != "" || _cgstNo != "0.00" || _cgstNo != "0") {
                _isCaltaxAmt++;
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_cgstNo) / 100;
                _totcgstAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (_sgstNo != "" || _sgstNo != "0.00" || _sgstNo != "0") {
                _isCaltaxAmt++;
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_sgstNo) / 100;
                _totsgstAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (_miscTaxNo != "" || _miscTaxNo != "0.00" || _miscTaxNo != "0") {
                _isCaltaxAmt++;
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_miscTaxNo) / 100;
                _totmiscTaxAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (_miscChargeNo != "" || _miscChargeNo != "0.00" || _miscChargeNo != "0") {
                _isCaltaxAmt++;
                var _amts = $(this).find('.txtcharges').val();
                var _peramounts = parseFloat(_miscChargeNo) / 100;
                _totmiscChargeAmount += parseFloat(_amts) * parseFloat(_peramounts);
            }
            if (parseInt(_isCaltaxAmt) != 0) {
                _totaltaxableAmt += parseFloat($(this).find('.txtcharges').val());
            }
            //  alert("total discount amount = "+_totDiscAmount);


        });
        $("#txtDiscount").val(_totDiscAmount); //
        $("#txtTaxableAmount").val(_totaltaxableAmt); //
        $("#txtSplDiscount").val(_totcashDiscAmount);
        var _totTaxAmountNo = parseFloat(_totigstAmount) + parseFloat(_totcgstAmount) + parseFloat(_totsgstAmount) + parseFloat(_totmiscTaxAmount) + parseFloat(_totmiscChargeAmount);
        $("#txtTaxAmount").val(_totTaxAmountNo);

        var _paidAmt = 0; var _other_charges = 0; var _invDisc = 0;
        //            if($("#txtPaidAmt").val()!="")
        //            {
        //                _paidAmt=$("#txtPaidAmt").val();
        //            }
        if ($("#txtOtherChargesAmount").val() != "") {
            _other_charges = $("#txtOtherChargesAmount").val();
        }
        if ($("#txtInvoiceDiscAmount").val() != "") {
            _invDisc = $("#txtInvoiceDiscAmount").val();
        }
        // alert('_calNetAmtafterdisc'+_calNetAmtafterdisc);
        // _calAmtafterdisc
        //$("#txtBalanceAmount").val(parseFloat(_calNetAmtafterdisc)+parseFloat(_other_charges)-parseFloat(_invDisc)-parseFloat(_paidAmt));
        var _f_net_amt_disc = parseFloat(_calNetAmtafterdisc) + parseFloat(_other_charges) - parseFloat(_invDisc);
        //var _f_net_amt=_calAmtafterdisc-_f_net_amt_disc;
        // alert('_f_net_amt_disc'+_f_net_amt_disc);
        //$("#txtNetAmount").val(_f_net_amt.toFixed(2)); 
        $("#txtNetAmount").val(_f_net_amt_disc.toFixed(2));

        //txtNetAmount

        //if()



    }
    ChangeCharges = function(_serviceCode) {
        //alert(_serviceCode);
        var txtCharges = "#txtcharges" + _serviceCode;
        $("#txtAmount").val($(txtCharges).val());
        $('#txtNetAmount').val($(txtCharges).val());



        //        $("#txtInvoiceDiscount").val(0);
        //            var str=$("#txtInvoiceDiscAmount").val();                      
        var _amount = $("#txtAmount").val();

        var _Netamount = parseFloat(_amount) - parseFloat(str);
        //$("#txtNetAmount").val(_Netamount);
        var _paidAmt = 0; var _other_charges = 0;
        if ($("#txtPaidAmt").val() != "") {
            _paidAmt = $("#txtPaidAmt").val();
        }

        if ($("#txtOtherChargesAmount").val() != "") {
            _other_charges = $("#txtOtherChargesAmount").val();
        }


        $("#txtBalanceAmount").val(parseFloat(_Netamount) + parseFloat(_other_charges) - parseFloat(_paidAmt));
        $("#txtNetAmount").val(parseFloat(_Netamount) + parseFloat(_other_charges));


    }
    CalculatePaidAmount = function() {
        if ($("#txtNetAmount").val() == "" || $("#txtNetAmount").val() == "0") {
            $("#divErrorMsg").css("display", "block");
            $("#spnerrormsg").text("Net Amount can not be zero or blank !");
            $("#divErrorMsg").delay(3200).fadeOut(300);
            $(window).scrollTop(0);
            return false;
        }
        else {
            var _balanceamount = parseFloat($("#txtNetAmount").val()) - parseFloat($("#txtPaidAmt").val());
            $("#txtBalanceAmount").val(_balanceamount);
        }
    }
    CalculateOtherChargesPercent = function() {

        var str = $("#txtOtherChargesPercent").val();
        var res = str.substring(str.length, str.length - 1);

        var _amount = $("#txtAmount").val();
        //             $('#tblItem tr').not(':first').each(function () {
        //                _amount+=parseFloat($(this).find('.spnNetAmt').text());
        //             });
        var _discount = $("#txtOtherChargesPercent").val().trim();
        var _peramount = parseFloat(_discount) / 100;
        var _result = parseFloat(_amount) * parseFloat(_peramount);
        //alert($("#txtAmount").val());
        $("#txtOtherChargesAmount").val(_result);
        var _Netamount = parseFloat(_amount) + parseFloat(_result);
        //$("#txtNetAmount").val(_Netamount);
        var _paidAmt = 0; var _inv_amt = 0;
        if ($("#txtPaidAmt").val() != "") {
            _paidAmt = $("#txtPaidAmt").val();
        }
        if ($("#txtInvoiceDiscAmount").val() != "") {
            _inv_amt = $("#txtInvoiceDiscAmount").val();
        }
        $("#txtBalanceAmount").val(parseFloat(_Netamount) - parseFloat(_inv_amt) - parseFloat(_paidAmt));
        $("#txtNetAmount").val(parseFloat(_Netamount) - parseFloat(_inv_amt));
        //var resul txtBalanceAmount
        //        }        


    }
    CalculateOtherCharges = function() {
        $("#txtOtherChargesPercent").val(0);
        var str = $("#txtOtherChargesAmount").val();
        var _amount = $("#txtAmount").val();
        //             $('#tblItem tr').not(':first').each(function () {
        //                _amount+=parseFloat($(this).find('.spnNetAmt').text());
        //             });                       
        var _Netamount = parseFloat(_amount) + parseFloat(str);

        var _paidAmt = 0; var _inv_amt = 0;
        if ($("#txtPaidAmt").val() != "") {
            _paidAmt = $("#txtPaidAmt").val();
        }
        if ($("#txtInvoiceDiscAmount").val() != "") {
            _inv_amt = $("#txtInvoiceDiscAmount").val();
        }
        $("#txtBalanceAmount").val(parseFloat(_Netamount) - parseFloat(_inv_amt) - parseFloat(_paidAmt));
        $("#txtNetAmount").val(parseFloat(_Netamount) - parseFloat(_inv_amt));

    }
    CalculateInvoiceDiscountPercent = function() {

        var str = $("#txtInvoiceDiscount").val();
        var res = str.substring(str.length, str.length - 1);
        //        if(res=="%")
        //        {
        //var _amount=$("#txtNetAmount").val()//txtAmount;
        var _amount = $("#txtAmount").val();
        //             $('#tblItem tr').not(':first').each(function () {
        //                _amount+=parseFloat($(this).find('.spnNetAmt').text());
        //             });
        var _discount = $("#txtInvoiceDiscount").val().trim();
        var _peramount = parseFloat(_discount) / 100;
        var _result = parseFloat(_amount).toFixed(2) * parseFloat(_peramount).toFixed(2);
        //alert($("#txtAmount").val());
        $("#txtInvoiceDiscAmount").val(_result.toFixed(2));

        var _Netamount = parseFloat(_amount) - parseFloat(_result);
        //$("#txtNetAmount").val(_Netamount);
        var _paidAmt = 0; var _other_charges = 0;
        if ($("#txtPaidAmt").val() != "") {
            _paidAmt = $("#txtPaidAmt").val();
        }
        if ($("#txtOtherChargesAmount").val() != "") {
            _other_charges = $("#txtOtherChargesAmount").val();
        }
        $("#txtBalanceAmount").val(parseFloat(_Netamount) + parseFloat(_other_charges) - parseFloat(_paidAmt));
        $("#txtNetAmount").val(parseFloat(_Netamount) + parseFloat(_other_charges));
        //var resul txtBalanceAmount
        //        }        


    }
    CalculateInvoiceDiscount = function() {
        $("#txtInvoiceDiscount").val(0);
        var str = $("#txtInvoiceDiscAmount").val();
        var _amount = $("#txtAmount").val();
        //             $('#tblItem tr').not(':first').each(function () {
        //                _amount+=parseFloat($(this).find('.spnNetAmt').text());
        //             });                      
        var _Netamount = parseFloat(_amount) - parseFloat(str);
        //$("#txtNetAmount").val(_Netamount);
        var _paidAmt = 0; var _other_charges = 0;
        if ($("#txtPaidAmt").val() != "") {
            _paidAmt = $("#txtPaidAmt").val();
        }

        if ($("#txtOtherChargesAmount").val() != "") {
            _other_charges = $("#txtOtherChargesAmount").val();
        }


        $("#txtBalanceAmount").val(parseFloat(_Netamount) + parseFloat(_other_charges) - parseFloat(_paidAmt));
        $("#txtNetAmount").val(parseFloat(_Netamount) + parseFloat(_other_charges));
    }

    BindAutoCompleteForAllergy = function(_controllId) {

        //alert(_controllId);
        //debugger;
        var _txtcontrol = "#txtAllergy" + _controllId;
        var _txtAllergyType = "#txtAllergyType" + _controllId;
        var _Hdncontrol = "#hdnAllergyCode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForAllergy",
                    data: "{'ALERGY_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                //alert(item.split('/')[1]);
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1],
                                    allergy: item.split('|')[2]

                                }
                                // alert(ui.item.split('/')[2])
                                // $(_txtAllergyType).val(item.split('/')[2])
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },

            focus: function(event, ui) {
                // alert(ui.item.allergy);
                // prevent value inserted on focus
                $(_txtcontrol).val(ui.item.label);
                $(_Hdncontrol).val(ui.item.val);
                $(_txtAllergyType).val(ui.item.allergy);
                $(_txtcontrol).attr('title', ui.item.label);
                return false;
            },
            select: function(event, ui) {

                if (ui.item.val == -1) {
                    return false;
                }
                //$(txtAllergyType).val(ui.item.allergy);
                //alert(ui.item.split('/')[2]);
                $(_Hdncontrol).val(ui.item.val);


            }
        });

    }
    BindAutoCompleteForDisease = function(_controllId) {


        debugger;
        var _txtcontrol = "#txtDisease" + _controllId;
        var _Hdncontrol = "#hdnDiseaseCode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForDisease",
                    data: "{'DISEASE_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1]
                                }
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },
            focus: function(event, ui) {
                $(_txtcontrol).val(ui.item.label);
                $(_txtcontrol).attr('title', ui.item.label);
            },
            select: function(event, ui) {
                if (ui.item.val == -1) {
                    return false;
                }
                $(_Hdncontrol).val(ui.item.val);
            }
        });

    }
    BindAutoCompleteForFamilyHistory = function(_controllId) {
        debugger;
        var _txtcontrol = "#txtFamilyHistory" + _controllId;
        var _txtAllergyType = "#txtFamilyHistoryType" + _controllId;
        var _Hdncontrol = "#hdnFamilyHistoryCode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForFamilyHistory",
                    data: "{'HISTORY_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        //alert(data.d);
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                //alert(item.split('/')[1]);
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1],
                                    pasthistory: item.split('|')[2]

                                }
                                // alert(ui.item.split('/')[2])
                                // $(_txtAllergyType).val(item.split('/')[2])
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },

            focus: function(event, ui) {
                // alert(ui.item.allergy);
                // prevent value inserted on focus
                $(_txtcontrol).val(ui.item.label);
                $(_Hdncontrol).val(ui.item.val);
                $(_txtAllergyType).val(ui.item.pasthistory);
                $(_txtcontrol).attr('title', ui.item.label);
                return false;
            },
            select: function(event, ui) {

                if (ui.item.val == -1) {
                    return false;
                }
                //$(txtAllergyType).val(ui.item.allergy);
                //alert(ui.item.split('/')[2]);
                $(_Hdncontrol).val(ui.item.val);


            }
        });
    }
    AddFamilyHistory = function(_rowId) {
        var _totctr = 0; //btnAddComplaint
        var btnAddComplaint = "#btnAddFamilyHistory" + _rowId;
        $(btnAddComplaint).css('display', 'none');
        $("#tblFamilyHistory tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="td'+_newTrid+'"><td>'+_newTrid+'</td><td><select id="ddlBrand'+_newTrid+'" style="width: 100px;" class="form-control ddlBrand"><option></option></select></td><td><input type="text" class="form-control txDosageForm" id="txDosageForm'+_newTrid+'" /></td><td><select style="width: 140px;" id="ddlStrength'+_newTrid+'" class="form-control ddlStrength"><option value="0">-- Select --</option></select></td><td><select style="width: 140px;" id="ddlDosages'+_newTrid+'" class="form-control ddlDosages"></select></td><td><select id="ddlDosagesComment'+_newTrid+'" style="width: 100px;" class="form-control ddlDosagesComment"><option value="0">-- Select --</option></select></td><td><input type="text" style="width: 120px;" id="txtDuration'+_newTrid+'" class="form-control txtDuration" /></td><td><select style="width: 120px;" id="ddlGrdBrandUnit'+_newTrid+'" class="form-control ddlGrdBrandUnit"><option value="0">-- Select --</option><option value="1">Minute(s)</option><option value="2">Hour(s)</option><option value="3">Day(s)</option><option value="4">Week(s)</option><option value="5">Month(s)</option><option value="6">Year(s)</option></select></td><td><input type="text" class="form-control txtBrandRemarks" id="txtBrandRemarks" /></td><td style="white-space: nowrap"><button type="button" id="btnGrdBrandUnitAdd'+_newTrid+'" onClick="AddBrand('+_newTrid+')" class="btn btn-info" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnGrdBrandUnitDelete" onClick="DeleteBrand('+_newTrid+')" class="btn btn-danger ml-2" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnFamilyHistoryCode' + _newTrid + '" class="hdnFamilyHistoryCode" value=""/><input type="text" id="txtFamilyHistory' + _newTrid + '" class="form-control txtFamilyHistory" value=""></td><td><input type="text" id="txtFamilyHistoryType' + _newTrid + '" class="form-control txtFamilyHistoryType" style="width:50px;" value=""></td><td><input type="text" id="txtFamilyHistorySince' + _newTrid + '" class="form-control txtFamilyHistorySince" style="width:50px;" value=""></td><td><select id="ddlFamilyHistoryUnit' + _newTrid + '" class="form-control ddlFamilyHistoryUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><select style="width:200px;font-family:calibri" id="ddlFamilyHistoryRelation' + _newTrid + '" class="form-control ddlFamilyHistoryRelation"><option value=""></option><option value="Borther">Borther</option><option value="Sister">Sister</option><option value="Father">Father</option><option value="Mother">Mother</option><option value="Cousin">Cousin</option><option value="Nephew">Nephew</option><option value="Grandfather">Grandfather</option><option value="Grandmother">Grandmother</option><option value="Niece">Niece</option><option value="Great Grandmother">Great Grandmother</option><option value="Great Grandfather">Great Grandfather</option><option value="Uncle">Uncle</option><option value="Aunt">Aunt</option><option value="Maternal Uncle">Maternal Uncle</option><option value="Maternal Aunt">Maternal Aunt</option><option value="Daughter-in-law">Daughter-in-law</option><option value="Son-in-law">Son-in-law</option><option value=="Brother-in-law">Brother-in-law</option><option value="Sister-in-law">Sister-in-law</option><select></td><td><textarea style="font-family:calibri;" id="txtFamilyHistoryNotesComment' + _newTrid + '" class="txtFamilyHistoryNotesComment" value=""></textarea></td><td align="center" style="white-space:nowrap;"><button type="button" id="btnAddFamilyHistory' + _newTrid + '" onclick="AddFamilyHistory(' + _newTrid + ')" class="btn btn-primary" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnDeleteFamilyHistory' + _newTrid + '" onclick="DeleteFamilyHistory(' + _newTrid + ')" class="btn btn-danger ml-2" style="font-family: Calibri; font-size: 12px; height: 30px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        $("#tblFamilyHistory tbody").append(Ftrid);
        BindAutoCompleteForFamilyHistory(_newTrid);
    }
    DeleteFamilyHistory = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeleteFamilyHistory" + _rowId).css("disabled", "disabled");
            $("#btnAddFamilyHistory" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }
    AddComplaint = function(_rowId) {

        var _totctr = 0; //btnAddComplaint
        var btnAddComplaint = "#btnAddComplaint" + _rowId;
        $(btnAddComplaint).css('display', 'none');
        $("#tblComplaintN tr").not(':first').each(function() {
            _totctr++;
        });
        var _newTrid = parseInt(_totctr) + 1;
        //var Ftrid='<tr id="td'+_newTrid+'"><td>'+_newTrid+'</td><td><select id="ddlBrand'+_newTrid+'" style="width: 100px;" class="form-control ddlBrand"><option></option></select></td><td><input type="text" class="form-control txDosageForm" id="txDosageForm'+_newTrid+'" /></td><td><select style="width: 140px;" id="ddlStrength'+_newTrid+'" class="form-control ddlStrength"><option value="0">-- Select --</option></select></td><td><select style="width: 140px;" id="ddlDosages'+_newTrid+'" class="form-control ddlDosages"></select></td><td><select id="ddlDosagesComment'+_newTrid+'" style="width: 100px;" class="form-control ddlDosagesComment"><option value="0">-- Select --</option></select></td><td><input type="text" style="width: 120px;" id="txtDuration'+_newTrid+'" class="form-control txtDuration" /></td><td><select style="width: 120px;" id="ddlGrdBrandUnit'+_newTrid+'" class="form-control ddlGrdBrandUnit"><option value="0">-- Select --</option><option value="1">Minute(s)</option><option value="2">Hour(s)</option><option value="3">Day(s)</option><option value="4">Week(s)</option><option value="5">Month(s)</option><option value="6">Year(s)</option></select></td><td><input type="text" class="form-control txtBrandRemarks" id="txtBrandRemarks" /></td><td style="white-space: nowrap"><button type="button" id="btnGrdBrandUnitAdd'+_newTrid+'" onClick="AddBrand('+_newTrid+')" class="btn btn-info" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-plus" aria-hidden="true"></i></button><button type="button" id="btnGrdBrandUnitDelete" onClick="DeleteBrand('+_newTrid+')" class="btn btn-danger ml-2" style="font-family: Calibri;font-size: 12px;"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></td></tr>';
        var Ftrid = '<tr id="tr' + _newTrid + '"><td style=""><input type="hidden" id="hdnComplaintCode' + _newTrid + '" class="hdnComplaintCode" value=""/><input type="text" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;" id="txtComplaint' + _newTrid + '" class="form-control txtComplaint"/></td><td><input type="text" id="txtReportedComplaintSince' + _newTrid + '" style="font-family:Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;font-size:12px;width:50px;" class="form-control txtReportedComplaintSince"/></td><td><select id="ddlReportedComplaintUnit' + _newTrid + '" class="form-control ddlReportedComplaintUnit" style="font-family:calibri"><option value="Days">Days</option><option value="Days">Days</option><option value="Week">Week</option><option value="Month">Month</option><option value="Year">Year</option><select></td><td><textarea id="txtcomplaintRemarks' + _newTrid + '" class="form-control txtcomplaintRemarks" style="height:45px;"/></td><td style="white-space:nowrap"><button type="button" id="btnAddComplaint' + _newTrid + '" onclick="AddComplaint(' + _newTrid + ')" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i></button>&nbsp;<button type="button" class="btn btn-danger" id="btnDeleteComplaint' + _newTrid + '" onclick="DeleteComplaint(' + _newTrid + ');"><i class="fa fa-trash" aria-hidden="true"></i></button></td></tr>';
        $("#tblComplaintN tbody").append(Ftrid);
        //BindBrand();
        BindAutoCompleteForComplaint(_newTrid);


    }
    DeleteComplaint = function(_rowId) {
        if (parseInt(_rowId) == 1) {
            $("#btnDeleteComplaint" + _rowId).css("disabled", "disabled");
            $("#btnAddComplaint" + _rowId).css("display", "");
        }
        else {
            var _deltrId = "#tr" + _rowId;
            $(_deltrId).remove().delay(3200).fadeOut(300);
        }

    }
    BindAutoCompleteForComplaint = function(_controllId) {
        debugger;
        var _txtcontrol = "#txtComplaint" + _controllId;
        var _Hdncontrol = "#hdnComplaintCode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForComplaint",
                    data: "{'COMPLAINT_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1]
                                }
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },
            focus: function(event, ui) {
                $(_txtcontrol).val(ui.item.label);
                $(_txtcontrol).attr('title', ui.item.label);
            },
            select: function(event, ui) {
                if (ui.item.val == -1) {
                    return false;
                }
                $(_Hdncontrol).val(ui.item.val);
            }
        });

    }
    BindAutoCompleteForAdvisedInvestigation = function(_controllId) {


        debugger;
        var _txtcontrol = "#txtAdvisedInvestigation" + _controllId;
        var _Hdncontrol = "#hdnalreadyinvcode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForAdvisedInvestigation",
                    data: "{'INVESTIGATION_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1]
                                }
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },
            focus: function(event, ui) {
                $(_txtcontrol).val(ui.item.label);
                $(_txtcontrol).attr('title', ui.item.label);
            },
            select: function(event, ui) {
                if (ui.item.val == -1) {
                    return false;
                }
                $(_Hdncontrol).val(ui.item.val);
            }
        });

    }
    
   BindAutoCompleteForProcedure= function(_controllId) {


        debugger;
        var _txtcontrol = "#txtProcedure" + _controllId;
        var _Hdncontrol = "#hdnalreadyProcedurecode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForProcedure",
                    data: "{'PROCEDURE_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1]
                                }
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },
            focus: function(event, ui) {
                $(_txtcontrol).val(ui.item.label);
                $(_txtcontrol).attr('title', ui.item.label);
            },
            select: function(event, ui) {
                if (ui.item.val == -1) {
                    return false;
                }
                $(_Hdncontrol).val(ui.item.val);
            }
        });

    }
    
    
    BindAutoCompleteForPersonalHistory = function(_controllId) {
        debugger;
        var _txtcontrol = "#txtPersonalHistory" + _controllId;
        //var _txtAllergyType = "#txtPastHistoryType" + _controllId;
        var _Hdncontrol = "#hdnPersonalHistoryCode" + _controllId;

        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForPersonalHistory",
                    data: "{'PERSONAL_HISTORY_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                        //alert(data.d);
                        if (data.d.length > 0) {
                            response($.map(data.d, function(item) {
                                //alert(item.split('/')[1]);
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1]//,
                                    //pasthistory: item.split('/')[2]

                                }
                                // alert(ui.item.split('/')[2])
                                // $(_txtAllergyType).val(item.split('/')[2])
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },

            focus: function(event, ui) {
                // alert(ui.item.allergy);
                // prevent value inserted on focus
                $(_txtcontrol).val(ui.item.label);
                $(_Hdncontrol).val(ui.item.val);
                $(_txtcontrol).attr('title', ui.item.label);
                // $(_txtAllergyType).val(ui.item.pasthistory);
                return false;
            },
            select: function(event, ui) {

                if (ui.item.val == -1) {
                    return false;
                }
                //$(txtAllergyType).val(ui.item.allergy);
                //alert(ui.item.split('/')[2]);
                $(_Hdncontrol).val(ui.item.val);


            }
        });

    }
    BindAutoCompleteForPastHistory = function(_controllId) {

        //alert(_controllId);
        debugger;
        var _txtcontrol = "#txtPastHistory" + _controllId;
        var _txtAllergyType = "#txtPastHistoryType" + _controllId;
        var _Hdncontrol = "#hdnPastHistoryCode" + _controllId;
     
        $(_txtcontrol).autocomplete({
            minLength: 3,
            source: function(request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "IpdShortStay.aspx/GetAutoCompleteForPastHistory",
                    data: "{'HISTORY_NAME':'" + $(_txtcontrol).val() + "'}",
                    dataType: "json",
                    success: function(data) {
                       
                        if (data.d.length > 0) {
                        debugger;
                            response($.map(data.d, function(item) {
                                //alert(item.split('/')[1]);
                                return {
                                    label: item.split('|')[0],
                                    val: item.split('|')[1],
                                    pasthistory: item.split('|')[2]

                                }
                                 //alert(ui.item.split('|')[2])
                                // $(_txtAllergyType).val(item.split('/')[2])
                            }));
                        }
                        else {
                            response([{ label: 'No Records Found', val: -1}]);
                        }
                    },
                    error: function(result) {
                        alert("Error");
                    }
                });
            },

            focus: function(event, ui) {
                // alert(ui.item.allergy);
                // prevent value inserted on focus
                $(_txtcontrol).val(ui.item.label);
                $(_Hdncontrol).val(ui.item.val);
                $(_txtAllergyType).val(ui.item.pasthistory);
                $(_txtcontrol).attr('title', ui.item.label);
                return false;
            },
            select: function(event, ui) {

                if (ui.item.val == -1) {
                    return false;
                }
                //$(txtAllergyType).val(ui.item.allergy);
                //alert(ui.item.split('/')[2]);
                $(_Hdncontrol).val(ui.item.val);


            }
        });

    }
    BindRoomNo = function (WARD_CODE) {
        $("#ddlRoomNo").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/BindRoomNO',
            async: false,
            cache: true,
            data: "{'WARD_CODE':'" + WARD_CODE + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {
            },
            success: function (response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#ddlRoomNo").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#ddlRoomNo").append($("<option></option>").val($(this).find("CODE").text()).html($(this).find("NAME").text()));
                });
            },
            failure: function (response) {
                alert('Bind  Failed');
            },
            error: function (response) {
                alert('Bind Error');
            }
        });
    }//
    BindBEDNo = function (ROOM_CODE, WARD_CODE) {
        $("#txtBedNo").empty("");
        $.ajax({
            type: 'POST',
            url: 'IpdShortStay.aspx/BindBedNO',
            async: false,
            cache: true,
            data: "{'ROOM_CODE':'" + ROOM_CODE + "','WARD_CODE':'" + WARD_CODE + "'}",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function () {
            },
            success: function (response) {
                //alert(response.d);
                var xmlDoc = $.parseXML(response.d);
                var xml = $(xmlDoc);
                var items = xml.find("Table");
                $("#txtBedNo").append($("<option></option>").val("").html(""));
                $.each(items, function (index) {
                    $("#txtBedNo").append($("<option></option>").val($(this).find("BED_NO").text()).html($(this).find("BED_NO").text()));
                });
            },
            failure: function (response) {
                alert('Bind  Failed');
            },
            error: function (response) {
                alert('Bind Error');
            }
        });
    }

    //bed no
    //BindBEDNo = function (ROOM_CODE) {
    //    $("#txtBedNo").empty("");
    //    $.ajax({
    //        type: 'POST',
    //        url: 'IpdShortStay.aspx/BindBedNO',
    //        async: false,
    //        cache: true,
    //        data: "{'ROOM_CODE':'" + ROOM_CODE + "'}",
    //        contentType: 'application/json; charset=utf-8',
    //        dataType: 'json',
    //        beforeSend: function () {
    //        },
    //        success: function (response) {
    //            //alert(response.d);
    //            var xmlDoc = $.parseXML(response.d);
    //            var xml = $(xmlDoc);
    //            var items = xml.find("Table");
    //            $("#txtBedNo").append($("<option></option>").val("").html(""));
    //            $.each(items, function (index) {
    //                $("#txtBedNo").append($("<option></option>").val($(this).find("BED_NO").text()).html($(this).find("BED_NO").text()));
    //            });
    //        },
    //        failure: function (response) {
    //            alert('Bind  Failed');
    //        },
    //        error: function (response) {
    //            alert('Bind Error');
    //        }
    //    });
    //}

      Module_Code = function() 
      {
        $.ajax
        ({
            type: 'POST',
            url: 'IpdShortStay.aspx/GetModuleCode',
            async: false,
            cache: true,
            data: "",
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            beforeSend: function() {
            },
            success: function(response) 
            {
                if ((response.d) > 0)
                { 
                  jsModuleCode=response.d
                }
            },
            failure: function(response) 
            {
                alert('Get Module Code Failed');
            },
            error: function(response) 
            {
                alert('Get Module Code Error');
            }
            });
        }  //  

})(jQuery);